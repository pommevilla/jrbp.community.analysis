---
title: "Curating and Combining Bacteria and Yeast"
---

```{r setup, include=FALSE}
set.seed(1390)
knitr::opts_chunk$set(echo = TRUE)
```

```{r load_packages, message = FALSE, warning = FALSE}
library(phyloseq, warn.conflicts = FALSE)
```

##Loading the Data

We load in our OTU tables constructed for both the bacteria 16S and fungal ITS sequence processing, then merged them together based on samples. Missing data is read merged as `NA` that we then set equal to $0$. Setting it to $0$ may not be the correct choice; we will revisit this in a later time. Row names for the merged OTUs are the OTU names.

```{r load_data}
bacteria <- readRDS("../data/bacteria/germs_otus/bacteria_phyloseq.rds")
yeast <- readRDS("../data/yeast/fungal_phyloseq.RDS")
colnames(otu_table(yeast)) %in% colnames(otu_table(bacteria))
```

## Merge the Bacteria and Yeast Together

```{r phyloseq_merging}
merged_bac_yeast <- merge_phyloseq(yeast, bacteria)
saveRDS(merged_bac_yeast,"../data/bacteria-yeast/RVbacteria_yeast_raw_phyloseq.rds")
```

## Co-Ocurrence

```{r co_ocurrence}
trt <- as.character(sample_data(merged_bac_yeast)$Treatment)
f_table <- cbind(trt, t(otu_table(merged_bac_yeast)))
write.csv(f_table, "../data/bacteria-yeast/RVbac_yeast_fcoocurr_input.csv")
```

