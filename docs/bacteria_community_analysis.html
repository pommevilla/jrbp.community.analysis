<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Bacteria only</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="bacteria_community_analysis.html">Bacteria Only</a>
</li>
<li>
  <a href="yeast_community_analysis.html">Yeast Only</a>
</li>
<li>
  <a href="curate_combine_bacteria_yeast.html">Combine Bac. and Yeast</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Bacteria only</h1>

</div>


<script>
$(document).ready(function() {
  $items = $('div#TOC li');
  $items.each(function(idx) {
    num_ul = $(this).parentsUntil('#TOC').length;
    $(this).css({'text-indent': num_ul * 10, 'padding-left': 0});
  });

});
</script>
<div id="data-preparation" class="section level1">
<h1>Data Preparation</h1>
<pre class="r"><code>library(data.table, warn.conflicts = FALSE)
library(igraph, warn.conflicts = FALSE)</code></pre>
<p><code>taxa</code> is the look-up table for the OTUs. <code>cooccurrence_data</code> contains pairwise Spearman correlation ranks for pairs of OTUs.</p>
<pre class="r"><code>taxa &lt;- data.table(read.delim(&quot;./data/bacteria/bacteria_classified_otus&quot;, 
                              sep = &quot;&quot;, header = TRUE))

head(taxa)</code></pre>
<pre><code>##         OTU   domain         phylum               class              order
## 1: OTU_4337 Bacteria Proteobacteria Gammaproteobacteria    Pseudomonadales
## 2:  OTU_893 Bacteria    Chloroflexi      Thermomicrobia       JG30-KF-CM45
## 3: OTU_4335 Bacteria Proteobacteria Alphaproteobacteria        Rhizobiales
## 4: OTU_2826 Bacteria            TM6               SJA-4                   
## 5: OTU_4333  Archaea  Euryarchaeota     Methanobacteria Methanobacteriales
## 6: OTU_4332  Archaea  Euryarchaeota                DSEG      HydGC-84-221A
##                family         genus
## 1:      Moraxellaceae Acinetobacter
## 2:                                 
## 3: Phyllobacteriaceae Mesorhizobium
## 4:                                 
## 5:                                 
## 6:</code></pre>
<pre class="r"><code>cooccurrence_data &lt;- data.table(read.table(&quot;./data/bacteria/bacteria_cooccurrence&quot;, 
                                           col.names = c(&quot;treatment&quot;, &quot;OTU_1&quot;, &quot;OTU_2&quot;, &quot;rho&quot;, &quot;p&quot;)))

head(cooccurrence_data)</code></pre>
<pre><code>##    treatment    OTU_1    OTU_2      rho           p
## 1:    Bagged OTU_5142 OTU_5257 0.521706 1.62049e-05
## 2:    Bagged OTU_5142 OTU_3925 0.245753 5.62527e-02
## 3:    Bagged OTU_5142 OTU_2529 0.430690 5.30627e-04
## 4:    Bagged OTU_5142 OTU_5823 0.251251 5.07966e-02
## 5:    Bagged OTU_5142  OTU_162 0.449131 2.82600e-04
## 6:    Bagged OTU_5142 OTU_4153 0.368088 3.51595e-03</code></pre>
<p>We process <code>coocurrence_data</code> by removing OTU interactions non-significant <span class="math inline">\(\rho\)</span> values by filtering out those with a <span class="math inline">\(p\)</span>-value less than <span class="math inline">\(0.05\)</span>, then filtering out cyanobacteria and choloroplast data, as well as all observations from bird samples:</p>
<pre class="r"><code>cooccurrence_data &lt;- cooccurrence_data[p &lt;= 0.05, -5]      # Remove p-values from table
cooccurrence_data &lt;- cooccurrence_data[order(treatment, OTU_1, OTU_2)]
remove &lt;- taxa[which(taxa[[4]] %in% c(&quot;Cyanobacteria&quot;,&quot;Chloroplast&quot;)),]$OTU
taxa &lt;- taxa[-c(remove),]
complete_data &lt;- cooccurrence_data[-c(which(apply(cooccurrence_data, 1, function(x) any(remove %in% x)))),]

bird_data &lt;- cooccurrence_data[treatment == &quot;Bird&quot;, ]
complete_data &lt;- cooccurrence_data[treatment != &quot;Bird&quot;, ]</code></pre>
<p>We then remove all edges that are <span class="math inline">\(\textit{not}\)</span> connected to the indicated OTUs of interest:</p>
<pre class="r"><code>otus_of_interest &lt;- c(&quot;Acinetobacter&quot;, &quot;Gluconobacter&quot;, &quot;Neokomagataea&quot;, &quot;erwinia&quot;, &quot;Pantoea&quot;, &quot;resenbergiella&quot;, &quot;Asaia&quot;, &quot;Lactobacillus&quot;, &quot;Pseudomonas&quot;)
otus_of_interest &lt;- taxa[which(apply(taxa, 1, function(x) any(otus_of_interest %in% x))),]$OTU
trimmed_data &lt;- complete_data[which(apply(complete_data, 1, function(x) any(otus_of_interest %in% x))), ]
head(trimmed_data)</code></pre>
<pre><code>##    treatment    OTU_1    OTU_2      rho
## 1:    Bagged OTU_1018 OTU_1741 1.000000
## 2:    Bagged  OTU_105  OTU_153 0.269326
## 3:    Bagged OTU_1084 OTU_1741 0.701189
## 4:    Bagged OTU_1101  OTU_440 0.547866
## 5:    Bagged OTU_1228  OTU_153 0.269326
## 6:    Bagged OTU_1298 OTU_1385 0.416132</code></pre>
<p>We seperate the coocurrence data into a positive and negative group.</p>
<pre class="r"><code>trimmed_positive_weights &lt;- trimmed_data[trimmed_data[[&#39;rho&#39;]] &gt; 0]
head(trimmed_positive_weights)</code></pre>
<pre><code>##    treatment    OTU_1    OTU_2      rho
## 1:    Bagged OTU_1018 OTU_1741 1.000000
## 2:    Bagged  OTU_105  OTU_153 0.269326
## 3:    Bagged OTU_1084 OTU_1741 0.701189
## 4:    Bagged OTU_1101  OTU_440 0.547866
## 5:    Bagged OTU_1228  OTU_153 0.269326
## 6:    Bagged OTU_1298 OTU_1385 0.416132</code></pre>
<pre class="r"><code>trimmed_negative_weights &lt;- trimmed_data[trimmed_data[[&#39;rho&#39;]] &lt; 0]
head(trimmed_negative_weights)</code></pre>
<pre><code>##    treatment    OTU_1    OTU_2       rho
## 1:    Bagged  OTU_131   OTU_21 -0.287139
## 2:    Bagged   OTU_21   OTU_51 -0.255057
## 3:    Bagged   OTU_21  OTU_510 -0.311637
## 4:    Bagged    OTU_3    OTU_8 -0.261619
## 5:    Bagged OTU_4036 OTU_3492 -0.293861
## 6:    Bagged OTU_5257    OTU_8 -0.253046</code></pre>
<p>We’ll look at the positive and negative networks for each of the three treatments, as well as when all the treatments are combined together.</p>
</div>
<div id="patristic-distance-matrix" class="section level1">
<h1>Patristic Distance Matrix</h1>
<pre class="r"><code>library(ape, warn.conflicts = FALSE)</code></pre>
<p><code>bacteria_phylo_tree</code> is a guide tree returned by MAFFT for the bacterial sequences <a href="https://mafft.cbrc.jp/alignment/software/treeout.html">(info)</a>. We read it into a <code>phylo</code> object.</p>
<pre class="r"><code>rough_tree &lt;- read.tree(&quot;./data/bacteria/bacteria_phylo_tree&quot;)</code></pre>
<p>We use <code>cophenetic.phylo</code> to generate the patristic distances between each OTU. The patristic distance will be used as a measure of similarity as in the paper <a href="https://www.ncbi.nlm.nih.gov/pubmed/21775330">“Phylogenetic relatedness predicts priority effects in nectar yeast communities”</a>.</p>
<pre class="r"><code>pd_matrix &lt;- cophenetic.phylo(rough_tree)
rownames(pd_matrix) &lt;- sub(&quot;^[^_]*_&quot;, &quot;&quot;, rownames(pd_matrix)) 
colnames(pd_matrix) &lt;- sub(&quot;^[^_]*_&quot;, &quot;&quot;, colnames(pd_matrix))
pd_matrix[1:5, 1:5]</code></pre>
<pre><code>##            OTU_1 OTU_4369 OTU_4617 OTU_2588 OTU_4220
## OTU_1    0.00000  0.05576  0.07054  0.07400  0.07734
## OTU_4369 0.05576  0.00000  0.07054  0.07400  0.07734
## OTU_4617 0.07054  0.07054  0.00000  0.07400  0.07734
## OTU_2588 0.07400  0.07400  0.07400  0.00000  0.07734
## OTU_4220 0.07734  0.07734  0.07734  0.07734  0.00000</code></pre>
</div>
<div id="trimmed-data" class="section level1">
<h1>Trimmed Data</h1>
<p>All the following analysis is performed on the trimmed data set. Specifically, this analysis only examines interactions between <em>Acinetobacter, Gluconobacter, Neokomagataea, erwinia, Pantoea, resenbergiella, Asaia, Lactobacillus, Pseudomonas</em></p>
<div id="exposed-communities" class="section level2">
<h2>Exposed Communities</h2>
<div id="positive-weights" class="section level3">
<h3>Positive weights</h3>
<p>We create a directed graph weighted by Spearman correlation for the Exposed treatment for those OTUs that are positively correlated to each other:</p>
<pre class="r"><code>exposed_data_positive &lt;- trimmed_positive_weights[treatment == &quot;Exposed&quot;]
exposed_data_positive &lt;- exposed_data_positive[, -1]
gr_exposed_positive &lt;- graph.data.frame(exposed_data_positive, directed = FALSE)
plot(gr_exposed_positive, vertex.size = 3,
     vertex.label = NA)</code></pre>
<p><img src="bacteria_community_analysis_files/figure-html/tep.1-1.png" width="672" /></p>
<p>To determine communities, we use <code>cluster_fast_greedy</code>, which does greedy (local) optimization of the graph’s modularity score. For each of the communities, we list the highest degree OTU within that community, as well as the other OTUs within it.</p>
<pre class="r"><code>exposed_communities_greedy_positive &lt;- cluster_fast_greedy(gr_exposed_positive, weights = E(gr_exposed_positive)$rho)

hot_otus &lt;- vector()
for (community in communities(exposed_communities_greedy_positive))
{
  sub_graph &lt;- induced.subgraph(graph = gr_exposed_positive, 
                                    v = community, impl = &quot;auto&quot;)
  highest_degree_otu &lt;- V(sub_graph)[which.max(degree(sub_graph))]$name
  hot_otus &lt;- c(hot_otus, highest_degree_otu)
  print(paste(&quot;Highest degree OTU was&quot;, highest_degree_otu, &quot;(degree =&quot;,  
              degree(sub_graph, highest_degree_otu), &quot;):&quot;))
  print(taxa[OTU == highest_degree_otu])
        
  print(paste(&quot;Other OTUs in the same community as&quot;, highest_degree_otu, &quot;:&quot;))
  print(taxa[OTU %in% community])
}</code></pre>
<pre><code>## [1] &quot;Highest degree OTU was OTU_5823 (degree = 62 ):&quot;
##         OTU   domain         phylum               class           order
## 1: OTU_5823 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##           family         genus
## 1: Moraxellaceae Acinetobacter
## [1] &quot;Other OTUs in the same community as OTU_5823 :&quot;
##           OTU   domain          phylum               class
##   1:  OTU_433 Bacteria  Actinobacteria      Actinobacteria
##   2:  OTU_435 Bacteria  Actinobacteria      Actinobacteria
##   3: OTU_1154 Bacteria  Proteobacteria  Betaproteobacteria
##   4: OTU_1035 Bacteria   Bacteroidetes    Sphingobacteriia
##   5: OTU_3950 Bacteria  Proteobacteria  Betaproteobacteria
##  ---                                                      
## 170: OTU_1123 Bacteria Verrucomicrobia    Verrucomicrobiae
## 171: OTU_5257 Bacteria  Proteobacteria  Betaproteobacteria
## 172: OTU_4516 Bacteria  Proteobacteria  Betaproteobacteria
## 173:   OTU_78 Bacteria  Proteobacteria Gammaproteobacteria
## 174:   OTU_74 Bacteria  Actinobacteria      Actinobacteria
##                   order               family             genus
##   1:    Actinomycetales   Corynebacteriaceae   Corynebacterium
##   2:    Actinomycetales       Micrococcaceae           Kocuria
##   3:      Rhodocyclales       Rhodocyclaceae     Dechloromonas
##   4: Sphingobacteriales  Sphingobacteriaceae  Sphingobacterium
##   5:    Burkholderiales       Comamonadaceae       Methylibium
##  ---                                                          
## 170: Verrucomicrobiales  Verrucomicrobiaceae                  
## 171:    Burkholderiales       Comamonadaceae         Pelomonas
## 172:    Burkholderiales       Comamonadaceae     Limnohabitans
## 173:    Xanthomonadales     Xanthomonadaceae                  
## 174:    Actinomycetales Propionibacteriaceae Propionibacterium
## [1] &quot;Highest degree OTU was OTU_4570 (degree = 62 ):&quot;
##         OTU   domain         phylum               class           order
## 1: OTU_4570 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##           family         genus
## 1: Moraxellaceae Acinetobacter
## [1] &quot;Other OTUs in the same community as OTU_4570 :&quot;
##           OTU   domain         phylum               class           order
##   1: OTU_4337 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##   2: OTU_3426 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
##   3:  OTU_895 Bacteria  Acidobacteria     Acidobacteria-6         iii1-15
##   4: OTU_3884 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
##   5: OTU_3883 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
##  ---                                                                     
## 121: OTU_4758 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
## 122:  OTU_944 Bacteria Proteobacteria Alphaproteobacteria     Rhizobiales
## 123: OTU_3979 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
## 124: OTU_2229 Bacteria Proteobacteria Alphaproteobacteria Rhodobacterales
## 125: OTU_2595 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##                 family            genus
##   1:     Moraxellaceae    Acinetobacter
##   2:    Comamonadaceae                 
##   3:                                   
##   4:    Comamonadaceae                 
##   5:    Comamonadaceae        Comamonas
##  ---                                   
## 121:  Burkholderiaceae     Burkholderia
## 122: Hyphomicrobiaceae    Pedomicrobium
## 123:    Comamonadaceae    Limnohabitans
## 124:  Rhodobacteraceae Rubellimicrobium
## 125:     Moraxellaceae    Acinetobacter
## [1] &quot;Highest degree OTU was OTU_44 (degree = 76 ):&quot;
##       OTU   domain         phylum               class           order
## 1: OTU_44 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##              family       genus
## 1: Pseudomonadaceae Pseudomonas
## [1] &quot;Other OTUs in the same community as OTU_44 :&quot;
##           OTU   domain         phylum               class
##   1: OTU_3425 Bacteria Proteobacteria  Betaproteobacteria
##   2: OTU_5708 Bacteria Proteobacteria  Betaproteobacteria
##   3: OTU_3781 Bacteria  Bacteroidetes          Cytophagia
##   4: OTU_3304 Bacteria Proteobacteria  Betaproteobacteria
##   5: OTU_5491 Bacteria     Firmicutes             Bacilli
##  ---                                                     
## 136: OTU_5029 Bacteria Proteobacteria  Betaproteobacteria
## 137: OTU_4508 Bacteria Proteobacteria Alphaproteobacteria
## 138: OTU_3367 Bacteria Proteobacteria Gammaproteobacteria
## 139: OTU_3967 Bacteria Actinobacteria      Actinobacteria
## 140: OTU_1934 Bacteria Proteobacteria Alphaproteobacteria
##                  order             family          genus
##   1:   Burkholderiales     Comamonadaceae    Ramlibacter
##   2:   Burkholderiales     Comamonadaceae               
##   3:      Cytophagales      Cytophagaceae Flectobacillus
##   4:   Burkholderiales   Oxalobacteraceae               
##   5:        Bacillales        Bacillaceae       Bacillus
##  ---                                                    
## 136:   Burkholderiales     Comamonadaceae               
## 137:     Rickettsiales       mitochondria               
## 138: Enterobacteriales Enterobacteriaceae        Erwinia
## 139:   Actinomycetales  Sanguibacteraceae   Sanguibacter
## 140:     Rickettsiales       mitochondria               
## [1] &quot;Highest degree OTU was OTU_3174 (degree = 42 ):&quot;
##         OTU   domain         phylum               class           order
## 1: OTU_3174 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##              family       genus
## 1: Pseudomonadaceae Pseudomonas
## [1] &quot;Other OTUs in the same community as OTU_3174 :&quot;
##           OTU   domain          phylum                 class
##   1: OTU_1484 Bacteria   Bacteroidetes      Sphingobacteriia
##   2: OTU_1923 Bacteria  Proteobacteria   Alphaproteobacteria
##   3: OTU_5709 Bacteria  Proteobacteria    Betaproteobacteria
##   4: OTU_3780 Bacteria  Proteobacteria    Betaproteobacteria
##   5:  OTU_698 Bacteria  Proteobacteria   Alphaproteobacteria
##   6: OTU_1000 Bacteria  Proteobacteria   Alphaproteobacteria
##   7: OTU_1006 Bacteria  Proteobacteria   Alphaproteobacteria
##   8: OTU_1004 Bacteria  Proteobacteria    Betaproteobacteria
##   9: OTU_3334 Bacteria  Proteobacteria   Gammaproteobacteria
##  10:   OTU_52 Bacteria  Proteobacteria    Betaproteobacteria
##  11:  OTU_634 Bacteria  Actinobacteria        Actinobacteria
##  12:  OTU_288 Bacteria      Firmicutes               Bacilli
##  13:  OTU_452 Bacteria  Proteobacteria Epsilonproteobacteria
##  14:  OTU_854 Bacteria             OD1                   ZB2
##  15: OTU_3932 Bacteria  Proteobacteria   Alphaproteobacteria
##  16:   OTU_40 Bacteria  Proteobacteria    Betaproteobacteria
##  17:  OTU_848 Bacteria  Actinobacteria        Actinobacteria
##  18: OTU_4053 Bacteria   Bacteroidetes        Flavobacteriia
##  19: OTU_3922 Bacteria  Actinobacteria        Actinobacteria
##  20: OTU_4055 Bacteria  Proteobacteria    Betaproteobacteria
##  21: OTU_2406 Bacteria  Proteobacteria   Alphaproteobacteria
##  22:   OTU_38 Bacteria  Proteobacteria   Gammaproteobacteria
##  23: OTU_4555 Bacteria      Firmicutes               Bacilli
##  24:  OTU_601 Bacteria  Proteobacteria   Gammaproteobacteria
##  25:   OTU_62 Bacteria  Proteobacteria   Alphaproteobacteria
##  26:  OTU_653 Bacteria   Bacteroidetes            Cytophagia
##  27: OTU_4459 Bacteria  Proteobacteria   Gammaproteobacteria
##  28: OTU_4631 Bacteria  Proteobacteria   Alphaproteobacteria
##  29: OTU_5821 Bacteria   Bacteroidetes        Flavobacteriia
##  30: OTU_2660 Bacteria   Acidobacteria       Acidobacteria-6
##  31: OTU_1298 Bacteria  Proteobacteria   Gammaproteobacteria
##  32:  OTU_351 Bacteria  Proteobacteria    Betaproteobacteria
##  33: OTU_1477 Bacteria  Proteobacteria    Betaproteobacteria
##  34:  OTU_107 Bacteria  Proteobacteria    Betaproteobacteria
##  35:  OTU_582 Bacteria  Proteobacteria   Alphaproteobacteria
##  36:  OTU_367 Bacteria             SR1                      
##  37: OTU_3721 Bacteria  Proteobacteria    Betaproteobacteria
##  38: OTU_2100 Bacteria  Proteobacteria   Gammaproteobacteria
##  39:  OTU_110 Bacteria  Proteobacteria   Alphaproteobacteria
##  40: OTU_5298 Bacteria  Proteobacteria    Betaproteobacteria
##  41:  OTU_165 Bacteria  Proteobacteria   Alphaproteobacteria
##  42:  OTU_187 Bacteria  Proteobacteria    Betaproteobacteria
##  43:  OTU_302 Bacteria  Proteobacteria    Betaproteobacteria
##  44:  OTU_789 Bacteria      Firmicutes            Clostridia
##  45: OTU_2459 Bacteria Verrucomicrobia      Verrucomicrobiae
##  46: OTU_5804 Bacteria  Proteobacteria   Gammaproteobacteria
##  47:  OTU_172 Bacteria  Proteobacteria    Betaproteobacteria
##  48:  OTU_178 Bacteria  Proteobacteria   Alphaproteobacteria
##  49: OTU_5637 Bacteria  Proteobacteria    Betaproteobacteria
##  50:  OTU_326 Bacteria  Proteobacteria   Gammaproteobacteria
##  51: OTU_5867 Bacteria  Proteobacteria   Gammaproteobacteria
##  52:  OTU_550 Bacteria  Proteobacteria   Alphaproteobacteria
##  53: OTU_5655 Bacteria  Proteobacteria    Betaproteobacteria
##  54: OTU_4228 Bacteria  Proteobacteria    Betaproteobacteria
##  55: OTU_4227 Bacteria  Proteobacteria   Alphaproteobacteria
##  56:   OTU_92 Bacteria  Proteobacteria   Alphaproteobacteria
##  57: OTU_2303 Bacteria           WPS-2                      
##  58:  OTU_412 Bacteria  Actinobacteria        Actinobacteria
##  59: OTU_1762 Bacteria  Proteobacteria   Alphaproteobacteria
##  60: OTU_3040 Bacteria  Actinobacteria        Actinobacteria
##  61: OTU_5548 Bacteria  Proteobacteria    Betaproteobacteria
##  62: OTU_1577 Bacteria  Actinobacteria        Actinobacteria
##  63:  OTU_626 Bacteria      Firmicutes            Clostridia
##  64: OTU_3599 Bacteria  Proteobacteria   Alphaproteobacteria
##  65: OTU_4278 Bacteria   Bacteroidetes            Cytophagia
##  66: OTU_5623 Bacteria   Bacteroidetes        Flavobacteriia
##  67: OTU_3241 Bacteria  Actinobacteria        Actinobacteria
##  68:  OTU_252 Bacteria   Cyanobacteria                4C0d-2
##  69:  OTU_386 Bacteria   Bacteroidetes      Sphingobacteriia
##  70: OTU_4739 Bacteria   Cyanobacteria                4C0d-2
##  71: OTU_5953 Bacteria  Proteobacteria   Alphaproteobacteria
##  72: OTU_4920 Bacteria  Proteobacteria    Betaproteobacteria
##  73:  OTU_820 Bacteria Verrucomicrobia              Opitutae
##  74: OTU_2718 Bacteria  Proteobacteria   Alphaproteobacteria
##  75:   OTU_87 Bacteria  Proteobacteria   Deltaproteobacteria
##  76:  OTU_239 Bacteria  Planctomycetes        Planctomycetia
##  77: OTU_1717 Bacteria  Actinobacteria        Actinobacteria
##  78:  OTU_941 Bacteria      Firmicutes               Bacilli
##  79:  OTU_221 Bacteria  Proteobacteria   Alphaproteobacteria
##  80: OTU_5706 Bacteria  Proteobacteria    Betaproteobacteria
##  81: OTU_2003 Bacteria      Firmicutes               Bacilli
##  82: OTU_3282 Bacteria  Proteobacteria    Betaproteobacteria
##  83:   OTU_80 Bacteria             OD1                   ZB2
##  84: OTU_4887 Bacteria  Proteobacteria   Gammaproteobacteria
##  85: OTU_3603 Bacteria  Actinobacteria        Actinobacteria
##  86: OTU_5745 Bacteria  Proteobacteria    Betaproteobacteria
##  87: OTU_5599 Bacteria  Proteobacteria    Betaproteobacteria
##  88:    OTU_1 Bacteria  Proteobacteria   Gammaproteobacteria
##  89:    OTU_7 Bacteria   Bacteroidetes        Flavobacteriia
##  90:   OTU_27 Bacteria      Firmicutes               Bacilli
##  91: OTU_1527 Bacteria Verrucomicrobia      Verrucomicrobiae
##  92: OTU_1055 Bacteria    Fusobacteria         Fusobacteriia
##  93: OTU_1054 Bacteria      Firmicutes            Clostridia
##  94: OTU_3972 Bacteria  Proteobacteria    Betaproteobacteria
##  95:  OTU_403 Bacteria  Actinobacteria        Actinobacteria
##  96:  OTU_132 Bacteria  Proteobacteria   Deltaproteobacteria
##  97:  OTU_543 Bacteria  Actinobacteria        Actinobacteria
##  98: OTU_2220 Bacteria  Actinobacteria        Actinobacteria
##  99: OTU_3174 Bacteria  Proteobacteria   Gammaproteobacteria
## 100:   OTU_75 Bacteria  Proteobacteria   Gammaproteobacteria
##           OTU   domain          phylum                 class
##                   order              family              genus
##   1: Sphingobacteriales                                       
##   2:   Sphingomonadales   Sphingomonadaceae       Sphingomonas
##   3:      Rhodocyclales      Rhodocyclaceae           Zoogloea
##   4:      Rhodocyclales      Rhodocyclaceae      Dechloromonas
##   5:           Ellin329                                       
##   6:        Rhizobiales        Rhizobiaceae      Agrobacterium
##   7:        Rhizobiales        Rhizobiaceae          Rhizobium
##   8:    Burkholderiales      Comamonadaceae         Variovorax
##   9:    Alteromonadales    Alteromonadaceae         Cellvibrio
##  10:      Rhodocyclales      Rhodocyclaceae                   
##  11:    Actinomycetales  Corynebacteriaceae    Corynebacterium
##  12:         Bacillales      Planococcaceae                   
##  13:  Campylobacterales  Campylobacteraceae         Arcobacter
##  14:                                                          
##  15:   Sphingomonadales   Sphingomonadaceae       Sphingomonas
##  16:       Neisseriales       Neisseriaceae                   
##  17:    Actinomycetales     Nocardioidaceae       Nocardioides
##  18:   Flavobacteriales   Flavobacteriaceae     Flavobacterium
##  19:    Actinomycetales     Nocardioidaceae                   
##  20:    Burkholderiales      Comamonadaceae      Limnohabitans
##  21:      Rickettsiales        mitochondria                   
##  22:    Pseudomonadales    Pseudomonadaceae        Pseudomonas
##  23:         Bacillales      Planococcaceae       Solibacillus
##  24:  Enterobacteriales  Enterobacteriaceae           Yersinia
##  25:        Rhizobiales Methylobacteriaceae   Methylobacterium
##  26:       Cytophagales       Cytophagaceae          Emticicia
##  27:    Xanthomonadales    Xanthomonadaceae                   
##  28:   Sphingomonadales   Sphingomonadaceae       Sphingomonas
##  29:   Flavobacteriales   Flavobacteriaceae     Flavobacterium
##  30:            iii1-15                                       
##  31:    Pseudomonadales    Pseudomonadaceae        Pseudomonas
##  32:      Rhodocyclales      Rhodocyclaceae      Dechloromonas
##  33:          Ellin6067                                       
##  34:    Burkholderiales    Oxalobacteraceae  Janthinobacterium
##  35:    Caulobacterales    Caulobacteraceae                   
##  36:                                                          
##  37:    Burkholderiales    Oxalobacteraceae  Janthinobacterium
##  38:    Pseudomonadales    Pseudomonadaceae        Pseudomonas
##  39:        Rhizobiales  Phyllobacteriaceae                   
##  40:      Rhodocyclales      Rhodocyclaceae                C39
##  41:   Sphingomonadales                                       
##  42:      Rhodocyclales      Rhodocyclaceae    Hydrogenophilus
##  43:    Methylophilales    Methylophilaceae      Methylotenera
##  44:      Clostridiales   [Tissierellaceae]       Anaerococcus
##  45: Verrucomicrobiales Verrucomicrobiaceae                   
##  46:    Pseudomonadales       Moraxellaceae      Acinetobacter
##  47:    Burkholderiales      Comamonadaceae         Rhodoferax
##  48:   Sphingomonadales   Sphingomonadaceae                   
##  49:    Burkholderiales      Comamonadaceae                   
##  50:    Alteromonadales    Alteromonadaceae         Cellvibrio
##  51:  Enterobacteriales  Enterobacteriaceae                   
##  52:        Rhizobiales Methylobacteriaceae   Methylobacterium
##  53:    Burkholderiales      Comamonadaceae                   
##  54:      Rhodocyclales      Rhodocyclaceae      Dechloromonas
##  55:      Rickettsiales        mitochondria                   
##  56:   Sphingomonadales   Sphingomonadaceae       Sphingomonas
##  57:                                                          
##  58:    Actinomycetales   Brevibacteriaceae     Brevibacterium
##  59:   Sphingomonadales   Sphingomonadaceae       Sphingomonas
##  60:    Actinomycetales Geodermatophilaceae                   
##  61:      Rhodocyclales      Rhodocyclaceae      Dechloromonas
##  62:    Actinomycetales                                       
##  63:      Clostridiales                                       
##  64:        Rhizobiales   Hyphomicrobiaceae     Hyphomicrobium
##  65:       Cytophagales       Cytophagaceae                   
##  66:   Flavobacteriales   Flavobacteriaceae     Flavobacterium
##  67:    Actinomycetales  Corynebacteriaceae    Corynebacterium
##  68:            MLE1-12                                       
##  69: Sphingobacteriales                                       
##  70:            MLE1-12                                       
##  71:   Sphingomonadales   Sphingomonadaceae       Sphingomonas
##  72:      Rhodocyclales      Rhodocyclaceae      Dechloromonas
##  73:   [Cerasicoccales]   [Cerasicoccaceae]                   
##  74:    Caulobacterales    Caulobacteraceae                   
##  75:       Myxococcales           0319-6G20                   
##  76:   Planctomycetales   Planctomycetaceae       Planctomyces
##  77:    Actinomycetales     Nocardioidaceae       Nocardioides
##  78:         Bacillales [Exiguobacteraceae]    Exiguobacterium
##  79:    Rhodobacterales    Rhodobacteraceae        Rhodobacter
##  80:    Burkholderiales      Comamonadaceae                   
##  81:         Bacillales         Bacillaceae           Bacillus
##  82:    Burkholderiales      Comamonadaceae          Comamonas
##  83:                                                          
##  84:    Pseudomonadales       Moraxellaceae      Acinetobacter
##  85:    Actinomycetales   Microbacteriaceae                   
##  86:    Burkholderiales      Comamonadaceae                   
##  87:      Rhodocyclales      Rhodocyclaceae Uliginosibacterium
##  88:  Oceanospirillales      Halomonadaceae         Candidatus
##  89:   Flavobacteriales     [Weeksellaceae]    Cloacibacterium
##  90:    Lactobacillales    Streptococcaceae      Streptococcus
##  91: Verrucomicrobiales Verrucomicrobiaceae                   
##  92:    Fusobacteriales                                       
##  93:      Clostridiales     Veillonellaceae        Veillonella
##  94:      Rhodocyclales      Rhodocyclaceae      Dechloromonas
##  95:    Actinomycetales     Nocardioidaceae                   
##  96:       Myxococcales           0319-6G20                   
##  97:  Bifidobacteriales  Bifidobacteriaceae    Bifidobacterium
##  98:    Actinomycetales              ACK-M1                   
##  99:    Pseudomonadales    Pseudomonadaceae        Pseudomonas
## 100:    Pseudomonadales       Moraxellaceae          Moraxella
##                   order              family              genus
## [1] &quot;Highest degree OTU was OTU_225 (degree = 49 ):&quot;
##        OTU   domain         phylum               class           order
## 1: OTU_225 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##           family         genus
## 1: Moraxellaceae Acinetobacter
## [1] &quot;Other OTUs in the same community as OTU_225 :&quot;
##          OTU   domain         phylum                 class
##  1: OTU_5410 Bacteria Proteobacteria   Alphaproteobacteria
##  2: OTU_3436 Bacteria Proteobacteria    Betaproteobacteria
##  3:   OTU_22 Bacteria Proteobacteria    Betaproteobacteria
##  4: OTU_1144 Bacteria  Bacteroidetes        Flavobacteriia
##  5:   OTU_50 Bacteria     Firmicutes               Bacilli
##  6:  OTU_989 Bacteria     Firmicutes            Clostridia
##  7:  OTU_457 Bacteria Proteobacteria    Betaproteobacteria
##  8: OTU_1018 Bacteria Proteobacteria   Alphaproteobacteria
##  9: OTU_3930 Bacteria Proteobacteria   Alphaproteobacteria
## 10: OTU_5201 Bacteria Proteobacteria    Betaproteobacteria
## 11:  OTU_199 Bacteria Actinobacteria        Actinobacteria
## 12:  OTU_622 Bacteria Proteobacteria   Deltaproteobacteria
## 13:  OTU_446 Bacteria     Firmicutes            Clostridia
## 14:   OTU_32 Bacteria Proteobacteria   Gammaproteobacteria
## 15:  OTU_875 Bacteria     Firmicutes            Clostridia
## 16: OTU_3910 Bacteria  Bacteroidetes        Flavobacteriia
## 17: OTU_5453 Bacteria Proteobacteria    Betaproteobacteria
## 18: OTU_5302 Bacteria Proteobacteria   Alphaproteobacteria
## 19: OTU_4837 Bacteria Proteobacteria    Betaproteobacteria
## 20:   OTU_10 Bacteria   Fusobacteria         Fusobacteriia
## 21:  OTU_810 Bacteria     Firmicutes            Clostridia
## 22: OTU_5429 Bacteria Proteobacteria    Betaproteobacteria
## 23: OTU_5289 Bacteria Proteobacteria   Alphaproteobacteria
## 24:  OTU_666 Bacteria Proteobacteria   Deltaproteobacteria
## 25: OTU_1437 Bacteria Proteobacteria   Alphaproteobacteria
## 26: OTU_3496 Bacteria Proteobacteria   Gammaproteobacteria
## 27: OTU_1861 Bacteria Actinobacteria        Actinobacteria
## 28: OTU_4627 Bacteria Proteobacteria    Betaproteobacteria
## 29: OTU_4153 Bacteria Proteobacteria   Gammaproteobacteria
## 30: OTU_5408 Bacteria Proteobacteria    Betaproteobacteria
## 31: OTU_4435 Bacteria            OP3                koll11
## 32:  OTU_105 Bacteria Proteobacteria   Alphaproteobacteria
## 33:  OTU_583 Bacteria Proteobacteria Epsilonproteobacteria
## 34: OTU_1277 Bacteria Proteobacteria    Betaproteobacteria
## 35: OTU_1270 Bacteria Proteobacteria   Gammaproteobacteria
## 36:  OTU_683 Bacteria Actinobacteria        Actinobacteria
## 37:  OTU_596 Bacteria  Bacteroidetes      Sphingobacteriia
## 38:  OTU_114 Bacteria Proteobacteria   Deltaproteobacteria
## 39: OTU_5349 Bacteria Proteobacteria   Alphaproteobacteria
## 40:  OTU_166 Bacteria  Bacteroidetes         [Saprospirae]
## 41: OTU_4999 Bacteria Proteobacteria   Gammaproteobacteria
## 42: OTU_1832 Bacteria Proteobacteria   Deltaproteobacteria
## 43: OTU_5802 Bacteria Proteobacteria    Betaproteobacteria
## 44:  OTU_179 Bacteria Proteobacteria   Gammaproteobacteria
## 45: OTU_4317 Bacteria  Bacteroidetes         [Saprospirae]
## 46:  OTU_316 Bacteria Proteobacteria   Alphaproteobacteria
## 47: OTU_4218 Bacteria Proteobacteria    Betaproteobacteria
## 48: OTU_5796 Bacteria Proteobacteria   Gammaproteobacteria
## 49: OTU_5794 Bacteria Actinobacteria        Actinobacteria
## 50: OTU_1322 Bacteria Proteobacteria   Gammaproteobacteria
## 51: OTU_3096 Bacteria Proteobacteria    Betaproteobacteria
## 52:  OTU_338 Bacteria Proteobacteria   Gammaproteobacteria
## 53: OTU_5128 Bacteria Proteobacteria    Betaproteobacteria
## 54: OTU_5878 Bacteria Proteobacteria   Gammaproteobacteria
## 55: OTU_1552 Bacteria    Chloroflexi             Ellin6529
## 56: OTU_4222 Bacteria Proteobacteria   Alphaproteobacteria
## 57: OTU_2800 Bacteria Proteobacteria   Alphaproteobacteria
## 58: OTU_5242 Bacteria Proteobacteria    Betaproteobacteria
## 59: OTU_5373 Bacteria Proteobacteria   Alphaproteobacteria
## 60:   OTU_43 Bacteria Proteobacteria    Betaproteobacteria
## 61: OTU_1997 Bacteria     Firmicutes            Clostridia
## 62: OTU_2316 Bacteria  Bacteroidetes            Cytophagia
## 63:  OTU_501 Bacteria     Firmicutes               Bacilli
## 64: OTU_3269 Bacteria Proteobacteria   Alphaproteobacteria
## 65:  OTU_276 Bacteria Proteobacteria    Betaproteobacteria
## 66: OTU_2325 Bacteria     Firmicutes               Bacilli
## 67:  OTU_512 Bacteria  Bacteroidetes         [Saprospirae]
## 68: OTU_4720 Bacteria Proteobacteria    Betaproteobacteria
## 69:  OTU_125 Bacteria Proteobacteria   Gammaproteobacteria
## 70: OTU_4598 Bacteria     Firmicutes               Bacilli
## 71: OTU_5553 Bacteria Proteobacteria   Alphaproteobacteria
## 72:  OTU_710 Bacteria     Firmicutes               Bacilli
## 73:  OTU_392 Bacteria Proteobacteria    Betaproteobacteria
## 74:  OTU_393 Bacteria     Firmicutes            Clostridia
## 75:   OTU_88 Bacteria Proteobacteria    Betaproteobacteria
## 76: OTU_5710 Bacteria Proteobacteria    Betaproteobacteria
## 77: OTU_2275 Bacteria Proteobacteria   Deltaproteobacteria
## 78: OTU_2018 Bacteria Actinobacteria        Actinobacteria
## 79:  OTU_731 Bacteria     Firmicutes            Clostridia
## 80:  OTU_225 Bacteria Proteobacteria   Gammaproteobacteria
## 81: OTU_1707 Bacteria Proteobacteria   Alphaproteobacteria
## 82: OTU_1700 Bacteria     Firmicutes               Bacilli
## 83: OTU_2748 Bacteria  Bacteroidetes           Bacteroidia
## 84:  OTU_131 Bacteria Proteobacteria   Gammaproteobacteria
## 85: OTU_5906 Bacteria Actinobacteria        Actinobacteria
## 86:   OTU_94 Bacteria Proteobacteria                  TA18
## 87: OTU_4759 Bacteria Proteobacteria    Betaproteobacteria
## 88: OTU_4071 Bacteria Actinobacteria        Actinobacteria
## 89: OTU_5440 Bacteria Proteobacteria    Betaproteobacteria
## 90:  OTU_778 Bacteria Proteobacteria   Deltaproteobacteria
## 91:  OTU_774 Bacteria  Bacteroidetes         [Saprospirae]
## 92:  OTU_958 Bacteria  Bacteroidetes         [Saprospirae]
## 93: OTU_1028 Bacteria Proteobacteria   Alphaproteobacteria
##          OTU   domain         phylum                 class
##                  order              family            genus
##  1:        Rhizobiales                                     
##  2:    Burkholderiales      Comamonadaceae                 
##  3:    Burkholderiales      Comamonadaceae       Variovorax
##  4:   Flavobacteriales   Flavobacteriaceae   Flavobacterium
##  5:         Bacillales         Bacillaceae                 
##  6:      Clostridiales   [Tissierellaceae]     Anaerococcus
##  7:    Burkholderiales      Comamonadaceae      Tepidimonas
##  8:    Rhodobacterales     Hyphomonadaceae                 
##  9:        Rhizobiales   Bradyrhizobiaceae                 
## 10:    Burkholderiales      Comamonadaceae      Polaromonas
## 11:    Actinomycetales  Corynebacteriaceae  Corynebacterium
## 12:  Bdellovibrionales  Bdellovibrionaceae     Bdellovibrio
## 13:      Clostridiales  [Mogibacteriaceae]                 
## 14:  Enterobacteriales  Enterobacteriaceae                 
## 15:      Clostridiales     Lachnospiraceae          Blautia
## 16:   Flavobacteriales     [Weeksellaceae] Chryseobacterium
## 17:    Burkholderiales      Comamonadaceae        Comamonas
## 18:      Rickettsiales        mitochondria                 
## 19:    Burkholderiales      Comamonadaceae                 
## 20:    Fusobacteriales    Leptotrichiaceae     Leptotrichia
## 21:      Clostridiales      Clostridiaceae                 
## 22:    Burkholderiales      Comamonadaceae       Acidovorax
## 23:      Rickettsiales        mitochondria                 
## 24:  Bdellovibrionales  Bdellovibrionaceae     Bdellovibrio
## 25:   Rhodospirillales    Acetobacteraceae                 
## 26:  Enterobacteriales  Enterobacteriaceae          Erwinia
## 27:    Actinomycetales Geodermatophilaceae Geodermatophilus
## 28:    Burkholderiales      Comamonadaceae   Hydrogenophaga
## 29:  Enterobacteriales  Enterobacteriaceae          Erwinia
## 30:    Burkholderiales                                     
## 31:                                                        
## 32:    Rhodobacterales    Rhodobacteraceae      Rhodobacter
## 33:  Campylobacterales  Campylobacteraceae Sulfurospirillum
## 34:    Burkholderiales      Alcaligenaceae    Denitrobacter
## 35:      Thiotrichales      Thiotrichaceae                 
## 36:    Actinomycetales    Actinomycetaceae      Actinomyces
## 37: Sphingobacteriales                                     
## 38:       Myxococcales                                     
## 39:   Sphingomonadales   Sphingomonadaceae     Sphingomonas
## 40:    [Saprospirales]      Saprospiraceae                 
## 41:  Enterobacteriales  Enterobacteriaceae       Salmonella
## 42:  Bdellovibrionales  Bdellovibrionaceae     Bdellovibrio
## 43:    Burkholderiales      Comamonadaceae       Variovorax
## 44:    Pseudomonadales    Pseudomonadaceae      Pseudomonas
## 45:    [Saprospirales]    Chitinophagaceae                 
## 46:        Rhizobiales   Bradyrhizobiaceae            Bosea
## 47:    Burkholderiales      Comamonadaceae       Rhodoferax
## 48:  Enterobacteriales  Enterobacteriaceae                 
## 49:    Actinomycetales        Gordoniaceae         Gordonia
## 50:    Pseudomonadales    Pseudomonadaceae      Pseudomonas
## 51:    Burkholderiales      Alcaligenaceae       Sutterella
## 52:    Pseudomonadales    Pseudomonadaceae      Pseudomonas
## 53:    Methylophilales    Methylophilaceae                 
## 54:    Pseudomonadales       Moraxellaceae    Acinetobacter
## 55:                                                        
## 56:      Rickettsiales        mitochondria                 
## 57:    Rhodobacterales    Rhodobacteraceae      Rhodobacter
## 58:    Burkholderiales      Comamonadaceae                 
## 59:    Rhodobacterales    Rhodobacteraceae      Rhodobacter
## 60:    Burkholderiales    Oxalobacteraceae      Cupriavidus
## 61:      Clostridiales     Ruminococcaceae Faecalibacterium
## 62:       Cytophagales       Cytophagaceae     Hymenobacter
## 63:         Bacillales   Staphylococcaceae     Salinicoccus
## 64:   Sphingomonadales   Sphingomonadaceae     Sphingomonas
## 65:    Burkholderiales      Comamonadaceae                 
## 66:         Bacillales         Bacillaceae                 
## 67:    [Saprospirales]    Chitinophagaceae     Segetibacter
## 68:    Burkholderiales      Comamonadaceae                 
## 69:    Alteromonadales    Alteromonadaceae                 
## 70:         Bacillales         Bacillaceae    Anoxybacillus
## 71:      Rickettsiales        mitochondria                 
## 72:         Bacillales         Bacillaceae    Anoxybacillus
## 73:   Procabacteriales   Procabacteriaceae                 
## 74:      Clostridiales      Clostridiaceae      Clostridium
## 75:    Burkholderiales    Oxalobacteraceae                 
## 76:    Burkholderiales      Comamonadaceae       Rhodoferax
## 77:  Bdellovibrionales  Bdellovibrionaceae     Bdellovibrio
## 78:    Actinomycetales   Microbacteriaceae                 
## 79:      Clostridiales     Lachnospiraceae                 
## 80:    Pseudomonadales       Moraxellaceae    Acinetobacter
## 81:   Sphingomonadales   Sphingomonadaceae                 
## 82:         Bacillales   Staphylococcaceae     Salinicoccus
## 83:      Bacteroidales      Bacteroidaceae      Bacteroides
## 84:    Pseudomonadales       Moraxellaceae                 
## 85:    Actinomycetales     Nocardioidaceae     Nocardioides
## 86:          PHOS-HD29                                     
## 87:    Burkholderiales      Comamonadaceae                 
## 88:    Actinomycetales                                     
## 89:    Burkholderiales      Comamonadaceae        Comamonas
## 90:       Myxococcales                                     
## 91:    [Saprospirales]    Chitinophagaceae                 
## 92:    [Saprospirales]    Chitinophagaceae                 
## 93:   Sphingomonadales   Sphingomonadaceae     Sphingopyxis
##                  order              family            genus
## [1] &quot;Highest degree OTU was OTU_1741 (degree = 41 ):&quot;
##         OTU   domain     phylum   class           order           family
## 1: OTU_1741 Bacteria Firmicutes Bacilli Lactobacillales Lactobacillaceae
##            genus
## 1: Lactobacillus
## [1] &quot;Other OTUs in the same community as OTU_1741 :&quot;
##          OTU   domain         phylum                 class
##  1:   OTU_67 Bacteria Proteobacteria   Alphaproteobacteria
##  2:  OTU_847 Bacteria Proteobacteria   Alphaproteobacteria
##  3: OTU_3609 Bacteria Proteobacteria   Gammaproteobacteria
##  4: OTU_5047 Bacteria     Firmicutes               Bacilli
##  5:  OTU_609 Bacteria Actinobacteria        Actinobacteria
##  6:  OTU_287 Bacteria  Bacteroidetes            Cytophagia
##  7: OTU_1228 Bacteria Proteobacteria   Alphaproteobacteria
##  8:  OTU_678 Bacteria            OP3                koll11
##  9: OTU_1243 Bacteria  Bacteroidetes         [Saprospirae]
## 10:  OTU_345 Bacteria Proteobacteria   Gammaproteobacteria
## 11: OTU_4387 Bacteria     Firmicutes               Bacilli
## 12:  OTU_359 Bacteria            OD1                   ZB2
## 13: OTU_1476 Bacteria  Cyanobacteria Oscillatoriophycideae
## 14: OTU_3510 Bacteria Proteobacteria   Alphaproteobacteria
## 15: OTU_4397 Bacteria     Firmicutes               Bacilli
## 16:  OTU_591 Bacteria Proteobacteria    Betaproteobacteria
## 17: OTU_3572 Bacteria Proteobacteria   Alphaproteobacteria
## 18:  OTU_168 Bacteria Proteobacteria   Alphaproteobacteria
## 19:  OTU_186 Bacteria Proteobacteria   Alphaproteobacteria
## 20:  OTU_304 Bacteria Proteobacteria   Gammaproteobacteria
## 21:  OTU_980 Bacteria     Firmicutes               Bacilli
## 22: OTU_2346 Bacteria Actinobacteria        Actinobacteria
## 23: OTU_1631 Bacteria Proteobacteria   Alphaproteobacteria
## 24: OTU_4680 Bacteria  Bacteroidetes        Flavobacteriia
## 25: OTU_5784 Bacteria Proteobacteria   Alphaproteobacteria
## 26: OTU_4224 Bacteria Proteobacteria   Gammaproteobacteria
## 27: OTU_1741 Bacteria     Firmicutes               Bacilli
## 28:  OTU_126 Bacteria  Bacteroidetes      Sphingobacteriia
## 29:  OTU_231 Bacteria Proteobacteria   Alphaproteobacteria
## 30: OTU_3653 Bacteria Proteobacteria    Betaproteobacteria
## 31:  OTU_394 Bacteria Proteobacteria   Alphaproteobacteria
## 32: OTU_5545 Bacteria Proteobacteria   Alphaproteobacteria
## 33:  OTU_571 Bacteria     Firmicutes               Bacilli
## 34:   OTU_86 Bacteria Proteobacteria   Gammaproteobacteria
## 35:  OTU_736 Bacteria Actinobacteria        Actinobacteria
## 36: OTU_1702 Bacteria Proteobacteria    Betaproteobacteria
## 37:  OTU_965 Bacteria Actinobacteria        Actinobacteria
## 38: OTU_5917 Bacteria Proteobacteria   Gammaproteobacteria
## 39:  OTU_130 Bacteria Proteobacteria    Betaproteobacteria
## 40: OTU_1919 Bacteria Proteobacteria   Alphaproteobacteria
## 41: OTU_1416 Bacteria     Firmicutes               Bacilli
##          OTU   domain         phylum                 class
##                  order              family             genus
##  1:   Sphingomonadales  Erythrobacteraceae                  
##  2:    Caulobacterales    Caulobacteraceae         Mycoplana
##  3:  Oceanospirillales      Halomonadaceae         Halomonas
##  4:         Bacillales   Staphylococcaceae    Staphylococcus
##  5:    Actinomycetales  Corynebacteriaceae   Corynebacterium
##  6:       Cytophagales       Cytophagaceae      Hymenobacter
##  7:   Rhodospirillales    Acetobacteraceae        Roseomonas
##  8:                                                         
##  9:    [Saprospirales]    Chitinophagaceae                  
## 10:  Oceanospirillales      Halomonadaceae Haererehalobacter
## 11:         Bacillales         Bacillaceae     Anoxybacillus
## 12:                                                         
## 13:      Chroococcales       Xenococcaceae                  
## 14:   Sphingomonadales   Sphingomonadaceae                  
## 15:         Bacillales   Staphylococcaceae    Staphylococcus
## 16:    Burkholderiales      Comamonadaceae                  
## 17:        Rhizobiales   Bradyrhizobiaceae             Bosea
## 18:    Caulobacterales    Caulobacteraceae  Phenylobacterium
## 19:        Rhizobiales    Beijerinckiaceae                  
## 20:      Aeromonadales      Aeromonadaceae                  
## 21:         Bacillales    Paenibacillaceae     Paenibacillus
## 22:    Actinomycetales    Actinomycetaceae       Actinomyces
## 23:        Rhizobiales Methylobacteriaceae                  
## 24:   Flavobacteriales   Flavobacteriaceae    Flavobacterium
## 25:        Rhizobiales    Methylocystaceae                  
## 26:  Enterobacteriales  Enterobacteriaceae                  
## 27:    Lactobacillales    Lactobacillaceae     Lactobacillus
## 28: Sphingobacteriales Sphingobacteriaceae        Pedobacter
## 29:   Sphingomonadales   Sphingomonadaceae      Sphingomonas
## 30:    Burkholderiales    Oxalobacteraceae Janthinobacterium
## 31:      Rickettsiales        mitochondria                  
## 32:      Rickettsiales        mitochondria                  
## 33:         Bacillales    Paenibacillaceae     Paenibacillus
## 34:      Aeromonadales      Aeromonadaceae                  
## 35:    Actinomycetales    Actinomycetaceae               N09
## 36:    Burkholderiales    Oxalobacteraceae                  
## 37:    Actinomycetales    Dermabacteraceae   Brachybacterium
## 38:  Enterobacteriales  Enterobacteriaceae                  
## 39:    Burkholderiales    Oxalobacteraceae                  
## 40:   Sphingomonadales   Sphingomonadaceae                  
## 41:         Bacillales    Paenibacillaceae     Paenibacillus
##                  order              family             genus</code></pre>
<pre class="r"><code>plot(exposed_communities_greedy_positive, gr_exposed_positive, 
     layout = layout.fruchterman.reingold(gr_exposed_positive),
     rescaled = TRUE,
     vertex.size = ifelse(V(gr_exposed_positive) %in% hot_otus, 5, 1), 
     vertex.label = ifelse(V(gr_exposed_positive) %in% hot_otus, V(gr_exposed_positive)$id, NA),
     vertex.label.cex = 2
     )</code></pre>
<p><img src="bacteria_community_analysis_files/figure-html/tep.3-1.png" width="672" /></p>
<p>The modularity of the community structure is:</p>
<pre class="r"><code>(tep.mod &lt;- modularity(gr_exposed_positive, membership(exposed_communities_greedy_positive)))</code></pre>
<pre><code>## [1] 0.5247227</code></pre>
</div>
<div id="negative-weights" class="section level3">
<h3>Negative Weights</h3>
<p>We repeat the above process for the negatively correlated OTUs:</p>
<pre class="r"><code>exposed_data_negative &lt;- trimmed_negative_weights[treatment == &quot;Exposed&quot;]
exposed_data_negative &lt;- exposed_data_negative[, -1]
exposed_data_negative[[3]] &lt;- abs(exposed_data_negative[[3]])
gr_exposed_negative &lt;- graph.data.frame(exposed_data_negative, directed = FALSE)
plot(gr_exposed_negative, vertex.size = 3,
     vertex.label = NA)</code></pre>
<p><img src="bacteria_community_analysis_files/figure-html/ten.1-1.png" width="672" /></p>
<pre class="r"><code>exposed_communities_greedy_negative &lt;- cluster_fast_greedy(gr_exposed_negative, weights = E(gr_exposed_negative)$rho)

hot_otus &lt;- vector()
for (community in communities(exposed_communities_greedy_negative))
{
  sub_graph &lt;- induced.subgraph(graph = gr_exposed_negative, 
                                    v = community, impl = &quot;auto&quot;)
  highest_degree_otu &lt;- V(sub_graph)[which.max(degree(sub_graph))]$name
  hot_otus &lt;- c(hot_otus, highest_degree_otu)
  print(paste(&quot;Highest degree OTU was&quot;, highest_degree_otu, &quot;(degree =&quot;,  
              degree(sub_graph, highest_degree_otu), &quot;):&quot;))
  print(taxa[OTU == highest_degree_otu])
        
  print(paste(&quot;Other OTUs in the same community as&quot;, highest_degree_otu, &quot;:&quot;))
  print(taxa[OTU %in% community])
}</code></pre>
<pre><code>## [1] &quot;Highest degree OTU was OTU_5 (degree = 7 ):&quot;
##      OTU   domain         phylum               class         order
## 1: OTU_5 Bacteria Proteobacteria Alphaproteobacteria Rickettsiales
##          family genus
## 1: mitochondria      
## [1] &quot;Other OTUs in the same community as OTU_5 :&quot;
##          OTU   domain         phylum               class             order
##  1: OTU_4337 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##  2: OTU_5778 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##  3: OTU_5776 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##  4:    OTU_5 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
##  5: OTU_4191 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##  6: OTU_5806 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
##  7: OTU_4036 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##  8: OTU_3986 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##  9: OTU_5834 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
## 10:   OTU_43 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 11: OTU_5701 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 12: OTU_4345 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##                 family         genus
##  1:      Moraxellaceae Acinetobacter
##  2:      Moraxellaceae Acinetobacter
##  3:      Moraxellaceae Acinetobacter
##  4:       mitochondria              
##  5:      Moraxellaceae Acinetobacter
##  6: Enterobacteriaceae              
##  7:      Moraxellaceae Acinetobacter
##  8:      Moraxellaceae Acinetobacter
##  9:      Moraxellaceae Acinetobacter
## 10:   Oxalobacteraceae   Cupriavidus
## 11:     Comamonadaceae              
## 12:      Moraxellaceae Acinetobacter
## [1] &quot;Highest degree OTU was OTU_8 (degree = 10 ):&quot;
##      OTU   domain         phylum               class            order
## 1: OTU_8 Bacteria Proteobacteria Alphaproteobacteria Rhodospirillales
##              family         genus
## 1: Acetobacteraceae Gluconobacter
## [1] &quot;Other OTUs in the same community as OTU_8 :&quot;
##          OTU   domain         phylum               class            order
##  1: OTU_4627 Bacteria Proteobacteria  Betaproteobacteria  Burkholderiales
##  2: OTU_4387 Bacteria     Firmicutes             Bacilli       Bacillales
##  3: OTU_4161 Bacteria Proteobacteria Alphaproteobacteria    Rickettsiales
##  4: OTU_4222 Bacteria Proteobacteria Alphaproteobacteria    Rickettsiales
##  5:   OTU_92 Bacteria Proteobacteria Alphaproteobacteria Sphingomonadales
##  6: OTU_5553 Bacteria Proteobacteria Alphaproteobacteria    Rickettsiales
##  7:  OTU_397 Bacteria Proteobacteria Alphaproteobacteria  Rhodobacterales
##  8: OTU_4938 Bacteria Proteobacteria Alphaproteobacteria    Rickettsiales
##  9:    OTU_8 Bacteria Proteobacteria Alphaproteobacteria Rhodospirillales
## 10: OTU_1759 Bacteria Proteobacteria Alphaproteobacteria    Rickettsiales
## 11: OTU_1934 Bacteria Proteobacteria Alphaproteobacteria    Rickettsiales
##                family          genus
##  1:    Comamonadaceae Hydrogenophaga
##  2:       Bacillaceae  Anoxybacillus
##  3:      mitochondria               
##  4:      mitochondria               
##  5: Sphingomonadaceae   Sphingomonas
##  6:      mitochondria               
##  7:  Rhodobacteraceae     Paracoccus
##  8:      mitochondria               
##  9:  Acetobacteraceae  Gluconobacter
## 10:      mitochondria               
## 11:      mitochondria               
## [1] &quot;Highest degree OTU was OTU_21 (degree = 6 ):&quot;
##       OTU   domain         phylum               class           order
## 1: OTU_21 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##              family       genus
## 1: Pseudomonadaceae Pseudomonas
## [1] &quot;Other OTUs in the same community as OTU_21 :&quot;
##        OTU   domain         phylum               class           order
## 1:  OTU_21 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
## 2:  OTU_22 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
## 3:  OTU_18 Bacteria     Firmicutes             Bacilli Lactobacillales
## 4: OTU_669 Bacteria  Bacteroidetes          Cytophagia    Cytophagales
## 5: OTU_256 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
## 6: OTU_172 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
## 7:  OTU_88 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
## 8: OTU_131 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##              family             genus
## 1: Pseudomonadaceae       Pseudomonas
## 2:   Comamonadaceae        Variovorax
## 3: Lactobacillaceae     Lactobacillus
## 4:    Cytophagaceae    Flectobacillus
## 5: Oxalobacteraceae Janthinobacterium
## 6:   Comamonadaceae        Rhodoferax
## 7: Oxalobacteraceae                  
## 8:    Moraxellaceae                  
## [1] &quot;Highest degree OTU was OTU_6 (degree = 16 ):&quot;
##      OTU   domain         phylum               class           order
## 1: OTU_6 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##           family         genus
## 1: Moraxellaceae Acinetobacter
## [1] &quot;Other OTUs in the same community as OTU_6 :&quot;
##          OTU   domain         phylum               class
##  1: OTU_1035 Bacteria  Bacteroidetes    Sphingobacteriia
##  2: OTU_3950 Bacteria Proteobacteria  Betaproteobacteria
##  3:   OTU_45 Bacteria Proteobacteria Gammaproteobacteria
##  4:  OTU_446 Bacteria     Firmicutes          Clostridia
##  5:   OTU_16 Bacteria Proteobacteria  Betaproteobacteria
##  6: OTU_5289 Bacteria Proteobacteria Alphaproteobacteria
##  7: OTU_5629 Bacteria Proteobacteria Gammaproteobacteria
##  8: OTU_2168 Bacteria Proteobacteria Gammaproteobacteria
##  9:  OTU_336 Bacteria Proteobacteria Alphaproteobacteria
## 10: OTU_4227 Bacteria Proteobacteria Alphaproteobacteria
## 11: OTU_5247 Bacteria Proteobacteria Gammaproteobacteria
## 12: OTU_5854 Bacteria Proteobacteria  Betaproteobacteria
## 13: OTU_1076 Bacteria Actinobacteria      Actinobacteria
## 14:    OTU_6 Bacteria Proteobacteria Gammaproteobacteria
## 15: OTU_5257 Bacteria Proteobacteria  Betaproteobacteria
##                  order              family            genus
##  1: Sphingobacteriales Sphingobacteriaceae Sphingobacterium
##  2:    Burkholderiales      Comamonadaceae      Methylibium
##  3:    Pseudomonadales       Moraxellaceae    Enhydrobacter
##  4:      Clostridiales  [Mogibacteriaceae]                 
##  5:    Burkholderiales      Comamonadaceae    Aquabacterium
##  6:      Rickettsiales        mitochondria                 
##  7:  Enterobacteriales  Enterobacteriaceae                 
##  8:  Enterobacteriales  Enterobacteriaceae     Enterobacter
##  9:        Rhizobiales Methylobacteriaceae                 
## 10:      Rickettsiales        mitochondria                 
## 11:  Enterobacteriales  Enterobacteriaceae                 
## 12:    Burkholderiales    Burkholderiaceae     Burkholderia
## 13:    Actinomycetales  Pseudonocardiaceae   Pseudonocardia
## 14:    Pseudomonadales       Moraxellaceae    Acinetobacter
## 15:    Burkholderiales      Comamonadaceae        Pelomonas
## [1] &quot;Highest degree OTU was OTU_20 (degree = 3 ):&quot;
##       OTU   domain         phylum               class           order
## 1: OTU_20 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##           family         genus
## 1: Moraxellaceae Acinetobacter
## [1] &quot;Other OTUs in the same community as OTU_20 :&quot;
##         OTU   domain         phylum               class            order
## 1:   OTU_20 Bacteria Proteobacteria Gammaproteobacteria  Pseudomonadales
## 2: OTU_5192 Bacteria Proteobacteria  Betaproteobacteria  Burkholderiales
## 3:   OTU_28 Bacteria  Bacteroidetes      Flavobacteriia Flavobacteriales
## 4: OTU_5324 Bacteria Proteobacteria Gammaproteobacteria  Pseudomonadales
##             family            genus
## 1:   Moraxellaceae    Acinetobacter
## 2:  Comamonadaceae        Pelomonas
## 3: [Weeksellaceae] Chryseobacterium
## 4:   Moraxellaceae    Acinetobacter
## [1] &quot;Highest degree OTU was OTU_9 (degree = 1 ):&quot;
##      OTU   domain         phylum               class           order
## 1: OTU_9 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##              family       genus
## 1: Pseudomonadaceae Pseudomonas
## [1] &quot;Other OTUs in the same community as OTU_9 :&quot;
##      OTU   domain         phylum               class            order
## 1: OTU_9 Bacteria Proteobacteria Gammaproteobacteria  Pseudomonadales
## 2: OTU_7 Bacteria  Bacteroidetes      Flavobacteriia Flavobacteriales
##              family           genus
## 1: Pseudomonadaceae     Pseudomonas
## 2:  [Weeksellaceae] Cloacibacterium</code></pre>
<pre class="r"><code>plot(exposed_communities_greedy_negative, gr_exposed_negative, 
      layout = layout.fruchterman.reingold(gr_exposed_negative),
      vertex.size = ifelse(V(gr_exposed_negative) %in% hot_otus, 5, 1), 
      vertex.label = ifelse(V(gr_exposed_negative) %in% hot_otus, V(gr_exposed_negative)$id, NA),
      vertex.label.cex = 2)</code></pre>
<p><img src="bacteria_community_analysis_files/figure-html/ten.2-1.png" width="672" /></p>
<p>The modularity of the community structure is:</p>
<pre class="r"><code>(ten.mod &lt;- modularity(gr_exposed_negative, membership(exposed_communities_greedy_negative)))</code></pre>
<pre><code>## [1] 0.5118228</code></pre>
</div>
</div>
<div id="caged-communities" class="section level2">
<h2>Caged Communities</h2>
<div id="positive-weights-1" class="section level3">
<h3>Positive weights</h3>
<pre><code>## [1] &quot;Highest degree OTU was OTU_4337 (degree = 33 ):&quot;
##         OTU   domain         phylum               class           order
## 1: OTU_4337 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##           family         genus
## 1: Moraxellaceae Acinetobacter
## [1] &quot;Other OTUs in the same community as OTU_4337 :&quot;
##          OTU   domain          phylum                 class
##  1: OTU_4337 Bacteria  Proteobacteria   Gammaproteobacteria
##  2: OTU_3425 Bacteria  Proteobacteria    Betaproteobacteria
##  3:  OTU_435 Bacteria  Actinobacteria        Actinobacteria
##  4:  OTU_434 Bacteria  Proteobacteria   Alphaproteobacteria
##  5:  OTU_699 Bacteria  Proteobacteria   Alphaproteobacteria
##  6: OTU_1004 Bacteria  Proteobacteria    Betaproteobacteria
##  7:   OTU_52 Bacteria  Proteobacteria    Betaproteobacteria
##  8: OTU_5064 Bacteria  Proteobacteria   Alphaproteobacteria
##  9: OTU_5201 Bacteria  Proteobacteria    Betaproteobacteria
## 10:   OTU_42 Bacteria   Bacteroidetes            Cytophagia
## 11:  OTU_446 Bacteria      Firmicutes            Clostridia
## 12: OTU_4055 Bacteria  Proteobacteria    Betaproteobacteria
## 13:  OTU_743 Bacteria   Bacteroidetes         [Saprospirae]
## 14:  OTU_293 Bacteria  Proteobacteria    Betaproteobacteria
## 15:   OTU_28 Bacteria   Bacteroidetes        Flavobacteriia
## 16:  OTU_464 Bacteria  Proteobacteria   Deltaproteobacteria
## 17: OTU_4464 Bacteria  Proteobacteria    Betaproteobacteria
## 18: OTU_5778 Bacteria  Proteobacteria   Gammaproteobacteria
## 19: OTU_4336 Bacteria  Proteobacteria   Gammaproteobacteria
## 20: OTU_4627 Bacteria  Proteobacteria    Betaproteobacteria
## 21: OTU_3429 Bacteria  Proteobacteria   Gammaproteobacteria
## 22: OTU_1667 Bacteria   Bacteroidetes      Sphingobacteriia
## 23: OTU_3525 Bacteria  Proteobacteria    Betaproteobacteria
## 24:  OTU_596 Bacteria   Bacteroidetes      Sphingobacteriia
## 25:  OTU_187 Bacteria  Proteobacteria    Betaproteobacteria
## 26:  OTU_302 Bacteria  Proteobacteria    Betaproteobacteria
## 27: OTU_4004 Bacteria   Bacteroidetes         [Saprospirae]
## 28:  OTU_178 Bacteria  Proteobacteria   Alphaproteobacteria
## 29:  OTU_314 Bacteria  Proteobacteria    Betaproteobacteria
## 30: OTU_4036 Bacteria  Proteobacteria   Gammaproteobacteria
## 31:  OTU_798 Bacteria  Proteobacteria    Betaproteobacteria
## 32: OTU_3986 Bacteria  Proteobacteria   Gammaproteobacteria
## 33: OTU_5324 Bacteria  Proteobacteria   Gammaproteobacteria
## 34: OTU_5834 Bacteria  Proteobacteria   Gammaproteobacteria
## 35:  OTU_148 Bacteria Verrucomicrobia        [Pedosphaerae]
## 36:  OTU_156 Bacteria  Proteobacteria    Betaproteobacteria
## 37: OTU_2303 Bacteria           WPS-2                      
## 38:  OTU_412 Bacteria  Actinobacteria        Actinobacteria
## 39:  OTU_276 Bacteria  Proteobacteria    Betaproteobacteria
## 40: OTU_5447 Bacteria  Proteobacteria    Betaproteobacteria
## 41:  OTU_126 Bacteria   Bacteroidetes      Sphingobacteriia
## 42: OTU_3061 Bacteria   Bacteroidetes         [Saprospirae]
## 43:  OTU_701 Bacteria  Proteobacteria   Deltaproteobacteria
## 44: OTU_1718 Bacteria  Proteobacteria   Alphaproteobacteria
## 45:  OTU_625 Bacteria  Proteobacteria   Alphaproteobacteria
## 46:  OTU_238 Bacteria  Proteobacteria   Alphaproteobacteria
## 47:  OTU_404 Bacteria             TM6                 SJA-4
## 48: OTU_4082 Bacteria  Actinobacteria        Actinobacteria
## 49: OTU_1114 Bacteria  Proteobacteria   Gammaproteobacteria
## 50:    OTU_8 Bacteria  Proteobacteria   Alphaproteobacteria
## 51:    OTU_6 Bacteria  Proteobacteria   Gammaproteobacteria
## 52: OTU_4345 Bacteria  Proteobacteria   Gammaproteobacteria
## 53:  OTU_130 Bacteria  Proteobacteria    Betaproteobacteria
## 54: OTU_4570 Bacteria  Proteobacteria   Gammaproteobacteria
## 55: OTU_3370 Bacteria  Proteobacteria    Betaproteobacteria
## 56:  OTU_772 Bacteria   Acidobacteria  [Chloracidobacteria]
## 57:  OTU_403 Bacteria  Actinobacteria        Actinobacteria
## 58: OTU_1212 Bacteria   Cyanobacteria Synechococcophycideae
##          OTU   domain          phylum                 class
##                  order              family             genus
##  1:    Pseudomonadales       Moraxellaceae     Acinetobacter
##  2:    Burkholderiales      Comamonadaceae       Ramlibacter
##  3:    Actinomycetales      Micrococcaceae           Kocuria
##  4:      Rickettsiales        mitochondria                  
##  5:        Rhizobiales   Hyphomicrobiaceae                  
##  6:    Burkholderiales      Comamonadaceae        Variovorax
##  7:      Rhodocyclales      Rhodocyclaceae                  
##  8:      Rickettsiales        mitochondria                  
##  9:    Burkholderiales      Comamonadaceae       Polaromonas
## 10:       Cytophagales       Cytophagaceae                  
## 11:      Clostridiales  [Mogibacteriaceae]                  
## 12:    Burkholderiales      Comamonadaceae     Limnohabitans
## 13:    [Saprospirales]    Chitinophagaceae                  
## 14:    Burkholderiales      Comamonadaceae                  
## 15:   Flavobacteriales     [Weeksellaceae]  Chryseobacterium
## 16:  Bdellovibrionales  Bdellovibrionaceae      Bdellovibrio
## 17:    Burkholderiales      Comamonadaceae     Limnohabitans
## 18:    Pseudomonadales       Moraxellaceae     Acinetobacter
## 19:      Legionellales      Legionellaceae                  
## 20:    Burkholderiales      Comamonadaceae    Hydrogenophaga
## 21:  Enterobacteriales  Enterobacteriaceae           Erwinia
## 22: Sphingobacteriales                                      
## 23:    Burkholderiales    Burkholderiaceae      Burkholderia
## 24: Sphingobacteriales                                      
## 25:      Rhodocyclales      Rhodocyclaceae   Hydrogenophilus
## 26:    Methylophilales    Methylophilaceae     Methylotenera
## 27:    [Saprospirales]    Chitinophagaceae Sediminibacterium
## 28:   Sphingomonadales   Sphingomonadaceae                  
## 29:    Burkholderiales    Oxalobacteraceae         Ralstonia
## 30:    Pseudomonadales       Moraxellaceae     Acinetobacter
## 31:    Burkholderiales      Comamonadaceae         Comamonas
## 32:    Pseudomonadales       Moraxellaceae     Acinetobacter
## 33:    Pseudomonadales       Moraxellaceae     Acinetobacter
## 34:    Pseudomonadales       Moraxellaceae     Acinetobacter
## 35:   [Pedosphaerales]           auto67_4W                  
## 36:    Burkholderiales    Oxalobacteraceae  Polynucleobacter
## 37:                                                         
## 38:    Actinomycetales   Brevibacteriaceae    Brevibacterium
## 39:    Burkholderiales      Comamonadaceae                  
## 40:    Burkholderiales      Comamonadaceae        Acidovorax
## 41: Sphingobacteriales Sphingobacteriaceae        Pedobacter
## 42:    [Saprospirales]    Chitinophagaceae Sediminibacterium
## 43:       Myxococcales       Myxococcaceae                  
## 44:      Rickettsiales        mitochondria                  
## 45:        Rhizobiales   Hyphomicrobiaceae    Hyphomicrobium
## 46:        Rhizobiales        Rhizobiaceae        Candidatus
## 47:                                                         
## 48:    Actinomycetales   Cellulomonadaceae      Cellulomonas
## 49:    Xanthomonadales     Sinobacteraceae                  
## 50:   Rhodospirillales    Acetobacteraceae     Gluconobacter
## 51:    Pseudomonadales       Moraxellaceae     Acinetobacter
## 52:    Pseudomonadales       Moraxellaceae     Acinetobacter
## 53:    Burkholderiales    Oxalobacteraceae                  
## 54:    Pseudomonadales       Moraxellaceae     Acinetobacter
## 55:    Burkholderiales      Comamonadaceae     Limnohabitans
## 56:               PK29                                      
## 57:    Actinomycetales     Nocardioidaceae                  
## 58:   Pseudanabaenales   Pseudanabaenaceae      Leptolyngbya
##                  order              family             genus
## [1] &quot;Highest degree OTU was OTU_3823 (degree = 22 ):&quot;
##         OTU   domain         phylum               class           order
## 1: OTU_3823 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##           family         genus
## 1: Moraxellaceae Acinetobacter
## [1] &quot;Other OTUs in the same community as OTU_3823 :&quot;
##          OTU   domain          phylum                 class
##  1: OTU_1484 Bacteria   Bacteroidetes      Sphingobacteriia
##  2: OTU_1159 Bacteria      Firmicutes               Bacilli
##  3: OTU_3434 Bacteria  Proteobacteria Epsilonproteobacteria
##  4:   OTU_20 Bacteria  Proteobacteria   Gammaproteobacteria
##  5:   OTU_57 Bacteria      Firmicutes               Bacilli
##  6: OTU_1011 Bacteria  Proteobacteria    Betaproteobacteria
##  7: OTU_3478 Bacteria  Proteobacteria   Alphaproteobacteria
##  8:   OTU_45 Bacteria  Proteobacteria   Gammaproteobacteria
##  9:   OTU_40 Bacteria  Proteobacteria    Betaproteobacteria
## 10: OTU_3906 Bacteria  Proteobacteria   Gammaproteobacteria
## 11: OTU_5451 Bacteria  Proteobacteria    Betaproteobacteria
## 12:   OTU_13 Bacteria  Proteobacteria    Betaproteobacteria
## 13: OTU_5412 Bacteria  Proteobacteria   Gammaproteobacteria
## 14: OTU_5289 Bacteria  Proteobacteria   Alphaproteobacteria
## 15: OTU_5307 Bacteria  Proteobacteria    Betaproteobacteria
## 16: OTU_5823 Bacteria  Proteobacteria   Gammaproteobacteria
## 17: OTU_3721 Bacteria  Proteobacteria    Betaproteobacteria
## 18:  OTU_592 Bacteria  Proteobacteria   Gammaproteobacteria
## 19:  OTU_591 Bacteria  Proteobacteria    Betaproteobacteria
## 20: OTU_5755 Bacteria  Proteobacteria    Betaproteobacteria
## 21: OTU_5838 Bacteria  Proteobacteria   Alphaproteobacteria
## 22: OTU_5108 Bacteria  Proteobacteria    Betaproteobacteria
## 23: OTU_5796 Bacteria  Proteobacteria   Gammaproteobacteria
## 24: OTU_5312 Bacteria  Actinobacteria        Actinobacteria
## 25:  OTU_157 Bacteria  Actinobacteria        Actinobacteria
## 26: OTU_4228 Bacteria  Proteobacteria    Betaproteobacteria
## 27: OTU_5702 Bacteria  Proteobacteria    Betaproteobacteria
## 28:  OTU_510 Bacteria  Proteobacteria    Betaproteobacteria
## 29: OTU_5883 Bacteria  Proteobacteria    Betaproteobacteria
## 30:  OTU_820 Bacteria Verrucomicrobia              Opitutae
## 31:  OTU_575 Bacteria  Proteobacteria   Gammaproteobacteria
## 32: OTU_3823 Bacteria  Proteobacteria   Gammaproteobacteria
## 33: OTU_5705 Bacteria  Proteobacteria    Betaproteobacteria
## 34: OTU_5706 Bacteria  Proteobacteria    Betaproteobacteria
## 35: OTU_4955 Bacteria  Proteobacteria    Betaproteobacteria
## 36: OTU_4887 Bacteria  Proteobacteria   Gammaproteobacteria
## 37: OTU_1918 Bacteria  Planctomycetes        Planctomycetia
## 38: OTU_3972 Bacteria  Proteobacteria    Betaproteobacteria
## 39: OTU_4508 Bacteria  Proteobacteria   Alphaproteobacteria
## 40: OTU_1214 Bacteria   Bacteroidetes           VC2_1_Bac22
## 41: OTU_5038 Bacteria  Proteobacteria    Betaproteobacteria
## 42: OTU_5257 Bacteria  Proteobacteria    Betaproteobacteria
## 43: OTU_4516 Bacteria  Proteobacteria    Betaproteobacteria
## 44:   OTU_78 Bacteria  Proteobacteria   Gammaproteobacteria
##          OTU   domain          phylum                 class
##                  order              family             genus
##  1: Sphingobacteriales                                      
##  2:    Lactobacillales       Aerococcaceae         Facklamia
##  3:  Campylobacterales  Campylobacteraceae        Arcobacter
##  4:    Pseudomonadales       Moraxellaceae     Acinetobacter
##  5:    Lactobacillales    Streptococcaceae       Lactococcus
##  6:    Burkholderiales      Comamonadaceae                  
##  7:      Rickettsiales        mitochondria                  
##  8:    Pseudomonadales       Moraxellaceae     Enhydrobacter
##  9:       Neisseriales       Neisseriaceae                  
## 10:    Pseudomonadales       Moraxellaceae     Acinetobacter
## 11:    Burkholderiales      Comamonadaceae        Acidovorax
## 12:    Burkholderiales      Comamonadaceae        Acidovorax
## 13:    Xanthomonadales    Xanthomonadaceae  Stenotrophomonas
## 14:      Rickettsiales        mitochondria                  
## 15:    Burkholderiales      Comamonadaceae                  
## 16:    Pseudomonadales       Moraxellaceae     Acinetobacter
## 17:    Burkholderiales    Oxalobacteraceae Janthinobacterium
## 18:    Xanthomonadales    Xanthomonadaceae                  
## 19:    Burkholderiales      Comamonadaceae                  
## 20:    Burkholderiales      Comamonadaceae                  
## 21:   Sphingomonadales   Sphingomonadaceae      Sphingomonas
## 22:    Burkholderiales      Comamonadaceae     Limnohabitans
## 23:  Enterobacteriales  Enterobacteriaceae                  
## 24:    Actinomycetales Geodermatophilaceae                  
## 25:    Actinomycetales      Micrococcaceae       Micrococcus
## 26:      Rhodocyclales      Rhodocyclaceae     Dechloromonas
## 27:      Rhodocyclales      Rhodocyclaceae     Dechloromonas
## 28:      Rhodocyclales      Rhodocyclaceae     Dechloromonas
## 29:    Burkholderiales      Comamonadaceae     Limnohabitans
## 30:   [Cerasicoccales]   [Cerasicoccaceae]                  
## 31:    Pseudomonadales       Moraxellaceae                  
## 32:    Pseudomonadales       Moraxellaceae     Acinetobacter
## 33:    Burkholderiales      Comamonadaceae         Comamonas
## 34:    Burkholderiales      Comamonadaceae                  
## 35:      Rhodocyclales      Rhodocyclaceae     Dechloromonas
## 36:    Pseudomonadales       Moraxellaceae     Acinetobacter
## 37:       Pirellulales       Pirellulaceae                  
## 38:      Rhodocyclales      Rhodocyclaceae     Dechloromonas
## 39:      Rickettsiales        mitochondria                  
## 40:                                                         
## 41:      Rhodocyclales      Rhodocyclaceae     Dechloromonas
## 42:    Burkholderiales      Comamonadaceae         Pelomonas
## 43:    Burkholderiales      Comamonadaceae     Limnohabitans
## 44:    Xanthomonadales    Xanthomonadaceae                  
##                  order              family             genus
## [1] &quot;Highest degree OTU was OTU_4059 (degree = 40 ):&quot;
##         OTU   domain         phylum               class           order
## 1: OTU_4059 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##              family       genus
## 1: Pseudomonadaceae Pseudomonas
## [1] &quot;Other OTUs in the same community as OTU_4059 :&quot;
##          OTU   domain         phylum                 class
##  1: OTU_5410 Bacteria Proteobacteria   Alphaproteobacteria
##  2: OTU_3950 Bacteria Proteobacteria    Betaproteobacteria
##  3:   OTU_65 Bacteria Proteobacteria   Alphaproteobacteria
##  4:   OTU_64 Bacteria Proteobacteria   Gammaproteobacteria
##  5:  OTU_421 Bacteria  Cyanobacteria Oscillatoriophycideae
##  6:   OTU_21 Bacteria Proteobacteria   Gammaproteobacteria
##  7: OTU_4273 Bacteria Proteobacteria    Betaproteobacteria
##  8:   OTU_55 Bacteria Actinobacteria        Actinobacteria
##  9: OTU_1791 Bacteria Proteobacteria   Alphaproteobacteria
## 10:  OTU_635 Bacteria Proteobacteria   Gammaproteobacteria
## 11:  OTU_634 Bacteria Actinobacteria        Actinobacteria
## 12:  OTU_452 Bacteria Proteobacteria Epsilonproteobacteria
## 13:  OTU_982 Bacteria Proteobacteria   Gammaproteobacteria
## 14: OTU_5066 Bacteria Proteobacteria    Betaproteobacteria
## 15: OTU_1018 Bacteria Proteobacteria   Alphaproteobacteria
## 16: OTU_5682 Bacteria Proteobacteria   Gammaproteobacteria
## 17:  OTU_444 Bacteria Proteobacteria   Deltaproteobacteria
## 18: OTU_1164 Bacteria     Firmicutes               Bacilli
## 19:  OTU_846 Bacteria  Elusimicrobia         Elusimicrobia
## 20: OTU_2406 Bacteria Proteobacteria   Alphaproteobacteria
## 21:  OTU_460 Bacteria Proteobacteria   Gammaproteobacteria
## 22: OTU_4616 Bacteria Proteobacteria   Gammaproteobacteria
## 23:  OTU_868 Bacteria     Firmicutes               Bacilli
## 24: OTU_4837 Bacteria Proteobacteria    Betaproteobacteria
## 25:   OTU_14 Bacteria Proteobacteria    Betaproteobacteria
## 26: OTU_1422 Bacteria Proteobacteria   Alphaproteobacteria
## 27:  OTU_810 Bacteria     Firmicutes            Clostridia
## 28: OTU_3115 Bacteria Proteobacteria   Gammaproteobacteria
## 29: OTU_3492 Bacteria Proteobacteria   Gammaproteobacteria
## 30: OTU_3496 Bacteria Proteobacteria   Gammaproteobacteria
## 31:  OTU_803 Bacteria Proteobacteria   Gammaproteobacteria
## 32: OTU_4447 Bacteria Proteobacteria   Gammaproteobacteria
## 33: OTU_5409 Bacteria Proteobacteria   Alphaproteobacteria
## 34: OTU_1674 Bacteria    Chloroflexi           Chloroflexi
## 35: OTU_3505 Bacteria Proteobacteria   Gammaproteobacteria
## 36: OTU_5166 Bacteria Proteobacteria   Gammaproteobacteria
## 37: OTU_5345 Bacteria  Bacteroidetes      Sphingobacteriia
## 38:  OTU_180 Bacteria  Bacteroidetes           Bacteroidia
## 39:  OTU_164 Bacteria     Firmicutes               Bacilli
## 40:  OTU_186 Bacteria Proteobacteria   Alphaproteobacteria
## 41: OTU_5113 Bacteria Actinobacteria        Actinobacteria
## 42: OTU_5629 Bacteria Proteobacteria   Gammaproteobacteria
## 43: OTU_5806 Bacteria Proteobacteria   Gammaproteobacteria
## 44: OTU_5802 Bacteria Proteobacteria    Betaproteobacteria
## 45:  OTU_980 Bacteria     Firmicutes               Bacilli
## 46: OTU_2168 Bacteria Proteobacteria   Gammaproteobacteria
## 47:  OTU_316 Bacteria Proteobacteria   Alphaproteobacteria
## 48: OTU_5819 Bacteria Proteobacteria    Betaproteobacteria
## 49: OTU_5839 Bacteria Proteobacteria   Gammaproteobacteria
## 50:  OTU_149 Bacteria Actinobacteria        Actinobacteria
## 51:  OTU_324 Bacteria Proteobacteria    Betaproteobacteria
## 52: OTU_5794 Bacteria Actinobacteria        Actinobacteria
## 53: OTU_5867 Bacteria Proteobacteria   Gammaproteobacteria
## 54:  OTU_155 Bacteria Proteobacteria   Alphaproteobacteria
## 55:  OTU_881 Bacteria  Bacteroidetes            Cytophagia
## 56:  OTU_336 Bacteria Proteobacteria   Alphaproteobacteria
## 57: OTU_5646 Bacteria Proteobacteria    Betaproteobacteria
## 58:  OTU_524 Bacteria Actinobacteria        Actinobacteria
## 59: OTU_4224 Bacteria Proteobacteria   Gammaproteobacteria
## 60: OTU_5669 Bacteria Proteobacteria    Betaproteobacteria
## 61: OTU_2529 Bacteria Proteobacteria    Betaproteobacteria
## 62:  OTU_539 Bacteria  Fibrobacteres                      
## 63: OTU_5247 Bacteria Proteobacteria   Gammaproteobacteria
## 64: OTU_3271 Bacteria Proteobacteria   Gammaproteobacteria
## 65:  OTU_267 Bacteria     Firmicutes               Bacilli
## 66: OTU_4059 Bacteria Proteobacteria   Gammaproteobacteria
## 67: OTU_4598 Bacteria     Firmicutes               Bacilli
## 68: OTU_5939 Bacteria Proteobacteria   Gammaproteobacteria
## 69:  OTU_253 Bacteria     Firmicutes               Bacilli
## 70:  OTU_252 Bacteria  Cyanobacteria                4C0d-2
## 71: OTU_1346 Bacteria Planctomycetes        Planctomycetia
## 72:  OTU_717 Bacteria  Bacteroidetes        Flavobacteriia
## 73:  OTU_571 Bacteria     Firmicutes               Bacilli
## 74:   OTU_82 Bacteria  Bacteroidetes      Sphingobacteriia
## 75:   OTU_81 Bacteria     Firmicutes               Bacilli
## 76:  OTU_905 Bacteria Proteobacteria   Deltaproteobacteria
## 77: OTU_5398 Bacteria Proteobacteria   Gammaproteobacteria
## 78:   OTU_72 Bacteria Proteobacteria   Gammaproteobacteria
## 79: OTU_2003 Bacteria     Firmicutes               Bacilli
## 80: OTU_2733 Bacteria Proteobacteria   Alphaproteobacteria
## 81:  OTU_214 Bacteria Proteobacteria   Gammaproteobacteria
## 82:  OTU_218 Bacteria  Acidobacteria  [Chloracidobacteria]
## 83: OTU_5775 Bacteria Proteobacteria   Gammaproteobacteria
## 84:    OTU_3 Bacteria Proteobacteria   Gammaproteobacteria
## 85: OTU_3619 Bacteria Proteobacteria   Alphaproteobacteria
## 86:  OTU_979 Bacteria Proteobacteria   Alphaproteobacteria
## 87: OTU_5812 Bacteria Proteobacteria    Betaproteobacteria
## 88: OTU_1416 Bacteria     Firmicutes               Bacilli
## 89:   OTU_91 Bacteria Proteobacteria   Alphaproteobacteria
## 90: OTU_4759 Bacteria Proteobacteria    Betaproteobacteria
## 91: OTU_5029 Bacteria Proteobacteria    Betaproteobacteria
## 92: OTU_3979 Bacteria Proteobacteria    Betaproteobacteria
## 93: OTU_3181 Bacteria Actinobacteria        Actinobacteria
## 94: OTU_2595 Bacteria Proteobacteria   Gammaproteobacteria
## 95: OTU_3174 Bacteria Proteobacteria   Gammaproteobacteria
##          OTU   domain         phylum                 class
##                  order               family             genus
##  1:        Rhizobiales                                       
##  2:    Burkholderiales       Comamonadaceae       Methylibium
##  3:   Sphingomonadales    Sphingomonadaceae      Sphingomonas
##  4:    Pseudomonadales     Pseudomonadaceae                  
##  5:      Chroococcales        Xenococcaceae Chroococcidiopsis
##  6:    Pseudomonadales     Pseudomonadaceae       Pseudomonas
##  7:    Burkholderiales       Comamonadaceae        Rhodoferax
##  8:    Actinomycetales   Corynebacteriaceae   Corynebacterium
##  9:      Rickettsiales                                       
## 10:    Pseudomonadales        Moraxellaceae                  
## 11:    Actinomycetales   Corynebacteriaceae   Corynebacterium
## 12:  Campylobacterales   Campylobacteraceae        Arcobacter
## 13:    Xanthomonadales     Xanthomonadaceae        Dokdonella
## 14:    Burkholderiales       Comamonadaceae                  
## 15:    Rhodobacterales      Hyphomonadaceae                  
## 16:    Pseudomonadales        Moraxellaceae     Acinetobacter
## 17:  Bdellovibrionales   Bdellovibrionaceae      Bdellovibrio
## 18:         Bacillales          Bacillaceae     Terribacillus
## 19:   Elusimicrobiales                                       
## 20:      Rickettsiales         mitochondria                  
## 21:    Xanthomonadales     Xanthomonadaceae        Luteimonas
## 22:  Enterobacteriales   Enterobacteriaceae        Klebsiella
## 23:         Bacillales          Bacillaceae          Bacillus
## 24:    Burkholderiales       Comamonadaceae                  
## 25:    Burkholderiales       Comamonadaceae                  
## 26:      Rickettsiales                                       
## 27:      Clostridiales       Clostridiaceae                  
## 28:    Pseudomonadales        Moraxellaceae     Acinetobacter
## 29:  Enterobacteriales   Enterobacteriaceae           Erwinia
## 30:  Enterobacteriales   Enterobacteriaceae           Erwinia
## 31:    Alteromonadales     Alteromonadaceae        Cellvibrio
## 32:      Legionellales       Legionellaceae                  
## 33:      Rickettsiales         mitochondria                  
## 34:    [Roseiflexales]                                       
## 35:  Enterobacteriales   Enterobacteriaceae           Erwinia
## 36:  Enterobacteriales   Enterobacteriaceae           Erwinia
## 37: Sphingobacteriales                                       
## 38:      Bacteroidales [Paraprevotellaceae]      [Prevotella]
## 39:         Bacillales     Paenibacillaceae     Paenibacillus
## 40:        Rhizobiales     Beijerinckiaceae                  
## 41:    Actinomycetales    Microbacteriaceae   Salinibacterium
## 42:  Enterobacteriales   Enterobacteriaceae                  
## 43:  Enterobacteriales   Enterobacteriaceae                  
## 44:    Burkholderiales       Comamonadaceae        Variovorax
## 45:         Bacillales     Paenibacillaceae     Paenibacillus
## 46:  Enterobacteriales   Enterobacteriaceae      Enterobacter
## 47:        Rhizobiales    Bradyrhizobiaceae             Bosea
## 48:    Burkholderiales     Oxalobacteraceae Janthinobacterium
## 49:  Enterobacteriales   Enterobacteriaceae        Klebsiella
## 50:    Actinomycetales                                       
## 51:    Burkholderiales     Oxalobacteraceae                  
## 52:    Actinomycetales         Gordoniaceae          Gordonia
## 53:  Enterobacteriales   Enterobacteriaceae                  
## 54:                                                          
## 55:       Cytophagales        Cytophagaceae         Emticicia
## 56:        Rhizobiales  Methylobacteriaceae                  
## 57:    Burkholderiales       Comamonadaceae                  
## 58:    Actinomycetales    Cellulomonadaceae      Cellulomonas
## 59:  Enterobacteriales   Enterobacteriaceae                  
## 60:    Burkholderiales       Comamonadaceae         Pelomonas
## 61:    Burkholderiales       Comamonadaceae                  
## 62:                                                          
## 63:  Enterobacteriales   Enterobacteriaceae                  
## 64:  Enterobacteriales   Enterobacteriaceae           Erwinia
## 65:         Bacillales     Paenibacillaceae     Paenibacillus
## 66:    Pseudomonadales     Pseudomonadaceae       Pseudomonas
## 67:         Bacillales          Bacillaceae     Anoxybacillus
## 68:  Enterobacteriales   Enterobacteriaceae        Klebsiella
## 69:         Bacillales          Bacillaceae   Natronobacillus
## 70:            MLE1-12                                       
## 71:   Planctomycetales    Planctomycetaceae      Planctomyces
## 72:   Flavobacteriales      [Weeksellaceae]  Chryseobacterium
## 73:         Bacillales     Paenibacillaceae     Paenibacillus
## 74: Sphingobacteriales                                       
## 75:         Gemellales          Gemellaceae           Gemella
## 76:              MIZ46                                       
## 77:    Pseudomonadales     Pseudomonadaceae       Pseudomonas
## 78:    Pseudomonadales        Moraxellaceae     Acinetobacter
## 79:         Bacillales          Bacillaceae          Bacillus
## 80:        Rhizobiales    Hyphomicrobiaceae                  
## 81:    Xanthomonadales     Xanthomonadaceae  Stenotrophomonas
## 82:               RB41            Ellin6075                  
## 83:  Enterobacteriales   Enterobacteriaceae        Klebsiella
## 84:  Enterobacteriales   Enterobacteriaceae           Erwinia
## 85:      Rickettsiales         mitochondria                  
## 86:           Ellin329                                       
## 87:    Burkholderiales       Comamonadaceae        Rhodoferax
## 88:         Bacillales     Paenibacillaceae     Paenibacillus
## 89:    Caulobacterales     Caulobacteraceae       Caulobacter
## 90:    Burkholderiales       Comamonadaceae                  
## 91:    Burkholderiales       Comamonadaceae                  
## 92:    Burkholderiales       Comamonadaceae     Limnohabitans
## 93:    Actinomycetales   Corynebacteriaceae   Corynebacterium
## 94:    Pseudomonadales        Moraxellaceae     Acinetobacter
## 95:    Pseudomonadales     Pseudomonadaceae       Pseudomonas
##                  order               family             genus
## [1] &quot;Highest degree OTU was OTU_162 (degree = 49 ):&quot;
##        OTU   domain         phylum               class           order
## 1: OTU_162 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##           family         genus
## 1: Moraxellaceae Acinetobacter
## [1] &quot;Other OTUs in the same community as OTU_162 :&quot;
##          OTU   domain          phylum                 class
##  1: OTU_3304 Bacteria  Proteobacteria    Betaproteobacteria
##  2:   OTU_67 Bacteria  Proteobacteria   Alphaproteobacteria
##  3:   OTU_66 Bacteria  Proteobacteria   Alphaproteobacteria
##  4: OTU_1002 Bacteria  Actinobacteria       Thermoleophilia
##  5:   OTU_51 Bacteria  Actinobacteria        Actinobacteria
##  6:  OTU_633 Bacteria  Proteobacteria   Alphaproteobacteria
##  7:  OTU_632 Bacteria      Firmicutes            Clostridia
##  8: OTU_4261 Bacteria  Proteobacteria    Betaproteobacteria
##  9:  OTU_989 Bacteria      Firmicutes            Clostridia
## 10:   OTU_47 Bacteria  Actinobacteria        Actinobacteria
## 11: OTU_3925 Bacteria  Proteobacteria    Betaproteobacteria
## 12: OTU_3922 Bacteria  Actinobacteria        Actinobacteria
## 13: OTU_3733 Bacteria  Proteobacteria   Alphaproteobacteria
## 14: OTU_4802 Bacteria  Proteobacteria    Betaproteobacteria
## 15: OTU_1193 Bacteria  Actinobacteria        Actinobacteria
## 16:  OTU_872 Bacteria  Actinobacteria        Actinobacteria
## 17: OTU_5194 Bacteria  Actinobacteria        Actinobacteria
## 18:  OTU_690 Bacteria  Actinobacteria        Actinobacteria
## 19: OTU_2435 Bacteria  Proteobacteria   Alphaproteobacteria
## 20:  OTU_601 Bacteria  Proteobacteria   Gammaproteobacteria
## 21:  OTU_285 Bacteria   Bacteroidetes        Flavobacteriia
## 22:  OTU_865 Bacteria Verrucomicrobia        [Pedosphaerae]
## 23:   OTU_18 Bacteria      Firmicutes               Bacilli
## 24:   OTU_16 Bacteria  Proteobacteria    Betaproteobacteria
## 25: OTU_3112 Bacteria             OP3                koll11
## 26: OTU_4459 Bacteria  Proteobacteria   Gammaproteobacteria
## 27: OTU_1437 Bacteria  Proteobacteria   Alphaproteobacteria
## 28: OTU_1438 Bacteria  Proteobacteria    Betaproteobacteria
## 29: OTU_4631 Bacteria  Proteobacteria   Alphaproteobacteria
## 30: OTU_1657 Bacteria   Bacteroidetes        Flavobacteriia
## 31: OTU_5035 Bacteria   Bacteroidetes      Sphingobacteriia
## 32: OTU_2444 Bacteria Verrucomicrobia        [Pedosphaerae]
## 33: OTU_2660 Bacteria   Acidobacteria       Acidobacteria-6
## 34: OTU_5408 Bacteria  Proteobacteria    Betaproteobacteria
## 35: OTU_3385 Bacteria  Proteobacteria   Alphaproteobacteria
## 36:  OTU_138 Bacteria  Proteobacteria   Deltaproteobacteria
## 37: OTU_5498 Bacteria  Proteobacteria    Betaproteobacteria
## 38: OTU_2701 Bacteria  Proteobacteria   Alphaproteobacteria
## 39:  OTU_751 Bacteria   Bacteroidetes      Sphingobacteriia
## 40: OTU_3731 Bacteria  Proteobacteria    Betaproteobacteria
## 41:  OTU_582 Bacteria  Proteobacteria   Alphaproteobacteria
## 42:  OTU_368 Bacteria   Bacteroidetes        Flavobacteriia
## 43: OTU_1277 Bacteria  Proteobacteria    Betaproteobacteria
## 44: OTU_2109 Bacteria  Proteobacteria   Alphaproteobacteria
## 45:  OTU_371       No           blast                   hit
## 46: OTU_3440 Bacteria  Proteobacteria    Betaproteobacteria
## 47:  OTU_162 Bacteria  Proteobacteria   Gammaproteobacteria
## 48:  OTU_318 Bacteria Verrucomicrobia      Verrucomicrobiae
## 49:  OTU_326 Bacteria  Proteobacteria   Gammaproteobacteria
## 50:  OTU_899 Bacteria  Proteobacteria   Gammaproteobacteria
## 51:  OTU_240       No           blast                   hit
## 52:  OTU_338 Bacteria  Proteobacteria   Gammaproteobacteria
## 53: OTU_2961 Bacteria  Proteobacteria    Betaproteobacteria
## 54: OTU_5784 Bacteria  Proteobacteria   Alphaproteobacteria
## 55: OTU_5871 Bacteria  Proteobacteria   Alphaproteobacteria
## 56: OTU_4222 Bacteria  Proteobacteria   Alphaproteobacteria
## 57:   OTU_92 Bacteria  Proteobacteria   Alphaproteobacteria
## 58: OTU_1546 Bacteria  Proteobacteria   Gammaproteobacteria
## 59: OTU_5724 Bacteria  Actinobacteria        Actinobacteria
## 60: OTU_1762 Bacteria  Proteobacteria   Alphaproteobacteria
## 61:   OTU_43 Bacteria  Proteobacteria    Betaproteobacteria
## 62: OTU_1993 Bacteria  Proteobacteria   Alphaproteobacteria
## 63: OTU_1753 Bacteria  Proteobacteria    Betaproteobacteria
## 64:  OTU_250 Bacteria   Bacteroidetes      Sphingobacteriia
## 65:  OTU_705 Bacteria  Proteobacteria   Alphaproteobacteria
## 66:  OTU_231 Bacteria  Proteobacteria   Alphaproteobacteria
## 67: OTU_5734 Bacteria  Proteobacteria   Gammaproteobacteria
## 68:  OTU_397 Bacteria  Proteobacteria   Alphaproteobacteria
## 69: OTU_4706 Bacteria  Proteobacteria    Betaproteobacteria
## 70: OTU_4701 Bacteria  Proteobacteria   Gammaproteobacteria
## 71: OTU_1454 Bacteria  Proteobacteria Epsilonproteobacteria
## 72: OTU_1088 Bacteria   Cyanobacteria Synechococcophycideae
## 73: OTU_4935 Bacteria  Proteobacteria    Betaproteobacteria
## 74:   OTU_85 Bacteria   Bacteroidetes            Cytophagia
## 75: OTU_5976 Bacteria  Proteobacteria    Betaproteobacteria
## 76: OTU_2018 Bacteria  Actinobacteria        Actinobacteria
## 77: OTU_2734 Bacteria Armatimonadetes      [Fimbriimonadia]
## 78: OTU_3282 Bacteria  Proteobacteria    Betaproteobacteria
## 79:  OTU_210 Bacteria      Firmicutes            Clostridia
## 80:   OTU_80 Bacteria             OD1                   ZB2
## 81: OTU_1116 Bacteria  Proteobacteria   Alphaproteobacteria
## 82: OTU_1070 Bacteria   Bacteroidetes         [Saprospirae]
## 83: OTU_1527 Bacteria Verrucomicrobia      Verrucomicrobiae
## 84:  OTU_766 Bacteria             OD1                      
## 85: OTU_3187 Bacteria  Proteobacteria   Alphaproteobacteria
## 86:  OTU_409 Bacteria      Firmicutes            Clostridia
## 87: OTU_5743 Bacteria  Proteobacteria   Alphaproteobacteria
##          OTU   domain          phylum                 class
##                   order              family             genus
##  1:     Burkholderiales    Oxalobacteraceae                  
##  2:    Sphingomonadales  Erythrobacteraceae                  
##  3:    Rhodospirillales    Acetobacteraceae     Swaminathania
##  4: Solirubrobacterales                                      
##  5:     Actinomycetales   Microbacteriaceae        Candidatus
##  6:    Rhodospirillales   Rhodospirillaceae       Skermanella
##  7:       Clostridiales      Clostridiaceae                  
##  8:     Burkholderiales    Oxalobacteraceae Janthinobacterium
##  9:       Clostridiales   [Tissierellaceae]      Anaerococcus
## 10:     Actinomycetales  Corynebacteriaceae   Corynebacterium
## 11:     Burkholderiales      Comamonadaceae       Methylibium
## 12:     Actinomycetales     Nocardioidaceae                  
## 13:    Sphingomonadales   Sphingomonadaceae      Sphingomonas
## 14:     Burkholderiales    Oxalobacteraceae                  
## 15:     Actinomycetales        Nocardiaceae       Rhodococcus
## 16:     Actinomycetales     Nocardioidaceae                  
## 17:     Actinomycetales   Microbacteriaceae   Salinibacterium
## 18:     Actinomycetales     Kineosporiaceae                  
## 19:         Rhizobiales Methylobacteriaceae                  
## 20:   Enterobacteriales  Enterobacteriaceae          Yersinia
## 21:    Flavobacteriales     [Weeksellaceae]  Chryseobacterium
## 22:    [Pedosphaerales]                                      
## 23:     Lactobacillales    Lactobacillaceae     Lactobacillus
## 24:     Burkholderiales      Comamonadaceae     Aquabacterium
## 25:                                                          
## 26:     Xanthomonadales    Xanthomonadaceae                  
## 27:    Rhodospirillales    Acetobacteraceae                  
## 28:     Burkholderiales    Oxalobacteraceae       Cupriavidus
## 29:    Sphingomonadales   Sphingomonadaceae      Sphingomonas
## 30:    Flavobacteriales     [Weeksellaceae]                  
## 31:  Sphingobacteriales                                      
## 32:    [Pedosphaerales]                                      
## 33:             iii1-15                                      
## 34:     Burkholderiales                                      
## 35:    Sphingomonadales   Sphingomonadaceae      Sphingomonas
## 36:                                                          
## 37:     Burkholderiales      Comamonadaceae        Roseateles
## 38:     Caulobacterales    Caulobacteraceae  Phenylobacterium
## 39:  Sphingobacteriales                                      
## 40:     Burkholderiales      Comamonadaceae         Comamonas
## 41:     Caulobacterales    Caulobacteraceae                  
## 42:    Flavobacteriales   Flavobacteriaceae    Flavobacterium
## 43:     Burkholderiales      Alcaligenaceae     Denitrobacter
## 44:    Rhodospirillales    Acetobacteraceae       Roseococcus
## 45:                                                          
## 46:     Burkholderiales      Comamonadaceae        Rhodoferax
## 47:     Pseudomonadales       Moraxellaceae     Acinetobacter
## 48:  Verrucomicrobiales Verrucomicrobiaceae   Prosthecobacter
## 49:     Alteromonadales    Alteromonadaceae        Cellvibrio
## 50:       Legionellales      Legionellaceae                  
## 51:                                                          
## 52:     Pseudomonadales    Pseudomonadaceae       Pseudomonas
## 53:     Burkholderiales                                      
## 54:         Rhizobiales    Methylocystaceae                  
## 55:    Sphingomonadales   Sphingomonadaceae      Sphingomonas
## 56:       Rickettsiales        mitochondria                  
## 57:    Sphingomonadales   Sphingomonadaceae      Sphingomonas
## 58:     Alteromonadales             211ds20                  
## 59:     Actinomycetales Geodermatophilaceae     Modestobacter
## 60:    Sphingomonadales   Sphingomonadaceae      Sphingomonas
## 61:     Burkholderiales    Oxalobacteraceae       Cupriavidus
## 62:                                                          
## 63:    Procabacteriales   Procabacteriaceae                  
## 64:  Sphingobacteriales                                      
## 65:         Rhizobiales   Bradyrhizobiaceae       Balneimonas
## 66:    Sphingomonadales   Sphingomonadaceae      Sphingomonas
## 67:   Enterobacteriales  Enterobacteriaceae           Erwinia
## 68:     Rhodobacterales    Rhodobacteraceae        Paracoccus
## 69:     Burkholderiales      Comamonadaceae                  
## 70:     Alteromonadales    Alteromonadaceae                  
## 71:   Campylobacterales   Helicobacteraceae     Sulfuricurvum
## 72:    Pseudanabaenales   Pseudanabaenaceae      Leptolyngbya
## 73:     Burkholderiales    Oxalobacteraceae                  
## 74:        Cytophagales       Cytophagaceae      Hymenobacter
## 75:     Burkholderiales      Comamonadaceae         Comamonas
## 76:     Actinomycetales   Microbacteriaceae                  
## 77:  [Fimbriimonadales] [Fimbriimonadaceae]                  
## 78:     Burkholderiales      Comamonadaceae         Comamonas
## 79:       Clostridiales   [Tissierellaceae]     Peptoniphilus
## 80:                                                          
## 81:     Rhodobacterales    Rhodobacteraceae  Rubellimicrobium
## 82:     [Saprospirales]    Chitinophagaceae                  
## 83:  Verrucomicrobiales Verrucomicrobiaceae                  
## 84:                                                          
## 85:         Rhizobiales   Hyphomicrobiaceae           Devosia
## 86:       Clostridiales     Lachnospiraceae       Coprococcus
## 87:    Sphingomonadales   Sphingomonadaceae      Sphingomonas
##                   order              family             genus
## [1] &quot;Highest degree OTU was OTU_9 (degree = 44 ):&quot;
##      OTU   domain         phylum               class           order
## 1: OTU_9 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##              family       genus
## 1: Pseudomonadaceae Pseudomonas
## [1] &quot;Other OTUs in the same community as OTU_9 :&quot;
##           OTU   domain         phylum               class
##   1: OTU_5135 Bacteria Proteobacteria  Betaproteobacteria
##   2:  OTU_638 Bacteria Actinobacteria      Actinobacteria
##   3: OTU_3148 Bacteria Actinobacteria      Actinobacteria
##   4:   OTU_44 Bacteria Proteobacteria Gammaproteobacteria
##   5:  OTU_620 Bacteria Planctomycetes      Planctomycetia
##  ---                                                     
##  97: OTU_5443 Bacteria Proteobacteria  Betaproteobacteria
##  98:  OTU_779 Bacteria  Bacteroidetes         Bacteroidia
##  99:  OTU_543 Bacteria Actinobacteria      Actinobacteria
## 100: OTU_2220 Bacteria Actinobacteria      Actinobacteria
## 101:   OTU_75 Bacteria Proteobacteria Gammaproteobacteria
##                  order              family           genus
##   1:   Burkholderiales      Comamonadaceae                
##   2:   Actinomycetales              ACK-M1                
##   3:   Actinomycetales Geodermatophilaceae    Blastococcus
##   4:   Pseudomonadales    Pseudomonadaceae     Pseudomonas
##   5:  Planctomycetales   Planctomycetaceae    Planctomyces
##  ---                                                      
##  97:   Burkholderiales    Oxalobacteraceae                
##  98:     Bacteroidales      Bacteroidaceae     Bacteroides
##  99: Bifidobacteriales  Bifidobacteriaceae Bifidobacterium
## 100:   Actinomycetales              ACK-M1                
## 101:   Pseudomonadales       Moraxellaceae       Moraxella
## [1] &quot;Highest degree OTU was OTU_1741 (degree = 18 ):&quot;
##         OTU   domain     phylum   class           order           family
## 1: OTU_1741 Bacteria Firmicutes Bacilli Lactobacillales Lactobacillaceae
##            genus
## 1: Lactobacillus
## [1] &quot;Other OTUs in the same community as OTU_1741 :&quot;
##          OTU   domain         phylum               class            order
##  1: OTU_3884 Bacteria Proteobacteria  Betaproteobacteria  Burkholderiales
##  2: OTU_5709 Bacteria Proteobacteria  Betaproteobacteria    Rhodocyclales
##  3: OTU_5190 Bacteria Proteobacteria  Betaproteobacteria  Burkholderiales
##  4:  OTU_585 Bacteria Proteobacteria Alphaproteobacteria    Rickettsiales
##  5: OTU_1275 Bacteria  Bacteroidetes      Flavobacteriia Flavobacteriales
##  6: OTU_3509 Bacteria Proteobacteria  Betaproteobacteria  Burkholderiales
##  7:  OTU_373 Bacteria Proteobacteria Deltaproteobacteria     Myxococcales
##  8:  OTU_166 Bacteria  Bacteroidetes       [Saprospirae]  [Saprospirales]
##  9:  OTU_172 Bacteria Proteobacteria  Betaproteobacteria  Burkholderiales
## 10: OTU_1741 Bacteria     Firmicutes             Bacilli  Lactobacillales
## 11:  OTU_257 Bacteria Actinobacteria      Actinobacteria  Actinomycetales
## 12:  OTU_544 Bacteria Actinobacteria      Actinobacteria  Actinomycetales
## 13: OTU_1080 Bacteria  Bacteroidetes      Flavobacteriia Flavobacteriales
## 14: OTU_4938 Bacteria Proteobacteria Alphaproteobacteria    Rickettsiales
## 15:   OTU_86 Bacteria Proteobacteria Gammaproteobacteria    Aeromonadales
## 16:  OTU_972 Bacteria            OD1                 ZB2                 
## 17:  OTU_131 Bacteria Proteobacteria Gammaproteobacteria  Pseudomonadales
## 18: OTU_1055 Bacteria   Fusobacteria       Fusobacteriia  Fusobacteriales
## 19: OTU_4071 Bacteria Actinobacteria      Actinobacteria  Actinomycetales
##                family            genus
##  1:    Comamonadaceae                 
##  2:    Rhodocyclaceae         Zoogloea
##  3:  Oxalobacteraceae                 
##  4:    Rickettsiaceae                 
##  5: Flavobacteriaceae   Flavobacterium
##  6:  Oxalobacteraceae                 
##  7:     Haliangiaceae                 
##  8:    Saprospiraceae                 
##  9:    Comamonadaceae       Rhodoferax
## 10:  Lactobacillaceae    Lactobacillus
## 11:                                   
## 12:   Kineosporiaceae                 
## 13:   [Weeksellaceae] Chryseobacterium
## 14:      mitochondria                 
## 15:    Aeromonadaceae                 
## 16:                                   
## 17:     Moraxellaceae                 
## 18:                                   
## 19:                                   
## [1] &quot;Highest degree OTU was OTU_4191 (degree = 7 ):&quot;
##         OTU   domain         phylum               class           order
## 1: OTU_4191 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##           family         genus
## 1: Moraxellaceae Acinetobacter
## [1] &quot;Other OTUs in the same community as OTU_4191 :&quot;
##         OTU   domain         phylum               class            order
## 1: OTU_3780 Bacteria Proteobacteria  Betaproteobacteria    Rhodocyclales
## 2:   OTU_50 Bacteria     Firmicutes             Bacilli       Bacillales
## 3:  OTU_120 Bacteria Actinobacteria      Actinobacteria  Actinomycetales
## 4: OTU_4191 Bacteria Proteobacteria Gammaproteobacteria  Pseudomonadales
## 5: OTU_3096 Bacteria Proteobacteria  Betaproteobacteria  Burkholderiales
## 6: OTU_5701 Bacteria Proteobacteria  Betaproteobacteria  Burkholderiales
## 7:    OTU_7 Bacteria  Bacteroidetes      Flavobacteriia Flavobacteriales
## 8:   OTU_27 Bacteria     Firmicutes             Bacilli  Lactobacillales
##               family           genus
## 1:    Rhodocyclaceae   Dechloromonas
## 2:       Bacillaceae                
## 3: Microbacteriaceae                
## 4:     Moraxellaceae   Acinetobacter
## 5:    Alcaligenaceae      Sutterella
## 6:    Comamonadaceae                
## 7:   [Weeksellaceae] Cloacibacterium
## 8:  Streptococcaceae   Streptococcus
## [1] &quot;Highest degree OTU was OTU_5878 (degree = 12 ):&quot;
##         OTU   domain         phylum               class           order
## 1: OTU_5878 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##           family         genus
## 1: Moraxellaceae Acinetobacter
## [1] &quot;Other OTUs in the same community as OTU_5878 :&quot;
##          OTU   domain         phylum               class             order
##  1:   OTU_34 Bacteria Proteobacteria Alphaproteobacteria  Sphingomonadales
##  2: OTU_5600 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
##  3:  OTU_329 Bacteria Proteobacteria Alphaproteobacteria   Caulobacterales
##  4: OTU_5878 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##  5: OTU_3204 Bacteria Proteobacteria Gammaproteobacteria   Xanthomonadales
##  6:  OTU_306 Bacteria     Firmicutes          Clostridia     Clostridiales
##  7:  OTU_272 Bacteria Actinobacteria      Actinobacteria   Actinomycetales
##  8: OTU_3368 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
##  9: OTU_5975 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 10:  OTU_407 Bacteria     Firmicutes             Bacilli        Bacillales
## 11: OTU_5440 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##                 family           genus
##  1:  Sphingomonadaceae Novosphingobium
##  2:       mitochondria                
##  3:   Caulobacteraceae                
##  4:      Moraxellaceae   Acinetobacter
##  5:   Xanthomonadaceae                
##  6:    Veillonellaceae     Veillonella
##  7:  Microbacteriaceae     Clavibacter
##  8: Enterobacteriaceae         Erwinia
##  9: Enterobacteriaceae         Erwinia
## 10:   Paenibacillaceae   Paenibacillus
## 11:     Comamonadaceae       Comamonas</code></pre>
<pre class="r"><code>plot(caged_communities_greedy_positive, gr_caged_positive, 
     layout = layout.fruchterman.reingold(gr_caged_positive),
     rescaled = TRUE,
     vertex.size = 2, 
     vertex.label = NA
      )</code></pre>
<p><img src="bacteria_community_analysis_files/figure-html/tcp.2-1.png" width="672" /></p>
<p>The modularity of the community structure is:</p>
<pre class="r"><code>(tcp.mod &lt;- modularity(gr_caged_positive, membership(caged_communities_greedy_positive)))</code></pre>
<pre><code>## [1] 0.5346598</code></pre>
</div>
<div id="negative-weights-1" class="section level3">
<h3>Negative Weights</h3>
<pre class="r"><code>caged_data_negative &lt;- trimmed_negative_weights[treatment == &quot;Caged&quot;]
caged_data_negative &lt;- caged_data_negative[, -1]
caged_data_negative[[3]] &lt;- abs(caged_data_negative[[3]])
gr_caged_negative &lt;- graph.data.frame(caged_data_negative, directed = FALSE)
caged_communities_greedy_negative &lt;- cluster_fast_greedy(gr_caged_negative, weights = E(gr_caged_negative)$rho)

hot_otus &lt;- vector()
for (community in communities(caged_communities_greedy_negative))
{
  sub_graph &lt;- induced.subgraph(graph = gr_caged_negative, 
                                    v = community, impl = &quot;auto&quot;)
  highest_degree_otu &lt;- V(sub_graph)[which.max(degree(sub_graph))]$name
  hot_otus &lt;- c(hot_otus, highest_degree_otu)
  print(paste(&quot;Highest degree OTU was&quot;, highest_degree_otu, &quot;(degree =&quot;,  
              degree(sub_graph, highest_degree_otu), &quot;):&quot;))
  print(taxa[OTU == highest_degree_otu])
        
  print(paste(&quot;Other OTUs in the same community as&quot;, highest_degree_otu, &quot;:&quot;))
  print(taxa[OTU %in% community])
}</code></pre>
<pre><code>## [1] &quot;Highest degree OTU was OTU_5 (degree = 3 ):&quot;
##      OTU   domain         phylum               class         order
## 1: OTU_5 Bacteria Proteobacteria Alphaproteobacteria Rickettsiales
##          family genus
## 1: mitochondria      
## [1] &quot;Other OTUs in the same community as OTU_5 :&quot;
##         OTU   domain         phylum               class           order
## 1:   OTU_20 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
## 2:    OTU_5 Bacteria Proteobacteria Alphaproteobacteria   Rickettsiales
## 3: OTU_4161 Bacteria Proteobacteria Alphaproteobacteria   Rickettsiales
## 4: OTU_3986 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
## 5: OTU_5834 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##           family         genus
## 1: Moraxellaceae Acinetobacter
## 2:  mitochondria              
## 3:  mitochondria              
## 4: Moraxellaceae Acinetobacter
## 5: Moraxellaceae Acinetobacter
## [1] &quot;Highest degree OTU was OTU_8 (degree = 2 ):&quot;
##      OTU   domain         phylum               class            order
## 1: OTU_8 Bacteria Proteobacteria Alphaproteobacteria Rhodospirillales
##              family         genus
## 1: Acetobacteraceae Gluconobacter
## [1] &quot;Other OTUs in the same community as OTU_8 :&quot;
##         OTU   domain         phylum               class            order
## 1: OTU_5302 Bacteria Proteobacteria Alphaproteobacteria    Rickettsiales
## 2: OTU_4227 Bacteria Proteobacteria Alphaproteobacteria    Rickettsiales
## 3:    OTU_8 Bacteria Proteobacteria Alphaproteobacteria Rhodospirillales
##              family         genus
## 1:     mitochondria              
## 2:     mitochondria              
## 3: Acetobacteraceae Gluconobacter
## [1] &quot;Highest degree OTU was OTU_21 (degree = 4 ):&quot;
##       OTU   domain         phylum               class           order
## 1: OTU_21 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##              family       genus
## 1: Pseudomonadaceae Pseudomonas
## [1] &quot;Other OTUs in the same community as OTU_21 :&quot;
##         OTU   domain         phylum               class           order
## 1:   OTU_21 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
## 2:   OTU_22 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
## 3: OTU_5289 Bacteria Proteobacteria Alphaproteobacteria   Rickettsiales
## 4:  OTU_172 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
## 5: OTU_4218 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
##              family       genus
## 1: Pseudomonadaceae Pseudomonas
## 2:   Comamonadaceae  Variovorax
## 3:     mitochondria            
## 4:   Comamonadaceae  Rhodoferax
## 5:   Comamonadaceae  Rhodoferax
## [1] &quot;Highest degree OTU was OTU_6 (degree = 2 ):&quot;
##      OTU   domain         phylum               class           order
## 1: OTU_6 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##           family         genus
## 1: Moraxellaceae Acinetobacter
## [1] &quot;Other OTUs in the same community as OTU_6 :&quot;
##        OTU   domain         phylum               class           order
## 1: OTU_233 Bacteria     Firmicutes             Bacilli      Bacillales
## 2:   OTU_9 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
## 3:   OTU_6 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##              family         genus
## 1: Paenibacillaceae Paenibacillus
## 2: Pseudomonadaceae   Pseudomonas
## 3:    Moraxellaceae Acinetobacter
## [1] &quot;Highest degree OTU was OTU_225 (degree = 1 ):&quot;
##        OTU   domain         phylum               class           order
## 1: OTU_225 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##           family         genus
## 1: Moraxellaceae Acinetobacter
## [1] &quot;Other OTUs in the same community as OTU_225 :&quot;
##         OTU   domain         phylum               class             order
## 1: OTU_2168 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 2:  OTU_225 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##                family         genus
## 1: Enterobacteriaceae  Enterobacter
## 2:      Moraxellaceae Acinetobacter
## [1] &quot;Highest degree OTU was OTU_5806 (degree = 1 ):&quot;
##         OTU   domain         phylum               class             order
## 1: OTU_5806 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
##                family genus
## 1: Enterobacteriaceae      
## [1] &quot;Other OTUs in the same community as OTU_5806 :&quot;
##         OTU   domain         phylum               class             order
## 1:   OTU_44 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
## 2: OTU_5806 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
##                family       genus
## 1:   Pseudomonadaceae Pseudomonas
## 2: Enterobacteriaceae</code></pre>
<pre class="r"><code>plot(caged_communities_greedy_negative, gr_caged_negative, 
     layout = layout.fruchterman.reingold(gr_caged_negative),
     vertex.size = 2, 
     vertex.label = NA)</code></pre>
<p><img src="bacteria_community_analysis_files/figure-html/tcn.1-1.png" width="672" /></p>
<p>The modularity of the community structure is:</p>
<pre class="r"><code>(tcn.mod &lt;- modularity(gr_caged_negative, membership(caged_communities_greedy_negative)))</code></pre>
<pre><code>## [1] 0.5193906</code></pre>
</div>
</div>
<div id="bagged-communities" class="section level2">
<h2>Bagged Communities</h2>
<div id="positive-weights-2" class="section level3">
<h3>Positive weights</h3>
<pre class="r"><code>bagged_data_positive &lt;- trimmed_positive_weights[treatment == &quot;Bagged&quot;]
bagged_data_positive &lt;- bagged_data_positive[, -1]
gr_bagged_positive &lt;- graph.data.frame(bagged_data_positive, directed = FALSE)
bagged_communities_greedy_positive &lt;- cluster_fast_greedy(gr_bagged_positive, weights = E(gr_bagged_positive)$rho)

hot_otus &lt;- vector()
for (community in communities(bagged_communities_greedy_positive))
{
  sub_graph &lt;- induced.subgraph(graph = gr_bagged_positive, 
                                    v = community, impl = &quot;auto&quot;)
  highest_degree_otu &lt;- V(sub_graph)[which.max(degree(sub_graph))]$name
  hot_otus &lt;- c(hot_otus, highest_degree_otu)
  print(paste(&quot;Highest degree OTU was&quot;, highest_degree_otu, &quot;(degree =&quot;,  
              degree(sub_graph, highest_degree_otu), &quot;):&quot;))
  print(taxa[OTU == highest_degree_otu])
        
  print(paste(&quot;Other OTUs in the same community as&quot;, highest_degree_otu, &quot;:&quot;))
  print(taxa[OTU %in% community])
}</code></pre>
<pre><code>## [1] &quot;Highest degree OTU was OTU_338 (degree = 45 ):&quot;
##        OTU   domain         phylum               class           order
## 1: OTU_338 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##              family       genus
## 1: Pseudomonadaceae Pseudomonas
## [1] &quot;Other OTUs in the same community as OTU_338 :&quot;
##          OTU   domain         phylum                 class
##  1: OTU_3426 Bacteria Proteobacteria    Betaproteobacteria
##  2: OTU_3425 Bacteria Proteobacteria    Betaproteobacteria
##  3: OTU_1035 Bacteria  Bacteroidetes      Sphingobacteriia
##  4: OTU_5709 Bacteria Proteobacteria    Betaproteobacteria
##  5: OTU_5708 Bacteria Proteobacteria    Betaproteobacteria
##  6: OTU_3153 Bacteria Proteobacteria   Alphaproteobacteria
##  7:   OTU_52 Bacteria Proteobacteria    Betaproteobacteria
##  8: OTU_1011 Bacteria Proteobacteria    Betaproteobacteria
##  9: OTU_1018 Bacteria Proteobacteria   Alphaproteobacteria
## 10: OTU_3930 Bacteria Proteobacteria   Alphaproteobacteria
## 11:   OTU_42 Bacteria  Bacteroidetes            Cytophagia
## 12:  OTU_994 Bacteria  Bacteroidetes            Cytophagia
## 13:  OTU_841 Bacteria Proteobacteria   Gammaproteobacteria
## 14: OTU_5074 Bacteria Proteobacteria   Gammaproteobacteria
## 15: OTU_3925 Bacteria Proteobacteria    Betaproteobacteria
## 16:   OTU_38 Bacteria Proteobacteria   Gammaproteobacteria
## 17:  OTU_479 Bacteria Proteobacteria   Alphaproteobacteria
## 18: OTU_5192 Bacteria Proteobacteria    Betaproteobacteria
## 19:  OTU_461 Bacteria     Firmicutes            Clostridia
## 20: OTU_5454 Bacteria Proteobacteria   Gammaproteobacteria
## 21: OTU_1228 Bacteria Proteobacteria   Alphaproteobacteria
## 22:   OTU_16 Bacteria Proteobacteria    Betaproteobacteria
## 23:   OTU_13 Bacteria Proteobacteria    Betaproteobacteria
## 24:  OTU_671 Bacteria Actinobacteria        Actinobacteria
## 25: OTU_4624 Bacteria Proteobacteria    Betaproteobacteria
## 26:  OTU_349 Bacteria Proteobacteria   Deltaproteobacteria
## 27: OTU_3429 Bacteria Proteobacteria   Gammaproteobacteria
## 28: OTU_5307 Bacteria Proteobacteria    Betaproteobacteria
## 29: OTU_5367 Bacteria Actinobacteria        Actinobacteria
## 30: OTU_1476 Bacteria  Cyanobacteria Oscillatoriophycideae
## 31:  OTU_582 Bacteria Proteobacteria   Alphaproteobacteria
## 32: OTU_3721 Bacteria Proteobacteria    Betaproteobacteria
## 33: OTU_2100 Bacteria Proteobacteria   Gammaproteobacteria
## 34:  OTU_596 Bacteria  Bacteroidetes      Sphingobacteriia
## 35:  OTU_786 Bacteria Proteobacteria    Betaproteobacteria
## 36: OTU_5113 Bacteria Actinobacteria        Actinobacteria
## 37: OTU_2169 Bacteria  Acidobacteria          Solibacteres
## 38:  OTU_329 Bacteria Proteobacteria   Alphaproteobacteria
## 39:  OTU_550 Bacteria Proteobacteria   Alphaproteobacteria
## 40:  OTU_158 Bacteria Proteobacteria   Deltaproteobacteria
## 41:  OTU_153 Bacteria     Firmicutes               Bacilli
## 42:  OTU_336 Bacteria Proteobacteria   Alphaproteobacteria
## 43:  OTU_338 Bacteria Proteobacteria   Gammaproteobacteria
## 44: OTU_5879 Bacteria Proteobacteria   Alphaproteobacteria
## 45: OTU_5878 Bacteria Proteobacteria   Gammaproteobacteria
## 46: OTU_5667 Bacteria Proteobacteria    Betaproteobacteria
## 47: OTU_2529 Bacteria Proteobacteria    Betaproteobacteria
## 48: OTU_1546 Bacteria Proteobacteria   Gammaproteobacteria
## 49: OTU_1084 Bacteria Proteobacteria                  TA18
## 50: OTU_1762 Bacteria Proteobacteria   Alphaproteobacteria
## 51: OTU_5702 Bacteria Proteobacteria    Betaproteobacteria
## 52:  OTU_502 Bacteria  Bacteroidetes        Flavobacteriia
## 53: OTU_5548 Bacteria Proteobacteria    Betaproteobacteria
## 54: OTU_3269 Bacteria Proteobacteria   Alphaproteobacteria
## 55: OTU_2132 Bacteria Actinobacteria        Actinobacteria
## 56:  OTU_510 Bacteria Proteobacteria    Betaproteobacteria
## 57: OTU_1741 Bacteria     Firmicutes               Bacilli
## 58: OTU_5447 Bacteria Proteobacteria    Betaproteobacteria
## 59:  OTU_126 Bacteria  Bacteroidetes      Sphingobacteriia
## 60: OTU_5623 Bacteria  Bacteroidetes        Flavobacteriia
## 61: OTU_4920 Bacteria Proteobacteria    Betaproteobacteria
## 62:  OTU_717 Bacteria  Bacteroidetes        Flavobacteriia
## 63:  OTU_711 Bacteria  Bacteroidetes        Flavobacteriia
## 64: OTU_1080 Bacteria  Bacteroidetes        Flavobacteriia
## 65: OTU_2718 Bacteria Proteobacteria   Alphaproteobacteria
## 66:   OTU_81 Bacteria     Firmicutes               Bacilli
## 67: OTU_5972 Bacteria Proteobacteria    Betaproteobacteria
## 68:  OTU_221 Bacteria Proteobacteria   Alphaproteobacteria
## 69: OTU_1708 Bacteria  Bacteroidetes         [Saprospirae]
## 70: OTU_1700 Bacteria     Firmicutes               Bacilli
## 71:  OTU_219 Bacteria       [Thermi]            Deinococci
## 72:  OTU_218 Bacteria  Acidobacteria  [Chloracidobacteria]
## 73: OTU_5745 Bacteria Proteobacteria    Betaproteobacteria
## 74: OTU_2748 Bacteria  Bacteroidetes           Bacteroidia
## 75:  OTU_130 Bacteria Proteobacteria    Betaproteobacteria
## 76: OTU_1759 Bacteria Proteobacteria   Alphaproteobacteria
## 77: OTU_5763 Bacteria Proteobacteria   Alphaproteobacteria
## 78: OTU_4759 Bacteria Proteobacteria    Betaproteobacteria
## 79: OTU_5029 Bacteria Proteobacteria    Betaproteobacteria
## 80:  OTU_355 Bacteria Proteobacteria   Gammaproteobacteria
##          OTU   domain         phylum                 class
##                  order              family             genus
##  1:    Burkholderiales      Comamonadaceae                  
##  2:    Burkholderiales      Comamonadaceae       Ramlibacter
##  3: Sphingobacteriales Sphingobacteriaceae  Sphingobacterium
##  4:      Rhodocyclales      Rhodocyclaceae          Zoogloea
##  5:    Burkholderiales      Comamonadaceae                  
##  6:   Sphingomonadales   Sphingomonadaceae   Novosphingobium
##  7:      Rhodocyclales      Rhodocyclaceae                  
##  8:    Burkholderiales      Comamonadaceae                  
##  9:    Rhodobacterales     Hyphomonadaceae                  
## 10:        Rhizobiales   Bradyrhizobiaceae                  
## 11:       Cytophagales       Cytophagaceae                  
## 12:       Cytophagales       Cytophagaceae      Hymenobacter
## 13:                                                         
## 14:  Oceanospirillales      Halomonadaceae        Candidatus
## 15:    Burkholderiales      Comamonadaceae       Methylibium
## 16:    Pseudomonadales    Pseudomonadaceae       Pseudomonas
## 17:    Rhodobacterales    Rhodobacteraceae        Paracoccus
## 18:    Burkholderiales      Comamonadaceae         Pelomonas
## 19:      Clostridiales   [Tissierellaceae]        Finegoldia
## 20:    Xanthomonadales    Xanthomonadaceae                  
## 21:   Rhodospirillales    Acetobacteraceae        Roseomonas
## 22:    Burkholderiales      Comamonadaceae     Aquabacterium
## 23:    Burkholderiales      Comamonadaceae        Acidovorax
## 24:    Actinomycetales    Mycobacteriaceae     Mycobacterium
## 25:    Burkholderiales      Comamonadaceae       Curvibacter
## 26:              MIZ46                                      
## 27:  Enterobacteriales  Enterobacteriaceae           Erwinia
## 28:    Burkholderiales      Comamonadaceae                  
## 29:    Actinomycetales  Intrasporangiaceae                  
## 30:      Chroococcales       Xenococcaceae                  
## 31:    Caulobacterales    Caulobacteraceae                  
## 32:    Burkholderiales    Oxalobacteraceae Janthinobacterium
## 33:    Pseudomonadales    Pseudomonadaceae       Pseudomonas
## 34: Sphingobacteriales                                      
## 35:    Burkholderiales      Comamonadaceae                  
## 36:    Actinomycetales   Microbacteriaceae   Salinibacterium
## 37:     Solibacterales                                      
## 38:    Caulobacterales    Caulobacteraceae                  
## 39:        Rhizobiales Methylobacteriaceae  Methylobacterium
## 40:       Myxococcales                                      
## 41:    Lactobacillales    Lactobacillaceae     Lactobacillus
## 42:        Rhizobiales Methylobacteriaceae                  
## 43:    Pseudomonadales    Pseudomonadaceae       Pseudomonas
## 44:        Rhizobiales                                      
## 45:    Pseudomonadales       Moraxellaceae     Acinetobacter
## 46:    Burkholderiales      Comamonadaceae                  
## 47:    Burkholderiales      Comamonadaceae                  
## 48:    Alteromonadales             211ds20                  
## 49:          PHOS-HD29                                      
## 50:   Sphingomonadales   Sphingomonadaceae      Sphingomonas
## 51:      Rhodocyclales      Rhodocyclaceae     Dechloromonas
## 52:   Flavobacteriales   Flavobacteriaceae    Flavobacterium
## 53:      Rhodocyclales      Rhodocyclaceae     Dechloromonas
## 54:   Sphingomonadales   Sphingomonadaceae      Sphingomonas
## 55:    Actinomycetales              ACK-M1                  
## 56:      Rhodocyclales      Rhodocyclaceae     Dechloromonas
## 57:    Lactobacillales    Lactobacillaceae     Lactobacillus
## 58:    Burkholderiales      Comamonadaceae        Acidovorax
## 59: Sphingobacteriales Sphingobacteriaceae        Pedobacter
## 60:   Flavobacteriales   Flavobacteriaceae    Flavobacterium
## 61:      Rhodocyclales      Rhodocyclaceae     Dechloromonas
## 62:   Flavobacteriales     [Weeksellaceae]  Chryseobacterium
## 63:   Flavobacteriales     [Weeksellaceae]   Elizabethkingia
## 64:   Flavobacteriales     [Weeksellaceae]  Chryseobacterium
## 65:    Caulobacterales    Caulobacteraceae                  
## 66:         Gemellales         Gemellaceae           Gemella
## 67:    Burkholderiales      Comamonadaceae     Limnohabitans
## 68:    Rhodobacterales    Rhodobacteraceae       Rhodobacter
## 69:    [Saprospirales]                                      
## 70:         Bacillales   Staphylococcaceae      Salinicoccus
## 71:      Deinococcales      Deinococcaceae       Deinococcus
## 72:               RB41           Ellin6075                  
## 73:    Burkholderiales      Comamonadaceae                  
## 74:      Bacteroidales      Bacteroidaceae       Bacteroides
## 75:    Burkholderiales    Oxalobacteraceae                  
## 76:      Rickettsiales        mitochondria                  
## 77:                                                         
## 78:    Burkholderiales      Comamonadaceae                  
## 79:    Burkholderiales      Comamonadaceae                  
## 80:  Oceanospirillales      Halomonadaceae         Halomonas
##                  order              family             genus
## [1] &quot;Highest degree OTU was OTU_4191 (degree = 33 ):&quot;
##         OTU   domain         phylum               class           order
## 1: OTU_4191 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##           family         genus
## 1: Moraxellaceae Acinetobacter
## [1] &quot;Other OTUs in the same community as OTU_4191 :&quot;
##          OTU   domain          phylum                 class
##  1: OTU_4337 Bacteria  Proteobacteria   Gammaproteobacteria
##  2: OTU_3169 Bacteria  Actinobacteria        Actinobacteria
##  3:   OTU_60 Bacteria   Bacteroidetes        Flavobacteriia
##  4: OTU_3158 Bacteria  Proteobacteria    Betaproteobacteria
##  5:   OTU_51 Bacteria  Actinobacteria        Actinobacteria
##  6:   OTU_57 Bacteria      Firmicutes               Bacilli
##  7: OTU_3924 Bacteria  Proteobacteria    Betaproteobacteria
##  8: OTU_3461 Bacteria  Proteobacteria    Betaproteobacteria
##  9: OTU_3913 Bacteria  Proteobacteria    Betaproteobacteria
## 10:  OTU_362 Bacteria      Firmicutes            Clostridia
## 11: OTU_2435 Bacteria  Proteobacteria   Alphaproteobacteria
## 12:   OTU_28 Bacteria   Bacteroidetes        Flavobacteriia
## 13:  OTU_601 Bacteria  Proteobacteria   Gammaproteobacteria
## 14: OTU_4837 Bacteria  Proteobacteria    Betaproteobacteria
## 15:   OTU_69 Bacteria  Proteobacteria   Gammaproteobacteria
## 16:  OTU_810 Bacteria      Firmicutes            Clostridia
## 17: OTU_3115 Bacteria  Proteobacteria   Gammaproteobacteria
## 18: OTU_5778 Bacteria  Proteobacteria   Gammaproteobacteria
## 19: OTU_5776 Bacteria  Proteobacteria   Gammaproteobacteria
## 20: OTU_1400 Bacteria      Firmicutes            Clostridia
## 21: OTU_1298 Bacteria  Proteobacteria   Gammaproteobacteria
## 22:  OTU_256 Bacteria  Proteobacteria    Betaproteobacteria
## 23: OTU_1385 Bacteria   Bacteroidetes            Cytophagia
## 24:  OTU_351 Bacteria  Proteobacteria    Betaproteobacteria
## 25: OTU_4161 Bacteria  Proteobacteria   Alphaproteobacteria
## 26:  OTU_107 Bacteria  Proteobacteria    Betaproteobacteria
## 27: OTU_3341 Bacteria  Proteobacteria    Betaproteobacteria
## 28: OTU_1829 Bacteria  Proteobacteria   Alphaproteobacteria
## 29: OTU_4191 Bacteria  Proteobacteria   Gammaproteobacteria
## 30:  OTU_172 Bacteria  Proteobacteria    Betaproteobacteria
## 31:  OTU_318 Bacteria Verrucomicrobia      Verrucomicrobiae
## 32: OTU_4036 Bacteria  Proteobacteria   Gammaproteobacteria
## 33: OTU_5104 Bacteria  Proteobacteria   Alphaproteobacteria
## 34: OTU_5324 Bacteria  Proteobacteria   Gammaproteobacteria
## 35: OTU_5312 Bacteria  Actinobacteria        Actinobacteria
## 36: OTU_2800 Bacteria  Proteobacteria   Alphaproteobacteria
## 37: OTU_1379 Bacteria  Proteobacteria Epsilonproteobacteria
## 38: OTU_1699 Bacteria   Acidobacteria       Acidobacteria-6
## 39: OTU_4597 Bacteria  Proteobacteria   Gammaproteobacteria
## 40:  OTU_257 Bacteria  Actinobacteria        Actinobacteria
## 41:  OTU_701 Bacteria  Proteobacteria   Deltaproteobacteria
## 42: OTU_2079 Bacteria  Actinobacteria        Actinobacteria
## 43:  OTU_710 Bacteria      Firmicutes               Bacilli
## 44:  OTU_397 Bacteria  Proteobacteria   Alphaproteobacteria
## 45: OTU_4796 Bacteria  Proteobacteria   Gammaproteobacteria
## 46:  OTU_820 Bacteria Verrucomicrobia              Opitutae
## 47:   OTU_86 Bacteria  Proteobacteria   Gammaproteobacteria
## 48: OTU_3823 Bacteria  Proteobacteria   Gammaproteobacteria
## 49:   OTU_72 Bacteria  Proteobacteria   Gammaproteobacteria
## 50:   OTU_70 Bacteria  Actinobacteria        Actinobacteria
## 51: OTU_5701 Bacteria  Proteobacteria    Betaproteobacteria
## 52: OTU_2734 Bacteria Armatimonadetes      [Fimbriimonadia]
## 53: OTU_4955 Bacteria  Proteobacteria    Betaproteobacteria
## 54: OTU_3282 Bacteria  Proteobacteria    Betaproteobacteria
## 55:  OTU_965 Bacteria  Actinobacteria        Actinobacteria
## 56: OTU_5917 Bacteria  Proteobacteria   Gammaproteobacteria
## 57:    OTU_8 Bacteria  Proteobacteria   Alphaproteobacteria
## 58:    OTU_6 Bacteria  Proteobacteria   Gammaproteobacteria
## 59:  OTU_200 Bacteria  Proteobacteria   Gammaproteobacteria
## 60: OTU_3619 Bacteria  Proteobacteria   Alphaproteobacteria
## 61: OTU_4345 Bacteria  Proteobacteria   Gammaproteobacteria
## 62: OTU_4570 Bacteria  Proteobacteria   Gammaproteobacteria
##          OTU   domain          phylum                 class
##                  order               family             genus
##  1:    Pseudomonadales        Moraxellaceae     Acinetobacter
##  2:    Actinomycetales Propionibacteriaceae Propionibacterium
##  3:   Flavobacteriales    Flavobacteriaceae    Flavobacterium
##  4:    Burkholderiales     Oxalobacteraceae    Herbaspirillum
##  5:    Actinomycetales    Microbacteriaceae        Candidatus
##  6:    Lactobacillales     Streptococcaceae       Lactococcus
##  7:    Burkholderiales       Comamonadaceae                  
##  8:    Burkholderiales       Comamonadaceae     Limnohabitans
##  9:    Burkholderiales       Comamonadaceae                  
## 10:      Clostridiales    [Tissierellaceae]      Anaerococcus
## 11:        Rhizobiales  Methylobacteriaceae                  
## 12:   Flavobacteriales      [Weeksellaceae]  Chryseobacterium
## 13:  Enterobacteriales   Enterobacteriaceae          Yersinia
## 14:    Burkholderiales       Comamonadaceae                  
## 15:    Alteromonadales     Alteromonadaceae        Cellvibrio
## 16:      Clostridiales       Clostridiaceae                  
## 17:    Pseudomonadales        Moraxellaceae     Acinetobacter
## 18:    Pseudomonadales        Moraxellaceae     Acinetobacter
## 19:    Pseudomonadales        Moraxellaceae     Acinetobacter
## 20:      Clostridiales      Ruminococcaceae                  
## 21:    Pseudomonadales     Pseudomonadaceae       Pseudomonas
## 22:    Burkholderiales     Oxalobacteraceae Janthinobacterium
## 23:       Cytophagales        Cytophagaceae      Hymenobacter
## 24:      Rhodocyclales       Rhodocyclaceae     Dechloromonas
## 25:      Rickettsiales         mitochondria                  
## 26:    Burkholderiales     Oxalobacteraceae Janthinobacterium
## 27:    Burkholderiales     Oxalobacteraceae                  
## 28:        Rhizobiales    Hyphomicrobiaceae           Devosia
## 29:    Pseudomonadales        Moraxellaceae     Acinetobacter
## 30:    Burkholderiales       Comamonadaceae        Rhodoferax
## 31: Verrucomicrobiales  Verrucomicrobiaceae   Prosthecobacter
## 32:    Pseudomonadales        Moraxellaceae     Acinetobacter
## 33:   Sphingomonadales    Sphingomonadaceae   Novosphingobium
## 34:    Pseudomonadales        Moraxellaceae     Acinetobacter
## 35:    Actinomycetales  Geodermatophilaceae                  
## 36:    Rhodobacterales     Rhodobacteraceae       Rhodobacter
## 37:  Campylobacterales    Helicobacteraceae     Sulfuricurvum
## 38:            iii1-15               mb2424                  
## 39:    Pseudomonadales        Moraxellaceae     Acinetobacter
## 40:    Actinomycetales                                       
## 41:       Myxococcales        Myxococcaceae                  
## 42:    Actinomycetales      Nocardioidaceae                  
## 43:         Bacillales          Bacillaceae     Anoxybacillus
## 44:    Rhodobacterales     Rhodobacteraceae        Paracoccus
## 45:    Pseudomonadales        Moraxellaceae     Acinetobacter
## 46:   [Cerasicoccales]    [Cerasicoccaceae]                  
## 47:      Aeromonadales       Aeromonadaceae                  
## 48:    Pseudomonadales        Moraxellaceae     Acinetobacter
## 49:    Pseudomonadales        Moraxellaceae     Acinetobacter
## 50:    Actinomycetales   Corynebacteriaceae   Corynebacterium
## 51:    Burkholderiales       Comamonadaceae                  
## 52: [Fimbriimonadales]  [Fimbriimonadaceae]                  
## 53:      Rhodocyclales       Rhodocyclaceae     Dechloromonas
## 54:    Burkholderiales       Comamonadaceae         Comamonas
## 55:    Actinomycetales     Dermabacteraceae   Brachybacterium
## 56:  Enterobacteriales   Enterobacteriaceae                  
## 57:   Rhodospirillales     Acetobacteraceae     Gluconobacter
## 58:    Pseudomonadales        Moraxellaceae     Acinetobacter
## 59:     Pasteurellales      Pasteurellaceae       Haemophilus
## 60:      Rickettsiales         mitochondria                  
## 61:    Pseudomonadales        Moraxellaceae     Acinetobacter
## 62:    Pseudomonadales        Moraxellaceae     Acinetobacter
##                  order               family             genus
## [1] &quot;Highest degree OTU was OTU_5823 (degree = 64 ):&quot;
##         OTU   domain         phylum               class           order
## 1: OTU_5823 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##           family         genus
## 1: Moraxellaceae Acinetobacter
## [1] &quot;Other OTUs in the same community as OTU_5823 :&quot;
##           OTU   domain         phylum               class
##   1:   OTU_26 Bacteria Proteobacteria  Betaproteobacteria
##   2: OTU_1002 Bacteria Actinobacteria     Thermoleophilia
##   3: OTU_1000 Bacteria Proteobacteria Alphaproteobacteria
##   4: OTU_1004 Bacteria Proteobacteria  Betaproteobacteria
##   5:  OTU_638 Bacteria Actinobacteria      Actinobacteria
##  ---                                                     
##  97: OTU_3972 Bacteria Proteobacteria  Betaproteobacteria
##  98:  OTU_770 Bacteria Proteobacteria                TA18
##  99:  OTU_403 Bacteria Actinobacteria      Actinobacteria
## 100: OTU_5257 Bacteria Proteobacteria  Betaproteobacteria
## 101:   OTU_78 Bacteria Proteobacteria Gammaproteobacteria
##                    order           family         genus
##   1:                                                   
##   2: Solirubrobacterales                               
##   3:         Rhizobiales     Rhizobiaceae Agrobacterium
##   4:     Burkholderiales   Comamonadaceae    Variovorax
##   5:     Actinomycetales           ACK-M1              
##  ---                                                   
##  97:       Rhodocyclales   Rhodocyclaceae Dechloromonas
##  98:           PHOS-HD29                               
##  99:     Actinomycetales  Nocardioidaceae              
## 100:     Burkholderiales   Comamonadaceae     Pelomonas
## 101:     Xanthomonadales Xanthomonadaceae              
## [1] &quot;Highest degree OTU was OTU_3174 (degree = 39 ):&quot;
##         OTU   domain         phylum               class           order
## 1: OTU_3174 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##              family       genus
## 1: Pseudomonadaceae Pseudomonas
## [1] &quot;Other OTUs in the same community as OTU_3174 :&quot;
##          OTU   domain         phylum               class             order
##  1:  OTU_433 Bacteria Actinobacteria      Actinobacteria   Actinomycetales
##  2: OTU_1159 Bacteria     Firmicutes             Bacilli   Lactobacillales
##  3: OTU_3781 Bacteria  Bacteroidetes          Cytophagia      Cytophagales
##  4:   OTU_50 Bacteria     Firmicutes             Bacilli        Bacillales
##  5:   OTU_40 Bacteria Proteobacteria  Betaproteobacteria      Neisseriales
##  6:  OTU_848 Bacteria Actinobacteria      Actinobacteria   Actinomycetales
##  7: OTU_5213 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##  8: OTU_4126 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##  9: OTU_5289 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
## 10: OTU_3496 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 11:  OTU_808 Bacteria Proteobacteria Deltaproteobacteria      Myxococcales
## 12: OTU_4153 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 13: OTU_5408 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 14: OTU_3388 Bacteria     Firmicutes             Bacilli   Lactobacillales
## 15: OTU_3525 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 16: OTU_5498 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 17: OTU_4397 Bacteria     Firmicutes             Bacilli        Bacillales
## 18: OTU_3613 Bacteria Proteobacteria  Betaproteobacteria     Rhodocyclales
## 19: OTU_3346 Bacteria     Firmicutes             Bacilli   Lactobacillales
## 20: OTU_2109 Bacteria Proteobacteria Alphaproteobacteria  Rhodospirillales
## 21:  OTU_110 Bacteria Proteobacteria Alphaproteobacteria       Rhizobiales
## 22:  OTU_376       No          blast                 hit                  
## 23:  OTU_569 Bacteria     Firmicutes             Bacilli        Bacillales
## 24: OTU_3986 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
## 25: OTU_5637 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 26: OTU_2172 Bacteria Proteobacteria Gammaproteobacteria    Pasteurellales
## 27:  OTU_157 Bacteria Actinobacteria      Actinobacteria   Actinomycetales
## 28:  OTU_888 Bacteria   Spirochaetes        Spirochaetes    Spirochaetales
## 29:  OTU_339 Bacteria     Firmicutes             Bacilli   Lactobacillales
## 30: OTU_5784 Bacteria Proteobacteria Alphaproteobacteria       Rhizobiales
## 31: OTU_5646 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 32: OTU_1554 Bacteria Proteobacteria Alphaproteobacteria   Rhodobacterales
## 33:  OTU_412 Bacteria Actinobacteria      Actinobacteria   Actinomycetales
## 34: OTU_5242 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 35: OTU_3391 Bacteria Proteobacteria Gammaproteobacteria     Legionellales
## 36: OTU_1359 Bacteria     Firmicutes             Bacilli   Lactobacillales
## 37:  OTU_625 Bacteria Proteobacteria Alphaproteobacteria       Rhizobiales
## 38:  OTU_393 Bacteria     Firmicutes          Clostridia     Clostridiales
## 39: OTU_4701 Bacteria Proteobacteria Gammaproteobacteria   Alteromonadales
## 40: OTU_4938 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
## 41:  OTU_906 Bacteria Actinobacteria      Actinobacteria   Actinomycetales
## 42:  OTU_730 Bacteria    Tenericutes          Mollicutes Acholeplasmatales
## 43: OTU_2003 Bacteria     Firmicutes             Bacilli        Bacillales
## 44:  OTU_968 Bacteria Proteobacteria Gammaproteobacteria   Xanthomonadales
## 45: OTU_1071 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
## 46:   OTU_94 Bacteria Proteobacteria                TA18         PHOS-HD29
## 47:  OTU_417 Bacteria Actinobacteria      Actinobacteria   Actinomycetales
## 48: OTU_1059 Bacteria Actinobacteria      Actinobacteria   Actinomycetales
## 49: OTU_4508 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
## 50:  OTU_132 Bacteria Proteobacteria Deltaproteobacteria      Myxococcales
## 51: OTU_5038 Bacteria Proteobacteria  Betaproteobacteria     Rhodocyclales
## 52: OTU_3174 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##          OTU   domain         phylum               class             order
##                 family           genus
##  1: Corynebacteriaceae Corynebacterium
##  2:      Aerococcaceae       Facklamia
##  3:      Cytophagaceae  Flectobacillus
##  4:        Bacillaceae                
##  5:      Neisseriaceae                
##  6:    Nocardioidaceae    Nocardioides
##  7:      Moraxellaceae   Acinetobacter
##  8:     Comamonadaceae                
##  9:       mitochondria                
## 10: Enterobacteriaceae         Erwinia
## 11:     Nannocystaceae     Nannocystis
## 12: Enterobacteriaceae         Erwinia
## 13:                                   
## 14:   Leuconostocaceae     Leuconostoc
## 15:   Burkholderiaceae    Burkholderia
## 16:     Comamonadaceae      Roseateles
## 17:  Staphylococcaceae  Staphylococcus
## 18:     Rhodocyclaceae   Dechloromonas
## 19:  Carnobacteriaceae                
## 20:   Acetobacteraceae     Roseococcus
## 21: Phyllobacteriaceae                
## 22:                                   
## 23:   Paenibacillaceae                
## 24:      Moraxellaceae   Acinetobacter
## 25:     Comamonadaceae                
## 26:    Pasteurellaceae  Actinobacillus
## 27:     Micrococcaceae     Micrococcus
## 28:    Spirochaetaceae       Treponema
## 29:    Enterococcaceae    Enterococcus
## 30:   Methylocystaceae                
## 31:     Comamonadaceae                
## 32:   Rhodobacteraceae     Rhodobacter
## 33:  Brevibacteriaceae  Brevibacterium
## 34:     Comamonadaceae                
## 35:       Coxiellaceae   Rickettsiella
## 36:                                   
## 37:  Hyphomicrobiaceae  Hyphomicrobium
## 38:     Clostridiaceae     Clostridium
## 39:   Alteromonadaceae                
## 40:       mitochondria                
## 41:  Microbacteriaceae                
## 42: Acholeplasmataceae      Candidatus
## 43:        Bacillaceae        Bacillus
## 44:   Xanthomonadaceae                
## 45:       mitochondria                
## 46:                                   
## 47:       Nocardiaceae     Rhodococcus
## 48:  Brevibacteriaceae  Brevibacterium
## 49:       mitochondria                
## 50:          0319-6G20                
## 51:     Rhodocyclaceae   Dechloromonas
## 52:   Pseudomonadaceae     Pseudomonas
##                 family           genus
## [1] &quot;Highest degree OTU was OTU_18 (degree = 50 ):&quot;
##       OTU   domain     phylum   class           order           family
## 1: OTU_18 Bacteria Firmicutes Bacilli Lactobacillales Lactobacillaceae
##            genus
## 1: Lactobacillus
## [1] &quot;Other OTUs in the same community as OTU_18 :&quot;
##          OTU   domain          phylum                 class
##  1:  OTU_435 Bacteria  Actinobacteria        Actinobacteria
##  2: OTU_3883 Bacteria  Proteobacteria    Betaproteobacteria
##  3: OTU_3780 Bacteria  Proteobacteria    Betaproteobacteria
##  4:   OTU_65 Bacteria  Proteobacteria   Alphaproteobacteria
##  5:  OTU_699 Bacteria  Proteobacteria   Alphaproteobacteria
##  6:   OTU_21 Bacteria  Proteobacteria   Gammaproteobacteria
##  7:   OTU_20 Bacteria  Proteobacteria   Gammaproteobacteria
##  8: OTU_5135 Bacteria  Proteobacteria    Betaproteobacteria
##  9:  OTU_635 Bacteria  Proteobacteria   Gammaproteobacteria
## 10: OTU_3478 Bacteria  Proteobacteria   Alphaproteobacteria
## 11:   OTU_45 Bacteria  Proteobacteria   Gammaproteobacteria
## 12:   OTU_49 Bacteria      Firmicutes               Bacilli
## 13:  OTU_622 Bacteria  Proteobacteria   Deltaproteobacteria
## 14:  OTU_990 Bacteria   Bacteroidetes      Sphingobacteriia
## 15: OTU_3733 Bacteria  Proteobacteria   Alphaproteobacteria
## 16:   OTU_32 Bacteria  Proteobacteria   Gammaproteobacteria
## 17:  OTU_610 Bacteria  Proteobacteria   Deltaproteobacteria
## 18: OTU_4110 Bacteria  Proteobacteria   Alphaproteobacteria
## 19:  OTU_690 Bacteria  Actinobacteria        Actinobacteria
## 20: OTU_3128 Bacteria  Proteobacteria    Betaproteobacteria
## 21:   OTU_29 Bacteria  Proteobacteria    Betaproteobacteria
## 22:  OTU_609 Bacteria  Actinobacteria        Actinobacteria
## 23:  OTU_282 Bacteria Verrucomicrobia      Verrucomicrobiae
## 24: OTU_4618 Bacteria  Actinobacteria        Actinobacteria
## 25: OTU_5238 Bacteria  Proteobacteria   Alphaproteobacteria
## 26:  OTU_868 Bacteria      Firmicutes               Bacilli
## 27: OTU_5302 Bacteria  Proteobacteria   Alphaproteobacteria
## 28:  OTU_964 Bacteria  Proteobacteria   Deltaproteobacteria
## 29:   OTU_18 Bacteria      Firmicutes               Bacilli
## 30: OTU_1632 Bacteria  Proteobacteria Epsilonproteobacteria
## 31:  OTU_653 Bacteria   Bacteroidetes            Cytophagia
## 32: OTU_4635 Bacteria  Proteobacteria    Betaproteobacteria
## 33: OTU_3492 Bacteria  Proteobacteria   Gammaproteobacteria
## 34: OTU_3646 Bacteria  Proteobacteria   Gammaproteobacteria
## 35:  OTU_659 Bacteria      Firmicutes               Bacilli
## 36:  OTU_139 Bacteria  Actinobacteria        Actinobacteria
## 37: OTU_2120 Bacteria  Proteobacteria   Alphaproteobacteria
## 38:  OTU_356 Bacteria  Proteobacteria   Gammaproteobacteria
## 39: OTU_3510 Bacteria  Proteobacteria   Alphaproteobacteria
## 40: OTU_5600 Bacteria  Proteobacteria   Alphaproteobacteria
## 41: OTU_5822 Bacteria  Proteobacteria   Gammaproteobacteria
## 42:  OTU_683 Bacteria  Actinobacteria        Actinobacteria
## 43: OTU_2103 Bacteria  Proteobacteria   Alphaproteobacteria
## 44: OTU_3505 Bacteria  Proteobacteria   Gammaproteobacteria
## 45:  OTU_371       No           blast                   hit
## 46:  OTU_164 Bacteria      Firmicutes               Bacilli
## 47:  OTU_187 Bacteria  Proteobacteria    Betaproteobacteria
## 48:  OTU_303 Bacteria      Firmicutes            Clostridia
## 49: OTU_5755 Bacteria  Proteobacteria    Betaproteobacteria
## 50: OTU_5629 Bacteria  Proteobacteria   Gammaproteobacteria
## 51: OTU_1831 Bacteria  Proteobacteria   Gammaproteobacteria
## 52: OTU_5806 Bacteria  Proteobacteria   Gammaproteobacteria
## 53: OTU_2168 Bacteria  Proteobacteria   Gammaproteobacteria
## 54: OTU_1631 Bacteria  Proteobacteria   Alphaproteobacteria
## 55: OTU_1338 Bacteria   Acidobacteria  [Chloracidobacteria]
## 56: OTU_5839 Bacteria  Proteobacteria   Gammaproteobacteria
## 57:  OTU_899 Bacteria  Proteobacteria   Gammaproteobacteria
## 58: OTU_2244 Bacteria  Proteobacteria   Deltaproteobacteria
## 59: OTU_5795 Bacteria  Proteobacteria   Gammaproteobacteria
## 60:  OTU_885 Bacteria  Actinobacteria        Actinobacteria
## 61: OTU_5780 Bacteria  Proteobacteria   Alphaproteobacteria
## 62: OTU_5655 Bacteria  Proteobacteria    Betaproteobacteria
## 63: OTU_5872 Bacteria  Proteobacteria    Betaproteobacteria
## 64:   OTU_92 Bacteria  Proteobacteria   Alphaproteobacteria
## 65: OTU_1300 Bacteria  Proteobacteria   Alphaproteobacteria
## 66: OTU_5664 Bacteria   Bacteroidetes        Flavobacteriia
## 67: OTU_2303 Bacteria           WPS-2                      
## 68: OTU_5247 Bacteria  Proteobacteria   Gammaproteobacteria
## 69:  OTU_193 Bacteria  Actinobacteria       Thermoleophilia
## 70:  OTU_277 Bacteria   Bacteroidetes      Sphingobacteriia
## 71: OTU_5753 Bacteria  Proteobacteria    Betaproteobacteria
## 72:  OTU_267 Bacteria      Firmicutes               Bacilli
## 73: OTU_2898 Bacteria  Proteobacteria   Alphaproteobacteria
## 74: OTU_3241 Bacteria  Actinobacteria        Actinobacteria
## 75: OTU_5939 Bacteria  Proteobacteria   Gammaproteobacteria
## 76:  OTU_253 Bacteria      Firmicutes               Bacilli
## 77:  OTU_705 Bacteria  Proteobacteria   Alphaproteobacteria
## 78:  OTU_231 Bacteria  Proteobacteria   Alphaproteobacteria
## 79: OTU_5953 Bacteria  Proteobacteria   Alphaproteobacteria
## 80: OTU_3006 Bacteria  Proteobacteria   Gammaproteobacteria
## 81: OTU_2069 Bacteria  Actinobacteria        Actinobacteria
## 82:  OTU_238 Bacteria  Proteobacteria   Alphaproteobacteria
## 83:  OTU_941 Bacteria      Firmicutes               Bacilli
## 84: OTU_5398 Bacteria  Proteobacteria   Gammaproteobacteria
## 85: OTU_3824 Bacteria  Proteobacteria   Alphaproteobacteria
## 86:  OTU_836 Bacteria  Proteobacteria   Alphaproteobacteria
## 87:  OTU_407 Bacteria      Firmicutes               Bacilli
## 88: OTU_4895 Bacteria  Proteobacteria    Betaproteobacteria
## 89:  OTU_969 Bacteria  Proteobacteria   Alphaproteobacteria
## 90:    OTU_3 Bacteria  Proteobacteria   Gammaproteobacteria
## 91:    OTU_7 Bacteria   Bacteroidetes        Flavobacteriia
## 92: OTU_2746 Bacteria  Actinobacteria        Actinobacteria
## 93: OTU_1416 Bacteria      Firmicutes               Bacilli
## 94:  OTU_824 Bacteria  Proteobacteria   Alphaproteobacteria
## 95: OTU_3181 Bacteria  Actinobacteria        Actinobacteria
## 96: OTU_5743 Bacteria  Proteobacteria   Alphaproteobacteria
## 97: OTU_1934 Bacteria  Proteobacteria   Alphaproteobacteria
## 98:   OTU_74 Bacteria  Actinobacteria        Actinobacteria
##          OTU   domain          phylum                 class
##                   order                family             genus
##  1:     Actinomycetales        Micrococcaceae           Kocuria
##  2:     Burkholderiales        Comamonadaceae         Comamonas
##  3:       Rhodocyclales        Rhodocyclaceae     Dechloromonas
##  4:    Sphingomonadales     Sphingomonadaceae      Sphingomonas
##  5:         Rhizobiales     Hyphomicrobiaceae                  
##  6:     Pseudomonadales      Pseudomonadaceae       Pseudomonas
##  7:     Pseudomonadales         Moraxellaceae     Acinetobacter
##  8:     Burkholderiales        Comamonadaceae                  
##  9:     Pseudomonadales         Moraxellaceae                  
## 10:       Rickettsiales          mitochondria                  
## 11:     Pseudomonadales         Moraxellaceae     Enhydrobacter
## 12:     Lactobacillales      Streptococcaceae     Streptococcus
## 13:   Bdellovibrionales    Bdellovibrionaceae      Bdellovibrio
## 14:  Sphingobacteriales   Sphingobacteriaceae                  
## 15:    Sphingomonadales     Sphingomonadaceae      Sphingomonas
## 16:   Enterobacteriales    Enterobacteriaceae                  
## 17:               MIZ46                                        
## 18:         Rhizobiales      Methylocystaceae                  
## 19:     Actinomycetales       Kineosporiaceae                  
## 20:     Burkholderiales      Oxalobacteraceae                  
## 21:        Neisseriales         Neisseriaceae                  
## 22:     Actinomycetales    Corynebacteriaceae   Corynebacterium
## 23:  Verrucomicrobiales   Verrucomicrobiaceae                  
## 24:     Actinomycetales     Microbacteriaceae    Curtobacterium
## 25:    Sphingomonadales     Sphingomonadaceae   Novosphingobium
## 26:          Bacillales           Bacillaceae          Bacillus
## 27:       Rickettsiales          mitochondria                  
## 28:        Myxococcales                                        
## 29:     Lactobacillales      Lactobacillaceae     Lactobacillus
## 30:   Campylobacterales     Helicobacteraceae                  
## 31:        Cytophagales         Cytophagaceae         Emticicia
## 32:     Burkholderiales        Comamonadaceae                  
## 33:   Enterobacteriales    Enterobacteriaceae           Erwinia
## 34:   Enterobacteriales    Enterobacteriaceae                  
## 35:          Bacillales      Paenibacillaceae                  
## 36:     Actinomycetales                ACK-M1                  
## 37:         Rhizobiales     Hyphomicrobiaceae       Rhodoplanes
## 38:     Pseudomonadales         Moraxellaceae     Acinetobacter
## 39:    Sphingomonadales     Sphingomonadaceae                  
## 40:       Rickettsiales          mitochondria                  
## 41:   Enterobacteriales    Enterobacteriaceae           Erwinia
## 42:     Actinomycetales      Actinomycetaceae       Actinomyces
## 43:       Rickettsiales          mitochondria                  
## 44:   Enterobacteriales    Enterobacteriaceae           Erwinia
## 45:                                                            
## 46:          Bacillales      Paenibacillaceae     Paenibacillus
## 47:       Rhodocyclales        Rhodocyclaceae   Hydrogenophilus
## 48:       Clostridiales Peptostreptococcaceae                  
## 49:     Burkholderiales        Comamonadaceae                  
## 50:   Enterobacteriales    Enterobacteriaceae                  
## 51:      Pasteurellales       Pasteurellaceae   Aggregatibacter
## 52:   Enterobacteriales    Enterobacteriaceae                  
## 53:   Enterobacteriales    Enterobacteriaceae      Enterobacter
## 54:         Rhizobiales   Methylobacteriaceae                  
## 55:                RB41             Ellin6075                  
## 56:   Enterobacteriales    Enterobacteriaceae        Klebsiella
## 57:       Legionellales        Legionellaceae                  
## 58:               MIZ46                                        
## 59:   Enterobacteriales    Enterobacteriaceae                  
## 60:     Actinomycetales        Dermacoccaceae       Dermacoccus
## 61:       Rickettsiales          mitochondria                  
## 62:     Burkholderiales        Comamonadaceae                  
## 63:     Burkholderiales        Comamonadaceae                  
## 64:    Sphingomonadales     Sphingomonadaceae      Sphingomonas
## 65:       Rickettsiales          mitochondria                  
## 66:    Flavobacteriales     Flavobacteriaceae    Flavobacterium
## 67:                                                            
## 68:   Enterobacteriales    Enterobacteriaceae                  
## 69: Solirubrobacterales     Patulibacteraceae                  
## 70:  Sphingobacteriales   Sphingobacteriaceae        Pedobacter
## 71:     Burkholderiales        Comamonadaceae                  
## 72:          Bacillales      Paenibacillaceae     Paenibacillus
## 73:    Sphingomonadales     Sphingomonadaceae      Sphingomonas
## 74:     Actinomycetales    Corynebacteriaceae   Corynebacterium
## 75:   Enterobacteriales    Enterobacteriaceae        Klebsiella
## 76:          Bacillales           Bacillaceae   Natronobacillus
## 77:         Rhizobiales     Bradyrhizobiaceae       Balneimonas
## 78:    Sphingomonadales     Sphingomonadaceae      Sphingomonas
## 79:    Sphingomonadales     Sphingomonadaceae      Sphingomonas
## 80:     Xanthomonadales      Xanthomonadaceae                  
## 81:     Actinomycetales        Micrococcaceae                  
## 82:         Rhizobiales          Rhizobiaceae        Candidatus
## 83:          Bacillales   [Exiguobacteraceae]   Exiguobacterium
## 84:     Pseudomonadales      Pseudomonadaceae       Pseudomonas
## 85:    Sphingomonadales     Sphingomonadaceae      Sphingomonas
## 86:    Sphingomonadales    Erythrobacteraceae                  
## 87:          Bacillales      Paenibacillaceae     Paenibacillus
## 88:     Burkholderiales        Comamonadaceae        Acidovorax
## 89:    Sphingomonadales     Sphingomonadaceae      Kaistobacter
## 90:   Enterobacteriales    Enterobacteriaceae           Erwinia
## 91:    Flavobacteriales       [Weeksellaceae]   Cloacibacterium
## 92:     Actinomycetales        Micrococcaceae      Arthrobacter
## 93:          Bacillales      Paenibacillaceae     Paenibacillus
## 94:         Rhizobiales      Methylocystaceae                  
## 95:     Actinomycetales    Corynebacteriaceae   Corynebacterium
## 96:    Sphingomonadales     Sphingomonadaceae      Sphingomonas
## 97:       Rickettsiales          mitochondria                  
## 98:     Actinomycetales  Propionibacteriaceae Propionibacterium
##                   order                family             genus
## [1] &quot;Highest degree OTU was OTU_225 (degree = 40 ):&quot;
##        OTU   domain         phylum               class           order
## 1: OTU_225 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##           family         genus
## 1: Moraxellaceae Acinetobacter
## [1] &quot;Other OTUs in the same community as OTU_225 :&quot;
##          OTU   domain         phylum                class
##  1:   OTU_66 Bacteria Proteobacteria  Alphaproteobacteria
##  2:   OTU_23 Bacteria Proteobacteria   Betaproteobacteria
##  3:   OTU_22 Bacteria Proteobacteria   Betaproteobacteria
##  4: OTU_1144 Bacteria  Bacteroidetes       Flavobacteriia
##  5: OTU_2057 Bacteria Proteobacteria  Gammaproteobacteria
##  6: OTU_3334 Bacteria Proteobacteria  Gammaproteobacteria
##  7:  OTU_847 Bacteria Proteobacteria  Alphaproteobacteria
##  8: OTU_4055 Bacteria Proteobacteria   Betaproteobacteria
##  9: OTU_4555 Bacteria     Firmicutes              Bacilli
## 10: OTU_5190 Bacteria Proteobacteria   Betaproteobacteria
## 11:   OTU_14 Bacteria Proteobacteria   Betaproteobacteria
## 12:   OTU_62 Bacteria Proteobacteria  Alphaproteobacteria
## 13: OTU_5412 Bacteria Proteobacteria  Gammaproteobacteria
## 14: OTU_4633 Bacteria Proteobacteria  Gammaproteobacteria
## 15: OTU_4627 Bacteria Proteobacteria   Betaproteobacteria
## 16:  OTU_258 Bacteria  Bacteroidetes          Bacteroidia
## 17: OTU_4387 Bacteria     Firmicutes              Bacilli
## 18: OTU_4419 Bacteria Proteobacteria  Alphaproteobacteria
## 19: OTU_3509 Bacteria Proteobacteria   Betaproteobacteria
## 20: OTU_1618 Bacteria     Firmicutes           Clostridia
## 21:  OTU_166 Bacteria  Bacteroidetes        [Saprospirae]
## 22:  OTU_304 Bacteria Proteobacteria  Gammaproteobacteria
## 23: OTU_5111 Bacteria Proteobacteria   Betaproteobacteria
## 24: OTU_4004 Bacteria  Bacteroidetes        [Saprospirae]
## 25: OTU_2346 Bacteria Actinobacteria       Actinobacteria
## 26: OTU_4218 Bacteria Proteobacteria   Betaproteobacteria
## 27: OTU_5819 Bacteria Proteobacteria   Betaproteobacteria
## 28: OTU_4680 Bacteria  Bacteroidetes       Flavobacteriia
## 29: OTU_5867 Bacteria Proteobacteria  Gammaproteobacteria
## 30:  OTU_156 Bacteria Proteobacteria   Betaproteobacteria
## 31: OTU_3664 Bacteria Proteobacteria  Gammaproteobacteria
## 32: OTU_1987 Bacteria Proteobacteria   Betaproteobacteria
## 33:  OTU_268 Bacteria Actinobacteria       Actinobacteria
## 34: OTU_4598 Bacteria     Firmicutes              Bacilli
## 35:  OTU_233 Bacteria     Firmicutes              Bacilli
## 36:   OTU_88 Bacteria Proteobacteria   Betaproteobacteria
## 37:  OTU_837 Bacteria Proteobacteria  Gammaproteobacteria
## 38:  OTU_225 Bacteria Proteobacteria  Gammaproteobacteria
## 39: OTU_2870 Bacteria Proteobacteria   Betaproteobacteria
## 40: OTU_5382 Bacteria Proteobacteria  Alphaproteobacteria
## 41:   OTU_71 Bacteria  Acidobacteria [Chloracidobacteria]
## 42:  OTU_131 Bacteria Proteobacteria  Gammaproteobacteria
## 43: OTU_5443 Bacteria Proteobacteria   Betaproteobacteria
## 44:  OTU_779 Bacteria  Bacteroidetes          Bacteroidia
## 45: OTU_2229 Bacteria Proteobacteria  Alphaproteobacteria
## 46: OTU_2220 Bacteria Actinobacteria       Actinobacteria
## 47: OTU_2595 Bacteria Proteobacteria  Gammaproteobacteria
##          OTU   domain         phylum                class
##                 order              family             genus
##  1:  Rhodospirillales    Acetobacteraceae     Swaminathania
##  2:   Burkholderiales      Comamonadaceae       Tepidimonas
##  3:   Burkholderiales      Comamonadaceae        Variovorax
##  4:  Flavobacteriales   Flavobacteriaceae    Flavobacterium
##  5:   Xanthomonadales     Sinobacteraceae                  
##  6:   Alteromonadales    Alteromonadaceae        Cellvibrio
##  7:   Caulobacterales    Caulobacteraceae         Mycoplana
##  8:   Burkholderiales      Comamonadaceae     Limnohabitans
##  9:        Bacillales      Planococcaceae      Solibacillus
## 10:   Burkholderiales    Oxalobacteraceae                  
## 11:   Burkholderiales      Comamonadaceae                  
## 12:       Rhizobiales Methylobacteriaceae  Methylobacterium
## 13:   Xanthomonadales    Xanthomonadaceae  Stenotrophomonas
## 14:   Pseudomonadales       Moraxellaceae     Acinetobacter
## 15:   Burkholderiales      Comamonadaceae    Hydrogenophaga
## 16:     Bacteroidales      Prevotellaceae        Prevotella
## 17:        Bacillales         Bacillaceae     Anoxybacillus
## 18:  Sphingomonadales   Sphingomonadaceae                  
## 19:   Burkholderiales    Oxalobacteraceae                  
## 20:     Clostridiales     Lachnospiraceae           Blautia
## 21:   [Saprospirales]      Saprospiraceae                  
## 22:     Aeromonadales      Aeromonadaceae                  
## 23:   Burkholderiales      Comamonadaceae                  
## 24:   [Saprospirales]    Chitinophagaceae Sediminibacterium
## 25:   Actinomycetales    Actinomycetaceae       Actinomyces
## 26:   Burkholderiales      Comamonadaceae        Rhodoferax
## 27:   Burkholderiales    Oxalobacteraceae Janthinobacterium
## 28:  Flavobacteriales   Flavobacteriaceae    Flavobacterium
## 29: Enterobacteriales  Enterobacteriaceae                  
## 30:   Burkholderiales    Oxalobacteraceae  Polynucleobacter
## 31:     Aeromonadales      Aeromonadaceae         Tolumonas
## 32:   Burkholderiales      Comamonadaceae                  
## 33:   Actinomycetales  Intrasporangiaceae        Janibacter
## 34:        Bacillales         Bacillaceae     Anoxybacillus
## 35:        Bacillales    Paenibacillaceae     Paenibacillus
## 36:   Burkholderiales    Oxalobacteraceae                  
## 37: Oceanospirillales      Halomonadaceae         Halomonas
## 38:   Pseudomonadales       Moraxellaceae     Acinetobacter
## 39:   Burkholderiales      Comamonadaceae     Limnohabitans
## 40:       Rhizobiales Methylobacteriaceae  Methylobacterium
## 41:              RB41           Ellin6075                  
## 42:   Pseudomonadales       Moraxellaceae                  
## 43:   Burkholderiales    Oxalobacteraceae                  
## 44:     Bacteroidales      Bacteroidaceae       Bacteroides
## 45:   Rhodobacterales    Rhodobacteraceae  Rubellimicrobium
## 46:   Actinomycetales              ACK-M1                  
## 47:   Pseudomonadales       Moraxellaceae     Acinetobacter
##                 order              family             genus
## [1] &quot;Highest degree OTU was OTU_440 (degree = 19 ):&quot;
##        OTU   domain     phylum   class           order           family
## 1: OTU_440 Bacteria Firmicutes Bacilli Lactobacillales Lactobacillaceae
##            genus
## 1: Lactobacillus
## [1] &quot;Other OTUs in the same community as OTU_440 :&quot;
##          OTU   domain          phylum               class
##  1:   OTU_55 Bacteria  Actinobacteria      Actinobacteria
##  2: OTU_1786 Bacteria Verrucomicrobia      [Pedosphaerae]
##  3:  OTU_194 Bacteria  Proteobacteria Deltaproteobacteria
##  4:  OTU_440 Bacteria      Firmicutes             Bacilli
##  5: OTU_5475 Bacteria  Proteobacteria Gammaproteobacteria
##  6:  OTU_743 Bacteria   Bacteroidetes       [Saprospirae]
##  7: OTU_1966 Bacteria      Firmicutes             Bacilli
##  8:  OTU_285 Bacteria   Bacteroidetes      Flavobacteriia
##  9:  OTU_460 Bacteria  Proteobacteria Gammaproteobacteria
## 10:  OTU_466 Bacteria  Proteobacteria Deltaproteobacteria
## 11:  OTU_464 Bacteria  Proteobacteria Deltaproteobacteria
## 12: OTU_4616 Bacteria  Proteobacteria Gammaproteobacteria
## 13:  OTU_480 Bacteria  Proteobacteria Alphaproteobacteria
## 14: OTU_1243 Bacteria   Bacteroidetes       [Saprospirae]
## 15:  OTU_345 Bacteria  Proteobacteria Gammaproteobacteria
## 16: OTU_5345 Bacteria   Bacteroidetes    Sphingobacteriia
## 17:  OTU_980 Bacteria      Firmicutes             Bacilli
## 18:  OTU_173 Bacteria  Actinobacteria      Actinobacteria
## 19: OTU_5796 Bacteria  Proteobacteria Gammaproteobacteria
## 20: OTU_3232 Bacteria  Proteobacteria Gammaproteobacteria
## 21: OTU_1552 Bacteria     Chloroflexi           Ellin6529
## 22: OTU_4222 Bacteria  Proteobacteria Alphaproteobacteria
## 23:  OTU_252 Bacteria   Cyanobacteria              4C0d-2
## 24:  OTU_383 Bacteria   Bacteroidetes       [Saprospirae]
## 25:  OTU_928 Bacteria  Proteobacteria Alphaproteobacteria
## 26: OTU_5891 Bacteria  Proteobacteria Gammaproteobacteria
## 27: OTU_5938 Bacteria  Proteobacteria Alphaproteobacteria
## 28: OTU_1717 Bacteria  Actinobacteria      Actinobacteria
## 29:  OTU_905 Bacteria  Proteobacteria Deltaproteobacteria
## 30: OTU_5970 Bacteria  Proteobacteria Gammaproteobacteria
## 31:  OTU_214 Bacteria  Proteobacteria Gammaproteobacteria
## 32: OTU_3603 Bacteria  Actinobacteria      Actinobacteria
## 33:    OTU_9 Bacteria  Proteobacteria Gammaproteobacteria
## 34: OTU_1101 Bacteria  Proteobacteria Gammaproteobacteria
## 35: OTU_1055 Bacteria    Fusobacteria       Fusobacteriia
## 36: OTU_1054 Bacteria      Firmicutes          Clostridia
## 37: OTU_1028 Bacteria  Proteobacteria Alphaproteobacteria
##          OTU   domain          phylum               class
##                  order             family             genus
##  1:    Actinomycetales Corynebacteriaceae   Corynebacterium
##  2:   [Pedosphaerales]           Ellin517                  
##  3:       Myxococcales                                     
##  4:    Lactobacillales   Lactobacillaceae     Lactobacillus
##  5:    Pseudomonadales   Pseudomonadaceae       Pseudomonas
##  6:    [Saprospirales]   Chitinophagaceae                  
##  7:    Lactobacillales      Aerococcaceae       Abiotrophia
##  8:   Flavobacteriales    [Weeksellaceae]  Chryseobacterium
##  9:    Xanthomonadales   Xanthomonadaceae        Luteimonas
## 10: Desulfuromonadales     Geobacteraceae         Geobacter
## 11:  Bdellovibrionales Bdellovibrionaceae      Bdellovibrio
## 12:  Enterobacteriales Enterobacteriaceae        Klebsiella
## 13:   Rhodospirillales   Acetobacteraceae                  
## 14:    [Saprospirales]   Chitinophagaceae                  
## 15:  Oceanospirillales     Halomonadaceae Haererehalobacter
## 16: Sphingobacteriales                                     
## 17:         Bacillales   Paenibacillaceae     Paenibacillus
## 18:    Actinomycetales Micromonosporaceae                  
## 19:  Enterobacteriales Enterobacteriaceae                  
## 20:  Enterobacteriales Enterobacteriaceae                  
## 21:                                                        
## 22:      Rickettsiales       mitochondria                  
## 23:            MLE1-12                                     
## 24:    [Saprospirales]   Chitinophagaceae Sediminibacterium
## 25:        Rhizobiales  Hyphomicrobiaceae    Hyphomicrobium
## 26:  Enterobacteriales Enterobacteriaceae                  
## 27:        Rhizobiales  Bradyrhizobiaceae                  
## 28:    Actinomycetales    Nocardioidaceae      Nocardioides
## 29:              MIZ46                                     
## 30:  Enterobacteriales Enterobacteriaceae                  
## 31:    Xanthomonadales   Xanthomonadaceae  Stenotrophomonas
## 32:    Actinomycetales  Microbacteriaceae                  
## 33:    Pseudomonadales   Pseudomonadaceae       Pseudomonas
## 34:      Legionellales     Legionellaceae                  
## 35:    Fusobacteriales                                     
## 36:      Clostridiales    Veillonellaceae       Veillonella
## 37:   Sphingomonadales  Sphingomonadaceae      Sphingopyxis
##                  order             family             genus
## [1] &quot;Highest degree OTU was OTU_179 (degree = 11 ):&quot;
##        OTU   domain         phylum               class           order
## 1: OTU_179 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##              family       genus
## 1: Pseudomonadaceae Pseudomonas
## [1] &quot;Other OTUs in the same community as OTU_179 :&quot;
##          OTU   domain         phylum                 class
##  1:  OTU_452 Bacteria Proteobacteria Epsilonproteobacteria
##  2: OTU_4053 Bacteria  Bacteroidetes        Flavobacteriia
##  3: OTU_1193 Bacteria Actinobacteria        Actinobacteria
##  4: OTU_1275 Bacteria  Bacteroidetes        Flavobacteriia
##  5:  OTU_179 Bacteria Proteobacteria   Gammaproteobacteria
##  6:  OTU_402 Bacteria Proteobacteria    Betaproteobacteria
##  7:   OTU_99 Bacteria Actinobacteria        Actinobacteria
##  8: OTU_1570 Bacteria  Bacteroidetes            Cytophagia
##  9:  OTU_834 Bacteria Proteobacteria   Alphaproteobacteria
## 10: OTU_4071 Bacteria Actinobacteria        Actinobacteria
## 11: OTU_4516 Bacteria Proteobacteria    Betaproteobacteria
##                 order             family          genus
##  1: Campylobacterales Campylobacteraceae     Arcobacter
##  2:  Flavobacteriales  Flavobacteriaceae Flavobacterium
##  3:   Actinomycetales       Nocardiaceae    Rhodococcus
##  4:  Flavobacteriales  Flavobacteriaceae Flavobacterium
##  5:   Pseudomonadales   Pseudomonadaceae    Pseudomonas
##  6:      Neisseriales      Neisseriaceae      Neisseria
##  7:   Actinomycetales     Micrococcaceae               
##  8:      Cytophagales      Cytophagaceae   Hymenobacter
##  9:       Rhizobiales  Hyphomicrobiaceae Hyphomicrobium
## 10:   Actinomycetales                                  
## 11:   Burkholderiales     Comamonadaceae  Limnohabitans</code></pre>
<pre class="r"><code>plot(bagged_communities_greedy_positive, gr_bagged_positive, 
     layout = layout.fruchterman.reingold(gr_bagged_positive),
     rescaled = TRUE,
     vertex.size = 2, 
     vertex.label = NA
)</code></pre>
<p><img src="bacteria_community_analysis_files/figure-html/tbp.1-1.png" width="672" /></p>
<p>The modularity score of the community structure is:</p>
<pre class="r"><code>(tbp.mod &lt;- modularity(gr_bagged_positive, membership(bagged_communities_greedy_positive)))</code></pre>
<pre><code>## [1] 0.4762388</code></pre>
</div>
<div id="negative-weights-2" class="section level3">
<h3>Negative Weights</h3>
<pre class="r"><code>bagged_data_negative &lt;- trimmed_negative_weights[treatment == &quot;Bagged&quot;]
bagged_data_negative &lt;- bagged_data_negative[, -1]
bagged_data_negative[[3]] &lt;- abs(bagged_data_negative[[3]])
gr_bagged_negative &lt;- graph.data.frame(bagged_data_negative, directed = FALSE)
bagged_communities_greedy_negative &lt;- cluster_fast_greedy(gr_bagged_negative, weights = E(gr_bagged_negative)$rho)

hot_otus &lt;- vector()
for (community in communities(bagged_communities_greedy_negative))
{
  sub_graph &lt;- induced.subgraph(graph = gr_bagged_negative, 
                                    v = community, impl = &quot;auto&quot;)
  highest_degree_otu &lt;- V(sub_graph)[which.max(degree(sub_graph))]$name
  hot_otus &lt;- c(hot_otus, highest_degree_otu)
  print(paste(&quot;Highest degree OTU was&quot;, highest_degree_otu, &quot;(degree =&quot;,  
              degree(sub_graph, highest_degree_otu), &quot;):&quot;))
  print(taxa[OTU == highest_degree_otu])
        
  print(paste(&quot;Other OTUs in the same community as&quot;, highest_degree_otu, &quot;:&quot;))
  print(taxa[OTU %in% community])
}</code></pre>
<pre><code>## [1] &quot;Highest degree OTU was OTU_5398 (degree = 2 ):&quot;
##         OTU   domain         phylum               class           order
## 1: OTU_5398 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##              family       genus
## 1: Pseudomonadaceae Pseudomonas
## [1] &quot;Other OTUs in the same community as OTU_5398 :&quot;
##         OTU   domain         phylum               class           order
## 1:    OTU_5 Bacteria Proteobacteria Alphaproteobacteria   Rickettsiales
## 2: OTU_4938 Bacteria Proteobacteria Alphaproteobacteria   Rickettsiales
## 3: OTU_5398 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
## 4:    OTU_6 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##              family         genus
## 1:     mitochondria              
## 2:     mitochondria              
## 3: Pseudomonadaceae   Pseudomonas
## 4:    Moraxellaceae Acinetobacter
## [1] &quot;Highest degree OTU was OTU_8 (degree = 4 ):&quot;
##      OTU   domain         phylum               class            order
## 1: OTU_8 Bacteria Proteobacteria Alphaproteobacteria Rhodospirillales
##              family         genus
## 1: Acetobacteraceae Gluconobacter
## [1] &quot;Other OTUs in the same community as OTU_8 :&quot;
##         OTU   domain         phylum               class             order
## 1: OTU_3478 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
## 2: OTU_5867 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 3:    OTU_8 Bacteria Proteobacteria Alphaproteobacteria  Rhodospirillales
## 4:    OTU_3 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 5: OTU_5257 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##                family         genus
## 1:       mitochondria              
## 2: Enterobacteriaceae              
## 3:   Acetobacteraceae Gluconobacter
## 4: Enterobacteriaceae       Erwinia
## 5:     Comamonadaceae     Pelomonas
## [1] &quot;Highest degree OTU was OTU_21 (degree = 3 ):&quot;
##       OTU   domain         phylum               class           order
## 1: OTU_21 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##              family       genus
## 1: Pseudomonadaceae Pseudomonas
## [1] &quot;Other OTUs in the same community as OTU_21 :&quot;
##        OTU   domain         phylum               class           order
## 1:  OTU_21 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
## 2:  OTU_51 Bacteria Actinobacteria      Actinobacteria Actinomycetales
## 3: OTU_510 Bacteria Proteobacteria  Betaproteobacteria   Rhodocyclales
## 4: OTU_131 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##               family         genus
## 1:  Pseudomonadaceae   Pseudomonas
## 2: Microbacteriaceae    Candidatus
## 3:    Rhodocyclaceae Dechloromonas
## 4:     Moraxellaceae              
## [1] &quot;Highest degree OTU was OTU_4036 (degree = 1 ):&quot;
##         OTU   domain         phylum               class           order
## 1: OTU_4036 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##           family         genus
## 1: Moraxellaceae Acinetobacter
## [1] &quot;Other OTUs in the same community as OTU_4036 :&quot;
##         OTU   domain         phylum               class             order
## 1: OTU_3492 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 2: OTU_4036 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##                family         genus
## 1: Enterobacteriaceae       Erwinia
## 2:      Moraxellaceae Acinetobacter</code></pre>
<pre class="r"><code>plot(bagged_communities_greedy_negative, gr_bagged_negative, 
     layout = layout.fruchterman.reingold(gr_bagged_negative),
     rescaled = TRUE,
     vertex.size = 2, 
     vertex.label = NA)</code></pre>
<p><img src="bacteria_community_analysis_files/figure-html/tbn.1-1.png" width="672" /></p>
<p>Modularity score:</p>
<pre class="r"><code>(tbn.mod &lt;- modularity(gr_bagged_negative, membership(bagged_communities_greedy_negative)))</code></pre>
<pre><code>## [1] 0.505102</code></pre>
</div>
</div>
<div id="all-treatments" class="section level2">
<h2>All Treatments</h2>
<p>We will now look at all treatments together. Note that data points from Bird samples have already been removed.</p>
<div id="positive-weights-3" class="section level3">
<h3>Positive Weights</h3>
<pre class="r"><code>trimmed_all_positive &lt;- trimmed_positive_weights[, -1]
gr_trimmed_all_positive &lt;- graph.data.frame(trimmed_all_positive, directed = FALSE)
trimmed_all_positive_communities &lt;- cluster_fast_greedy(gr_trimmed_all_positive, 
                                    weights = E(gr_trimmed_all_positive)$rho)</code></pre>
<pre><code>## Error in cluster_fast_greedy(gr_trimmed_all_positive, weights = E(gr_trimmed_all_positive)$rho): At fast_community.c:639 : fast-greedy community finding works only on graphs without multiple edges, Invalid value</code></pre>
<p>Because all the treatments are being combined into one graph, there can be multiple (parallel) edges between OTUs. The clustering algorithm we have been using requires that there not be multiple edges between OTUs. We will collapse multiple edges by taking their mean - that is the mean correlation of the two OTUs across all treatments. (Are there potential problems with this collapsing rule?)</p>
<pre class="r"><code>gr_trimmed_all_positive &lt;- simplify(gr_trimmed_all_positive, 
                                    edge.attr.comb = &quot;mean&quot;)
trimmed_all_positive_communities &lt;- cluster_fast_greedy(gr_trimmed_all_positive, 
                                    weights = E(gr_trimmed_all_positive)$rho)

hot_otus &lt;- vector()
for (community in communities(trimmed_all_positive_communities))
{
  sub_graph &lt;- induced.subgraph(graph = gr_trimmed_all_positive, 
                                    v = community, impl = &quot;auto&quot;)
  highest_degree_otu &lt;- V(sub_graph)[which.max(degree(sub_graph))]$name
  hot_otus &lt;- c(hot_otus, highest_degree_otu)
  print(paste(&quot;Highest degree OTU was&quot;, highest_degree_otu, &quot;(degree =&quot;,  
              degree(sub_graph, highest_degree_otu), &quot;):&quot;))
  print(taxa[OTU == highest_degree_otu])
        
  print(paste(&quot;Other OTUs in the same community as&quot;, highest_degree_otu, &quot;:&quot;))
  print(taxa[OTU %in% community])
}</code></pre>
<pre><code>## [1] &quot;Highest degree OTU was OTU_44 (degree = 92 ):&quot;
##       OTU   domain         phylum               class           order
## 1: OTU_44 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##              family       genus
## 1: Pseudomonadaceae Pseudomonas
## [1] &quot;Other OTUs in the same community as OTU_44 :&quot;
##           OTU   domain         phylum                 class
##   1: OTU_3304 Bacteria Proteobacteria    Betaproteobacteria
##   2:   OTU_64 Bacteria Proteobacteria   Gammaproteobacteria
##   3:  OTU_421 Bacteria  Cyanobacteria Oscillatoriophycideae
##   4:   OTU_21 Bacteria Proteobacteria   Gammaproteobacteria
##   5: OTU_1002 Bacteria Actinobacteria       Thermoleophilia
##  ---                                                       
## 187: OTU_3367 Bacteria Proteobacteria   Gammaproteobacteria
## 188: OTU_3967 Bacteria Actinobacteria        Actinobacteria
## 189:  OTU_543 Bacteria Actinobacteria        Actinobacteria
## 190: OTU_1934 Bacteria Proteobacteria   Alphaproteobacteria
## 191:   OTU_75 Bacteria Proteobacteria   Gammaproteobacteria
##                    order             family             genus
##   1:     Burkholderiales   Oxalobacteraceae                  
##   2:     Pseudomonadales   Pseudomonadaceae                  
##   3:       Chroococcales      Xenococcaceae Chroococcidiopsis
##   4:     Pseudomonadales   Pseudomonadaceae       Pseudomonas
##   5: Solirubrobacterales                                     
##  ---                                                         
## 187:   Enterobacteriales Enterobacteriaceae           Erwinia
## 188:     Actinomycetales  Sanguibacteraceae      Sanguibacter
## 189:   Bifidobacteriales Bifidobacteriaceae   Bifidobacterium
## 190:       Rickettsiales       mitochondria                  
## 191:     Pseudomonadales      Moraxellaceae         Moraxella
## [1] &quot;Highest degree OTU was OTU_18 (degree = 113 ):&quot;
##       OTU   domain     phylum   class           order           family
## 1: OTU_18 Bacteria Firmicutes Bacilli Lactobacillales Lactobacillaceae
##            genus
## 1: Lactobacillus
## [1] &quot;Other OTUs in the same community as OTU_18 :&quot;
##           OTU   domain          phylum               class
##   1: OTU_1484 Bacteria   Bacteroidetes    Sphingobacteriia
##   2: OTU_1154 Bacteria  Proteobacteria  Betaproteobacteria
##   3: OTU_1035 Bacteria   Bacteroidetes    Sphingobacteriia
##   4: OTU_3780 Bacteria  Proteobacteria  Betaproteobacteria
##   5:  OTU_699 Bacteria  Proteobacteria Alphaproteobacteria
##  ---                                                      
## 175: OTU_1530 Bacteria  Proteobacteria Alphaproteobacteria
## 176: OTU_1123 Bacteria Verrucomicrobia    Verrucomicrobiae
## 177: OTU_5743 Bacteria  Proteobacteria Alphaproteobacteria
## 178: OTU_2220 Bacteria  Actinobacteria      Actinobacteria
## 179:   OTU_74 Bacteria  Actinobacteria      Actinobacteria
##                   order               family             genus
##   1: Sphingobacteriales                                       
##   2:      Rhodocyclales       Rhodocyclaceae     Dechloromonas
##   3: Sphingobacteriales  Sphingobacteriaceae  Sphingobacterium
##   4:      Rhodocyclales       Rhodocyclaceae     Dechloromonas
##   5:        Rhizobiales    Hyphomicrobiaceae                  
##  ---                                                          
## 175:    Caulobacterales     Caulobacteraceae                  
## 176: Verrucomicrobiales  Verrucomicrobiaceae                  
## 177:   Sphingomonadales    Sphingomonadaceae      Sphingomonas
## 178:    Actinomycetales               ACK-M1                  
## 179:    Actinomycetales Propionibacteriaceae Propionibacterium
## [1] &quot;Highest degree OTU was OTU_225 (degree = 80 ):&quot;
##        OTU   domain         phylum               class           order
## 1: OTU_225 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##           family         genus
## 1: Moraxellaceae Acinetobacter
## [1] &quot;Other OTUs in the same community as OTU_225 :&quot;
##           OTU   domain         phylum                 class
##   1: OTU_5708 Bacteria Proteobacteria    Betaproteobacteria
##   2:   OTU_66 Bacteria Proteobacteria   Alphaproteobacteria
##   3: OTU_3434 Bacteria Proteobacteria Epsilonproteobacteria
##   4: OTU_3436 Bacteria Proteobacteria    Betaproteobacteria
##   5: OTU_1144 Bacteria  Bacteroidetes        Flavobacteriia
##  ---                                                       
## 117:  OTU_958 Bacteria  Bacteroidetes         [Saprospirae]
## 118: OTU_1212 Bacteria  Cyanobacteria Synechococcophycideae
## 119: OTU_2229 Bacteria Proteobacteria   Alphaproteobacteria
## 120: OTU_2595 Bacteria Proteobacteria   Gammaproteobacteria
## 121:   OTU_78 Bacteria Proteobacteria   Gammaproteobacteria
##                  order             family            genus
##   1:   Burkholderiales     Comamonadaceae                 
##   2:  Rhodospirillales   Acetobacteraceae    Swaminathania
##   3: Campylobacterales Campylobacteraceae       Arcobacter
##   4:   Burkholderiales     Comamonadaceae                 
##   5:  Flavobacteriales  Flavobacteriaceae   Flavobacterium
##  ---                                                      
## 117:   [Saprospirales]   Chitinophagaceae                 
## 118:  Pseudanabaenales  Pseudanabaenaceae     Leptolyngbya
## 119:   Rhodobacterales   Rhodobacteraceae Rubellimicrobium
## 120:   Pseudomonadales      Moraxellaceae    Acinetobacter
## 121:   Xanthomonadales   Xanthomonadaceae                 
## [1] &quot;Highest degree OTU was OTU_4345 (degree = 91 ):&quot;
##         OTU   domain         phylum               class           order
## 1: OTU_4345 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##           family         genus
## 1: Moraxellaceae Acinetobacter
## [1] &quot;Other OTUs in the same community as OTU_4345 :&quot;
##           OTU   domain         phylum                class           order
##   1: OTU_4337 Bacteria Proteobacteria  Gammaproteobacteria Pseudomonadales
##   2: OTU_3426 Bacteria Proteobacteria   Betaproteobacteria Burkholderiales
##   3:  OTU_895 Bacteria  Acidobacteria      Acidobacteria-6         iii1-15
##   4:  OTU_433 Bacteria Actinobacteria       Actinobacteria Actinomycetales
##   5:  OTU_435 Bacteria Actinobacteria       Actinobacteria Actinomycetales
##  ---                                                                      
## 175:  OTU_772 Bacteria  Acidobacteria [Chloracidobacteria]            PK29
## 176:  OTU_403 Bacteria Actinobacteria       Actinobacteria Actinomycetales
## 177: OTU_1214 Bacteria  Bacteroidetes          VC2_1_Bac22                
## 178: OTU_5038 Bacteria Proteobacteria   Betaproteobacteria   Rhodocyclales
## 179: OTU_4516 Bacteria Proteobacteria   Betaproteobacteria Burkholderiales
##                  family           genus
##   1:      Moraxellaceae   Acinetobacter
##   2:     Comamonadaceae                
##   3:                                   
##   4: Corynebacteriaceae Corynebacterium
##   5:     Micrococcaceae         Kocuria
##  ---                                   
## 175:                                   
## 176:    Nocardioidaceae                
## 177:                                   
## 178:     Rhodocyclaceae   Dechloromonas
## 179:     Comamonadaceae   Limnohabitans
## [1] &quot;Highest degree OTU was OTU_338 (degree = 58 ):&quot;
##        OTU   domain         phylum               class           order
## 1: OTU_338 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##              family       genus
## 1: Pseudomonadaceae Pseudomonas
## [1] &quot;Other OTUs in the same community as OTU_338 :&quot;
##          OTU   domain          phylum                 class
##  1: OTU_3425 Bacteria  Proteobacteria    Betaproteobacteria
##  2: OTU_5709 Bacteria  Proteobacteria    Betaproteobacteria
##  3:   OTU_67 Bacteria  Proteobacteria   Alphaproteobacteria
##  4:   OTU_22 Bacteria  Proteobacteria    Betaproteobacteria
##  5:   OTU_26 Bacteria  Proteobacteria    Betaproteobacteria
##  6: OTU_3153 Bacteria  Proteobacteria   Alphaproteobacteria
##  7:   OTU_52 Bacteria  Proteobacteria    Betaproteobacteria
##  8:  OTU_457 Bacteria  Proteobacteria    Betaproteobacteria
##  9:   OTU_47 Bacteria  Actinobacteria        Actinobacteria
## 10:   OTU_42 Bacteria   Bacteroidetes            Cytophagia
## 11:  OTU_444 Bacteria  Proteobacteria   Deltaproteobacteria
## 12:  OTU_445 Bacteria  Proteobacteria                  TA18
## 13:  OTU_846 Bacteria   Elusimicrobia         Elusimicrobia
## 14: OTU_5074 Bacteria  Proteobacteria   Gammaproteobacteria
## 15: OTU_4053 Bacteria   Bacteroidetes        Flavobacteriia
## 16: OTU_1193 Bacteria  Actinobacteria        Actinobacteria
## 17:  OTU_875 Bacteria      Firmicutes            Clostridia
## 18: OTU_3609 Bacteria  Proteobacteria   Gammaproteobacteria
## 19: OTU_5047 Bacteria      Firmicutes               Bacilli
## 20: OTU_3910 Bacteria   Bacteroidetes        Flavobacteriia
## 21: OTU_5190 Bacteria  Proteobacteria    Betaproteobacteria
## 22:  OTU_287 Bacteria   Bacteroidetes            Cytophagia
## 23: OTU_5302 Bacteria  Proteobacteria   Alphaproteobacteria
## 24: OTU_1228 Bacteria  Proteobacteria   Alphaproteobacteria
## 25:   OTU_10 Bacteria    Fusobacteria         Fusobacteriia
## 26:  OTU_678 Bacteria             OP3                koll11
## 27: OTU_5035 Bacteria   Bacteroidetes      Sphingobacteriia
## 28: OTU_1861 Bacteria  Actinobacteria        Actinobacteria
## 29: OTU_2444 Bacteria Verrucomicrobia        [Pedosphaerae]
## 30:  OTU_349 Bacteria  Proteobacteria   Deltaproteobacteria
## 31:  OTU_138 Bacteria  Proteobacteria   Deltaproteobacteria
## 32: OTU_4435 Bacteria             OP3                koll11
## 33:  OTU_359 Bacteria             OD1                   ZB2
## 34: OTU_1476 Bacteria   Cyanobacteria Oscillatoriophycideae
## 35:  OTU_585 Bacteria  Proteobacteria   Alphaproteobacteria
## 36:  OTU_583 Bacteria  Proteobacteria Epsilonproteobacteria
## 37: OTU_1275 Bacteria   Bacteroidetes        Flavobacteriia
## 38:  OTU_683 Bacteria  Actinobacteria        Actinobacteria
## 39:  OTU_373 Bacteria  Proteobacteria   Deltaproteobacteria
## 40: OTU_3440 Bacteria  Proteobacteria    Betaproteobacteria
## 41:  OTU_160 Bacteria  Proteobacteria   Gammaproteobacteria
## 42:  OTU_168 Bacteria  Proteobacteria   Alphaproteobacteria
## 43: OTU_2169 Bacteria   Acidobacteria          Solibacteres
## 44:  OTU_179 Bacteria  Proteobacteria   Gammaproteobacteria
## 45: OTU_4218 Bacteria  Proteobacteria    Betaproteobacteria
## 46: OTU_1631 Bacteria  Proteobacteria   Alphaproteobacteria
## 47:  OTU_152 Bacteria  Proteobacteria   Deltaproteobacteria
## 48:  OTU_338 Bacteria  Proteobacteria   Gammaproteobacteria
## 49: OTU_5128 Bacteria  Proteobacteria    Betaproteobacteria
## 50: OTU_5784 Bacteria  Proteobacteria   Alphaproteobacteria
## 51: OTU_5879 Bacteria  Proteobacteria   Alphaproteobacteria
## 52: OTU_4224 Bacteria  Proteobacteria   Gammaproteobacteria
## 53:   OTU_99 Bacteria  Actinobacteria        Actinobacteria
## 54: OTU_5242 Bacteria  Proteobacteria    Betaproteobacteria
## 55: OTU_1997 Bacteria      Firmicutes            Clostridia
## 56: OTU_2316 Bacteria   Bacteroidetes            Cytophagia
## 57: OTU_1570 Bacteria   Bacteroidetes            Cytophagia
## 58:  OTU_276 Bacteria  Proteobacteria    Betaproteobacteria
## 59: OTU_2132 Bacteria  Actinobacteria        Actinobacteria
## 60: OTU_1741 Bacteria      Firmicutes               Bacilli
## 61: OTU_4720 Bacteria  Proteobacteria    Betaproteobacteria
## 62:  OTU_126 Bacteria   Bacteroidetes      Sphingobacteriia
## 63:  OTU_257 Bacteria  Actinobacteria        Actinobacteria
## 64:  OTU_383 Bacteria   Bacteroidetes         [Saprospirae]
## 65:  OTU_231 Bacteria  Proteobacteria   Alphaproteobacteria
## 66:  OTU_544 Bacteria  Actinobacteria        Actinobacteria
## 67: OTU_5553 Bacteria  Proteobacteria   Alphaproteobacteria
## 68:  OTU_834 Bacteria  Proteobacteria   Alphaproteobacteria
## 69:  OTU_711 Bacteria   Bacteroidetes        Flavobacteriia
## 70:  OTU_393 Bacteria      Firmicutes            Clostridia
## 71:  OTU_394 Bacteria  Proteobacteria   Alphaproteobacteria
## 72:  OTU_397 Bacteria  Proteobacteria   Alphaproteobacteria
## 73: OTU_4706 Bacteria  Proteobacteria    Betaproteobacteria
## 74: OTU_5545 Bacteria  Proteobacteria   Alphaproteobacteria
## 75: OTU_4938 Bacteria  Proteobacteria   Alphaproteobacteria
## 76: OTU_4935 Bacteria  Proteobacteria    Betaproteobacteria
## 77:   OTU_85 Bacteria   Bacteroidetes            Cytophagia
## 78: OTU_5938 Bacteria  Proteobacteria   Alphaproteobacteria
## 79: OTU_5710 Bacteria  Proteobacteria    Betaproteobacteria
## 80: OTU_5972 Bacteria  Proteobacteria    Betaproteobacteria
## 81: OTU_1702 Bacteria  Proteobacteria    Betaproteobacteria
## 82: OTU_2748 Bacteria   Bacteroidetes           Bacteroidia
## 83:  OTU_972 Bacteria             OD1                   ZB2
## 84: OTU_5906 Bacteria  Actinobacteria        Actinobacteria
## 85: OTU_1919 Bacteria  Proteobacteria   Alphaproteobacteria
## 86: OTU_1055 Bacteria    Fusobacteria         Fusobacteriia
## 87: OTU_1054 Bacteria      Firmicutes            Clostridia
## 88: OTU_4071 Bacteria  Actinobacteria        Actinobacteria
## 89: OTU_3187 Bacteria  Proteobacteria   Alphaproteobacteria
## 90:  OTU_779 Bacteria   Bacteroidetes           Bacteroidia
## 91:  OTU_409 Bacteria      Firmicutes            Clostridia
## 92: OTU_1028 Bacteria  Proteobacteria   Alphaproteobacteria
## 93: OTU_5257 Bacteria  Proteobacteria    Betaproteobacteria
##          OTU   domain          phylum                 class
##                  order              family             genus
##  1:    Burkholderiales      Comamonadaceae       Ramlibacter
##  2:      Rhodocyclales      Rhodocyclaceae          Zoogloea
##  3:   Sphingomonadales  Erythrobacteraceae                  
##  4:    Burkholderiales      Comamonadaceae        Variovorax
##  5:                                                         
##  6:   Sphingomonadales   Sphingomonadaceae   Novosphingobium
##  7:      Rhodocyclales      Rhodocyclaceae                  
##  8:    Burkholderiales      Comamonadaceae       Tepidimonas
##  9:    Actinomycetales  Corynebacteriaceae   Corynebacterium
## 10:       Cytophagales       Cytophagaceae                  
## 11:  Bdellovibrionales  Bdellovibrionaceae      Bdellovibrio
## 12:          PHOS-HD29                                      
## 13:   Elusimicrobiales                                      
## 14:  Oceanospirillales      Halomonadaceae        Candidatus
## 15:   Flavobacteriales   Flavobacteriaceae    Flavobacterium
## 16:    Actinomycetales        Nocardiaceae       Rhodococcus
## 17:      Clostridiales     Lachnospiraceae           Blautia
## 18:  Oceanospirillales      Halomonadaceae         Halomonas
## 19:         Bacillales   Staphylococcaceae    Staphylococcus
## 20:   Flavobacteriales     [Weeksellaceae]  Chryseobacterium
## 21:    Burkholderiales    Oxalobacteraceae                  
## 22:       Cytophagales       Cytophagaceae      Hymenobacter
## 23:      Rickettsiales        mitochondria                  
## 24:   Rhodospirillales    Acetobacteraceae        Roseomonas
## 25:    Fusobacteriales    Leptotrichiaceae      Leptotrichia
## 26:                                                         
## 27: Sphingobacteriales                                      
## 28:    Actinomycetales Geodermatophilaceae  Geodermatophilus
## 29:   [Pedosphaerales]                                      
## 30:              MIZ46                                      
## 31:                                                         
## 32:                                                         
## 33:                                                         
## 34:      Chroococcales       Xenococcaceae                  
## 35:      Rickettsiales      Rickettsiaceae                  
## 36:  Campylobacterales  Campylobacteraceae  Sulfurospirillum
## 37:   Flavobacteriales   Flavobacteriaceae    Flavobacterium
## 38:    Actinomycetales    Actinomycetaceae       Actinomyces
## 39:       Myxococcales       Haliangiaceae                  
## 40:    Burkholderiales      Comamonadaceae        Rhodoferax
## 41:      Legionellales        Coxiellaceae     Rickettsiella
## 42:    Caulobacterales    Caulobacteraceae  Phenylobacterium
## 43:     Solibacterales                                      
## 44:    Pseudomonadales    Pseudomonadaceae       Pseudomonas
## 45:    Burkholderiales      Comamonadaceae        Rhodoferax
## 46:        Rhizobiales Methylobacteriaceae                  
## 47:                                                         
## 48:    Pseudomonadales    Pseudomonadaceae       Pseudomonas
## 49:    Methylophilales    Methylophilaceae                  
## 50:        Rhizobiales    Methylocystaceae                  
## 51:        Rhizobiales                                      
## 52:  Enterobacteriales  Enterobacteriaceae                  
## 53:    Actinomycetales      Micrococcaceae                  
## 54:    Burkholderiales      Comamonadaceae                  
## 55:      Clostridiales     Ruminococcaceae  Faecalibacterium
## 56:       Cytophagales       Cytophagaceae      Hymenobacter
## 57:       Cytophagales       Cytophagaceae      Hymenobacter
## 58:    Burkholderiales      Comamonadaceae                  
## 59:    Actinomycetales              ACK-M1                  
## 60:    Lactobacillales    Lactobacillaceae     Lactobacillus
## 61:    Burkholderiales      Comamonadaceae                  
## 62: Sphingobacteriales Sphingobacteriaceae        Pedobacter
## 63:    Actinomycetales                                      
## 64:    [Saprospirales]    Chitinophagaceae Sediminibacterium
## 65:   Sphingomonadales   Sphingomonadaceae      Sphingomonas
## 66:    Actinomycetales     Kineosporiaceae                  
## 67:      Rickettsiales        mitochondria                  
## 68:        Rhizobiales   Hyphomicrobiaceae    Hyphomicrobium
## 69:   Flavobacteriales     [Weeksellaceae]   Elizabethkingia
## 70:      Clostridiales      Clostridiaceae       Clostridium
## 71:      Rickettsiales        mitochondria                  
## 72:    Rhodobacterales    Rhodobacteraceae        Paracoccus
## 73:    Burkholderiales      Comamonadaceae                  
## 74:      Rickettsiales        mitochondria                  
## 75:      Rickettsiales        mitochondria                  
## 76:    Burkholderiales    Oxalobacteraceae                  
## 77:       Cytophagales       Cytophagaceae      Hymenobacter
## 78:        Rhizobiales   Bradyrhizobiaceae                  
## 79:    Burkholderiales      Comamonadaceae        Rhodoferax
## 80:    Burkholderiales      Comamonadaceae     Limnohabitans
## 81:    Burkholderiales    Oxalobacteraceae                  
## 82:      Bacteroidales      Bacteroidaceae       Bacteroides
## 83:                                                         
## 84:    Actinomycetales     Nocardioidaceae      Nocardioides
## 85:   Sphingomonadales   Sphingomonadaceae                  
## 86:    Fusobacteriales                                      
## 87:      Clostridiales     Veillonellaceae       Veillonella
## 88:    Actinomycetales                                      
## 89:        Rhizobiales   Hyphomicrobiaceae           Devosia
## 90:      Bacteroidales      Bacteroidaceae       Bacteroides
## 91:      Clostridiales     Lachnospiraceae       Coprococcus
## 92:   Sphingomonadales   Sphingomonadaceae      Sphingopyxis
## 93:    Burkholderiales      Comamonadaceae         Pelomonas
##                  order              family             genus
## [1] &quot;Highest degree OTU was OTU_3174 (degree = 37 ):&quot;
##         OTU   domain         phylum               class           order
## 1: OTU_3174 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##              family       genus
## 1: Pseudomonadaceae Pseudomonas
## [1] &quot;Other OTUs in the same community as OTU_3174 :&quot;
##          OTU   domain         phylum                class
##  1: OTU_5410 Bacteria Proteobacteria  Alphaproteobacteria
##  2: OTU_3950 Bacteria Proteobacteria   Betaproteobacteria
##  3:  OTU_698 Bacteria Proteobacteria  Alphaproteobacteria
##  4: OTU_1006 Bacteria Proteobacteria  Alphaproteobacteria
##  5: OTU_1791 Bacteria Proteobacteria  Alphaproteobacteria
##  6:  OTU_634 Bacteria Actinobacteria       Actinobacteria
##  7:  OTU_288 Bacteria     Firmicutes              Bacilli
##  8:  OTU_854 Bacteria            OD1                  ZB2
##  9: OTU_5066 Bacteria Proteobacteria   Betaproteobacteria
## 10: OTU_3932 Bacteria Proteobacteria  Alphaproteobacteria
## 11: OTU_5194 Bacteria Actinobacteria       Actinobacteria
## 12: OTU_2435 Bacteria Proteobacteria  Alphaproteobacteria
## 13: OTU_4126 Bacteria Proteobacteria   Betaproteobacteria
## 14: OTU_3487 Bacteria Proteobacteria  Gammaproteobacteria
## 15:  OTU_808 Bacteria Proteobacteria  Deltaproteobacteria
## 16: OTU_4447 Bacteria Proteobacteria  Gammaproteobacteria
## 17: OTU_1808 Bacteria Actinobacteria       Actinobacteria
## 18: OTU_5409 Bacteria Proteobacteria  Alphaproteobacteria
## 19: OTU_4433 Bacteria            OD1                  ZB2
## 20: OTU_1674 Bacteria    Chloroflexi          Chloroflexi
## 21: OTU_3613 Bacteria Proteobacteria   Betaproteobacteria
## 22:  OTU_376       No          blast                  hit
## 23:  OTU_180 Bacteria  Bacteroidetes          Bacteroidia
## 24:  OTU_187 Bacteria Proteobacteria   Betaproteobacteria
## 25:  OTU_789 Bacteria     Firmicutes           Clostridia
## 26: OTU_5867 Bacteria Proteobacteria  Gammaproteobacteria
## 27:  OTU_881 Bacteria  Bacteroidetes           Cytophagia
## 28:  OTU_339 Bacteria     Firmicutes              Bacilli
## 29:  OTU_521 Bacteria            OP3               koll11
## 30: OTU_1762 Bacteria Proteobacteria  Alphaproteobacteria
## 31: OTU_1577 Bacteria Actinobacteria       Actinobacteria
## 32:  OTU_626 Bacteria     Firmicutes           Clostridia
## 33: OTU_3599 Bacteria Proteobacteria  Alphaproteobacteria
## 34:  OTU_272 Bacteria Actinobacteria       Actinobacteria
## 35: OTU_1368 Bacteria Proteobacteria   Betaproteobacteria
## 36: OTU_5535 Bacteria Actinobacteria       Actinobacteria
## 37: OTU_3391 Bacteria Proteobacteria  Gammaproteobacteria
## 38: OTU_3271 Bacteria Proteobacteria  Gammaproteobacteria
## 39:  OTU_252 Bacteria  Cyanobacteria               4C0d-2
## 40:  OTU_386 Bacteria  Bacteroidetes     Sphingobacteriia
## 41:  OTU_939 Bacteria Actinobacteria        Rubrobacteria
## 42:   OTU_87 Bacteria Proteobacteria  Deltaproteobacteria
## 43:  OTU_239 Bacteria Planctomycetes       Planctomycetia
## 44:  OTU_730 Bacteria    Tenericutes           Mollicutes
## 45:   OTU_72 Bacteria Proteobacteria  Gammaproteobacteria
## 46:  OTU_218 Bacteria  Acidobacteria [Chloracidobacteria]
## 47: OTU_1071 Bacteria Proteobacteria  Alphaproteobacteria
## 48: OTU_5599 Bacteria Proteobacteria   Betaproteobacteria
## 49:   OTU_91 Bacteria Proteobacteria  Alphaproteobacteria
## 50: OTU_4759 Bacteria Proteobacteria   Betaproteobacteria
## 51:  OTU_417 Bacteria Actinobacteria       Actinobacteria
## 52:  OTU_132 Bacteria Proteobacteria  Deltaproteobacteria
## 53: OTU_3174 Bacteria Proteobacteria  Gammaproteobacteria
##          OTU   domain         phylum                class
##                  order               family              genus
##  1:        Rhizobiales                                        
##  2:    Burkholderiales       Comamonadaceae        Methylibium
##  3:           Ellin329                                        
##  4:        Rhizobiales         Rhizobiaceae          Rhizobium
##  5:      Rickettsiales                                        
##  6:    Actinomycetales   Corynebacteriaceae    Corynebacterium
##  7:         Bacillales       Planococcaceae                   
##  8:                                                           
##  9:    Burkholderiales       Comamonadaceae                   
## 10:   Sphingomonadales    Sphingomonadaceae       Sphingomonas
## 11:    Actinomycetales    Microbacteriaceae    Salinibacterium
## 12:        Rhizobiales  Methylobacteriaceae                   
## 13:    Burkholderiales       Comamonadaceae                   
## 14:  Enterobacteriales   Enterobacteriaceae                   
## 15:       Myxococcales       Nannocystaceae        Nannocystis
## 16:      Legionellales       Legionellaceae                   
## 17:    Actinomycetales      Sporichthyaceae                   
## 18:      Rickettsiales         mitochondria                   
## 19:                                                           
## 20:    [Roseiflexales]                                        
## 21:      Rhodocyclales       Rhodocyclaceae      Dechloromonas
## 22:                                                           
## 23:      Bacteroidales [Paraprevotellaceae]       [Prevotella]
## 24:      Rhodocyclales       Rhodocyclaceae    Hydrogenophilus
## 25:      Clostridiales    [Tissierellaceae]       Anaerococcus
## 26:  Enterobacteriales   Enterobacteriaceae                   
## 27:       Cytophagales        Cytophagaceae          Emticicia
## 28:    Lactobacillales      Enterococcaceae       Enterococcus
## 29:                                                           
## 30:   Sphingomonadales    Sphingomonadaceae       Sphingomonas
## 31:    Actinomycetales                                        
## 32:      Clostridiales                                        
## 33:        Rhizobiales    Hyphomicrobiaceae     Hyphomicrobium
## 34:    Actinomycetales    Microbacteriaceae        Clavibacter
## 35:    Burkholderiales       Comamonadaceae     Hydrogenophaga
## 36:    Actinomycetales       Micrococcaceae             Rothia
## 37:      Legionellales         Coxiellaceae      Rickettsiella
## 38:  Enterobacteriales   Enterobacteriaceae            Erwinia
## 39:            MLE1-12                                        
## 40: Sphingobacteriales                                        
## 41:    Rubrobacterales     Rubrobacteraceae        Rubrobacter
## 42:       Myxococcales            0319-6G20                   
## 43:   Planctomycetales    Planctomycetaceae       Planctomyces
## 44:  Acholeplasmatales   Acholeplasmataceae         Candidatus
## 45:    Pseudomonadales        Moraxellaceae      Acinetobacter
## 46:               RB41            Ellin6075                   
## 47:      Rickettsiales         mitochondria                   
## 48:      Rhodocyclales       Rhodocyclaceae Uliginosibacterium
## 49:    Caulobacterales     Caulobacteraceae        Caulobacter
## 50:    Burkholderiales       Comamonadaceae                   
## 51:    Actinomycetales         Nocardiaceae        Rhodococcus
## 52:       Myxococcales            0319-6G20                   
## 53:    Pseudomonadales     Pseudomonadaceae        Pseudomonas
##                  order               family              genus</code></pre>
<pre class="r"><code>plot(trimmed_all_positive_communities, gr_trimmed_all_positive, 
     layout = layout.fruchterman.reingold(gr_trimmed_all_positive),
     rescaled = TRUE,
     vertex.size = 2, 
     vertex.label = NA
)</code></pre>
<p><img src="bacteria_community_analysis_files/figure-html/tap.2-1.png" width="672" /></p>
<p>What’s interesting here is that the graph has a lot of “spokes,” which hints at important OTUs.</p>
<p>Modularity score:</p>
<pre class="r"><code>(tap.mod &lt;- modularity(gr_trimmed_all_positive, membership(trimmed_all_positive_communities)))</code></pre>
<pre><code>## [1] 0.3177584</code></pre>
</div>
<div id="negative-weights-3" class="section level3">
<h3>Negative Weights</h3>
<pre class="r"><code>trimmed_all_negative &lt;- trimmed_negative_weights[, -1]
trimmed_all_negative[[3]] &lt;- abs(trimmed_all_negative[[3]])
gr_trimmed_all_negative &lt;- graph.data.frame(trimmed_all_negative, directed = FALSE)
gr_trimmed_all_negative &lt;- simplify(gr_trimmed_all_negative, 
                                    edge.attr.comb = &quot;mean&quot;)
trimmed_all_negative_communities &lt;- cluster_fast_greedy(gr_trimmed_all_negative, 
                                    weights = E(gr_trimmed_all_negative)$rho)

hot_otus &lt;- vector()
for (community in communities(trimmed_all_negative_communities))
{
  sub_graph &lt;- induced.subgraph(graph = gr_trimmed_all_negative, 
                                    v = community, impl = &quot;auto&quot;)
  highest_degree_otu &lt;- V(sub_graph)[which.max(degree(sub_graph))]$name
  hot_otus &lt;- c(hot_otus, highest_degree_otu)
  print(paste(&quot;Highest degree OTU was&quot;, highest_degree_otu, &quot;(degree =&quot;,  
              degree(sub_graph, highest_degree_otu), &quot;):&quot;))
  print(taxa[OTU == highest_degree_otu])
        
  print(paste(&quot;Other OTUs in the same community as&quot;, highest_degree_otu, &quot;:&quot;))
  print(taxa[OTU %in% community])
}</code></pre>
<pre><code>## [1] &quot;Highest degree OTU was OTU_5 (degree = 9 ):&quot;
##      OTU   domain         phylum               class         order
## 1: OTU_5 Bacteria Proteobacteria Alphaproteobacteria Rickettsiales
##          family genus
## 1: mitochondria      
## [1] &quot;Other OTUs in the same community as OTU_5 :&quot;
##          OTU   domain         phylum               class             order
##  1: OTU_4337 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##  2:   OTU_44 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##  3: OTU_5778 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##  4: OTU_5776 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##  5: OTU_3492 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
##  6:    OTU_5 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
##  7: OTU_4191 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##  8: OTU_5806 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
##  9: OTU_4036 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
## 10: OTU_3986 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
## 11: OTU_5324 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
## 12: OTU_5834 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
## 13:   OTU_43 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 14: OTU_5701 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 15: OTU_4345 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##                 family         genus
##  1:      Moraxellaceae Acinetobacter
##  2:   Pseudomonadaceae   Pseudomonas
##  3:      Moraxellaceae Acinetobacter
##  4:      Moraxellaceae Acinetobacter
##  5: Enterobacteriaceae       Erwinia
##  6:       mitochondria              
##  7:      Moraxellaceae Acinetobacter
##  8: Enterobacteriaceae              
##  9:      Moraxellaceae Acinetobacter
## 10:      Moraxellaceae Acinetobacter
## 11:      Moraxellaceae Acinetobacter
## 12:      Moraxellaceae Acinetobacter
## 13:   Oxalobacteraceae   Cupriavidus
## 14:     Comamonadaceae              
## 15:      Moraxellaceae Acinetobacter
## [1] &quot;Highest degree OTU was OTU_6 (degree = 17 ):&quot;
##      OTU   domain         phylum               class           order
## 1: OTU_6 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##           family         genus
## 1: Moraxellaceae Acinetobacter
## [1] &quot;Other OTUs in the same community as OTU_6 :&quot;
##          OTU   domain         phylum               class
##  1: OTU_1035 Bacteria  Bacteroidetes    Sphingobacteriia
##  2: OTU_3950 Bacteria Proteobacteria  Betaproteobacteria
##  3:   OTU_45 Bacteria Proteobacteria Gammaproteobacteria
##  4:  OTU_446 Bacteria     Firmicutes          Clostridia
##  5:   OTU_16 Bacteria Proteobacteria  Betaproteobacteria
##  6: OTU_5629 Bacteria Proteobacteria Gammaproteobacteria
##  7: OTU_2168 Bacteria Proteobacteria Gammaproteobacteria
##  8:  OTU_336 Bacteria Proteobacteria Alphaproteobacteria
##  9: OTU_5247 Bacteria Proteobacteria Gammaproteobacteria
## 10:  OTU_233 Bacteria     Firmicutes             Bacilli
## 11: OTU_4938 Bacteria Proteobacteria Alphaproteobacteria
## 12: OTU_5854 Bacteria Proteobacteria  Betaproteobacteria
## 13: OTU_5398 Bacteria Proteobacteria Gammaproteobacteria
## 14:  OTU_225 Bacteria Proteobacteria Gammaproteobacteria
## 15: OTU_1076 Bacteria Actinobacteria      Actinobacteria
## 16:    OTU_9 Bacteria Proteobacteria Gammaproteobacteria
## 17:    OTU_6 Bacteria Proteobacteria Gammaproteobacteria
## 18:    OTU_7 Bacteria  Bacteroidetes      Flavobacteriia
##                  order              family            genus
##  1: Sphingobacteriales Sphingobacteriaceae Sphingobacterium
##  2:    Burkholderiales      Comamonadaceae      Methylibium
##  3:    Pseudomonadales       Moraxellaceae    Enhydrobacter
##  4:      Clostridiales  [Mogibacteriaceae]                 
##  5:    Burkholderiales      Comamonadaceae    Aquabacterium
##  6:  Enterobacteriales  Enterobacteriaceae                 
##  7:  Enterobacteriales  Enterobacteriaceae     Enterobacter
##  8:        Rhizobiales Methylobacteriaceae                 
##  9:  Enterobacteriales  Enterobacteriaceae                 
## 10:         Bacillales    Paenibacillaceae    Paenibacillus
## 11:      Rickettsiales        mitochondria                 
## 12:    Burkholderiales    Burkholderiaceae     Burkholderia
## 13:    Pseudomonadales    Pseudomonadaceae      Pseudomonas
## 14:    Pseudomonadales       Moraxellaceae    Acinetobacter
## 15:    Actinomycetales  Pseudonocardiaceae   Pseudonocardia
## 16:    Pseudomonadales    Pseudomonadaceae      Pseudomonas
## 17:    Pseudomonadales       Moraxellaceae    Acinetobacter
## 18:   Flavobacteriales     [Weeksellaceae]  Cloacibacterium
## [1] &quot;Highest degree OTU was OTU_21 (degree = 11 ):&quot;
##       OTU   domain         phylum               class           order
## 1: OTU_21 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##              family       genus
## 1: Pseudomonadaceae Pseudomonas
## [1] &quot;Other OTUs in the same community as OTU_21 :&quot;
##          OTU   domain         phylum               class           order
##  1:   OTU_21 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##  2:   OTU_22 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
##  3:   OTU_51 Bacteria Actinobacteria      Actinobacteria Actinomycetales
##  4: OTU_5302 Bacteria Proteobacteria Alphaproteobacteria   Rickettsiales
##  5:   OTU_18 Bacteria     Firmicutes             Bacilli Lactobacillales
##  6: OTU_5289 Bacteria Proteobacteria Alphaproteobacteria   Rickettsiales
##  7:  OTU_669 Bacteria  Bacteroidetes          Cytophagia    Cytophagales
##  8:  OTU_256 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
##  9:  OTU_172 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
## 10: OTU_4218 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
## 11:  OTU_510 Bacteria Proteobacteria  Betaproteobacteria   Rhodocyclales
## 12:   OTU_88 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
## 13:  OTU_131 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##                family             genus
##  1:  Pseudomonadaceae       Pseudomonas
##  2:    Comamonadaceae        Variovorax
##  3: Microbacteriaceae        Candidatus
##  4:      mitochondria                  
##  5:  Lactobacillaceae     Lactobacillus
##  6:      mitochondria                  
##  7:     Cytophagaceae    Flectobacillus
##  8:  Oxalobacteraceae Janthinobacterium
##  9:    Comamonadaceae        Rhodoferax
## 10:    Comamonadaceae        Rhodoferax
## 11:    Rhodocyclaceae     Dechloromonas
## 12:  Oxalobacteraceae                  
## 13:     Moraxellaceae                  
## [1] &quot;Highest degree OTU was OTU_8 (degree = 13 ):&quot;
##      OTU   domain         phylum               class            order
## 1: OTU_8 Bacteria Proteobacteria Alphaproteobacteria Rhodospirillales
##              family         genus
## 1: Acetobacteraceae Gluconobacter
## [1] &quot;Other OTUs in the same community as OTU_8 :&quot;
##          OTU   domain         phylum               class             order
##  1: OTU_3478 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
##  2: OTU_4627 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##  3: OTU_4387 Bacteria     Firmicutes             Bacilli        Bacillales
##  4: OTU_5867 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
##  5: OTU_4222 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
##  6: OTU_4227 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
##  7:   OTU_92 Bacteria Proteobacteria Alphaproteobacteria  Sphingomonadales
##  8: OTU_5553 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
##  9:  OTU_397 Bacteria Proteobacteria Alphaproteobacteria   Rhodobacterales
## 10:    OTU_8 Bacteria Proteobacteria Alphaproteobacteria  Rhodospirillales
## 11:    OTU_3 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 12: OTU_1759 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
## 13: OTU_1934 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
## 14: OTU_5257 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##                 family          genus
##  1:       mitochondria               
##  2:     Comamonadaceae Hydrogenophaga
##  3:        Bacillaceae  Anoxybacillus
##  4: Enterobacteriaceae               
##  5:       mitochondria               
##  6:       mitochondria               
##  7:  Sphingomonadaceae   Sphingomonas
##  8:       mitochondria               
##  9:   Rhodobacteraceae     Paracoccus
## 10:   Acetobacteraceae  Gluconobacter
## 11: Enterobacteriaceae        Erwinia
## 12:       mitochondria               
## 13:       mitochondria               
## 14:     Comamonadaceae      Pelomonas
## [1] &quot;Highest degree OTU was OTU_20 (degree = 3 ):&quot;
##       OTU   domain         phylum               class           order
## 1: OTU_20 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##           family         genus
## 1: Moraxellaceae Acinetobacter
## [1] &quot;Other OTUs in the same community as OTU_20 :&quot;
##         OTU   domain         phylum               class            order
## 1:   OTU_20 Bacteria Proteobacteria Gammaproteobacteria  Pseudomonadales
## 2: OTU_5192 Bacteria Proteobacteria  Betaproteobacteria  Burkholderiales
## 3:   OTU_28 Bacteria  Bacteroidetes      Flavobacteriia Flavobacteriales
## 4: OTU_4161 Bacteria Proteobacteria Alphaproteobacteria    Rickettsiales
##             family            genus
## 1:   Moraxellaceae    Acinetobacter
## 2:  Comamonadaceae        Pelomonas
## 3: [Weeksellaceae] Chryseobacterium
## 4:    mitochondria</code></pre>
<pre class="r"><code>plot(trimmed_all_negative_communities, gr_trimmed_all_negative, 
     layout = layout.fruchterman.reingold(gr_trimmed_all_negative),
     rescaled = TRUE,
     vertex.size = 2, 
     vertex.label = NA
)</code></pre>
<p><img src="bacteria_community_analysis_files/figure-html/tan.1-1.png" width="672" /></p>
<p>Modularity score:</p>
<pre class="r"><code>(tan.mod &lt;- modularity(gr_trimmed_all_negative, membership(trimmed_all_negative_communities)))</code></pre>
<pre><code>## [1] 0.4991163</code></pre>
</div>
</div>
</div>
<div id="complete-data" class="section level1">
<h1>Complete Data</h1>
<p>We reproduce the above analysis on the complete data sat. Again, we separate the data into positive and negative networks:</p>
<pre class="r"><code>complete_positive_weights &lt;- complete_data[complete_data[[&#39;rho&#39;]] &gt; 0]
head(complete_positive_weights)</code></pre>
<pre><code>##    treatment OTU_1    OTU_2      rho
## 1:    Bagged OTU_1 OTU_1000 0.271310
## 2:    Bagged OTU_1 OTU_1004 0.260951
## 3:    Bagged OTU_1 OTU_1028 0.493684
## 4:    Bagged OTU_1  OTU_105 0.404794
## 5:    Bagged OTU_1 OTU_1054 0.567432
## 6:    Bagged OTU_1 OTU_1071 0.390386</code></pre>
<pre class="r"><code>complete_negative_weights &lt;- complete_data[complete_data[[&#39;rho&#39;]] &lt; 0]
head(complete_negative_weights)</code></pre>
<pre><code>##    treatment    OTU_1    OTU_2       rho
## 1:    Bagged  OTU_131   OTU_21 -0.287139
## 2:    Bagged  OTU_131    OTU_5 -0.302685
## 3:    Bagged  OTU_131 OTU_5806 -0.274100
## 4:    Bagged   OTU_21   OTU_51 -0.255057
## 5:    Bagged   OTU_21  OTU_510 -0.311637
## 6:    Bagged OTU_2168 OTU_3913 -0.265874</code></pre>
<div id="exposed-communities-1" class="section level2">
<h2>Exposed Communities</h2>
<div id="positive-weights-4" class="section level3">
<h3>Positive Weights</h3>
<pre class="r"><code>complete_exposed_positive &lt;- complete_positive_weights[treatment == &quot;Exposed&quot;]
complete_exposed_positive &lt;- complete_exposed_positive[, -1]
gr_complete_exposed_positive &lt;- graph.data.frame(complete_exposed_positive, directed = FALSE)
complete_exposed_positive_communities &lt;- cluster_fast_greedy(gr_complete_exposed_positive, 
                                                           weights = E(gr_complete_exposed_positive)$rho)

hot_otus &lt;- vector()
for (community in communities(complete_exposed_positive_communities))
{
  sub_graph &lt;- induced.subgraph(graph = gr_complete_exposed_positive, 
                                    v = community, impl = &quot;auto&quot;)
  highest_degree_otu &lt;- V(sub_graph)[which.max(degree(sub_graph))]$name
  hot_otus &lt;- c(hot_otus, highest_degree_otu)
  print(paste(&quot;Highest degree OTU was&quot;, highest_degree_otu, &quot;(degree =&quot;,  
              degree(sub_graph, highest_degree_otu), &quot;):&quot;))
  print(taxa[OTU == highest_degree_otu])
        
  print(paste(&quot;Other OTUs in the same community as&quot;, highest_degree_otu, &quot;:&quot;))
  print(taxa[OTU %in% community])
}</code></pre>
<pre><code>## [1] &quot;Highest degree OTU was OTU_2701 (degree = 49 ):&quot;
##         OTU   domain         phylum               class           order
## 1: OTU_2701 Bacteria Proteobacteria Alphaproteobacteria Caulobacterales
##              family            genus
## 1: Caulobacteraceae Phenylobacterium
## [1] &quot;Other OTUs in the same community as OTU_2701 :&quot;
##          OTU   domain          phylum               class
##  1: OTU_3304 Bacteria  Proteobacteria  Betaproteobacteria
##  2: OTU_5491 Bacteria      Firmicutes             Bacilli
##  3: OTU_4273 Bacteria  Proteobacteria  Betaproteobacteria
##  4:  OTU_632 Bacteria      Firmicutes          Clostridia
##  5: OTU_3143 Bacteria  Proteobacteria Alphaproteobacteria
##  6:  OTU_990 Bacteria   Bacteroidetes    Sphingobacteriia
##  7: OTU_4802 Bacteria  Proteobacteria  Betaproteobacteria
##  8:  OTU_298 Bacteria Verrucomicrobia    [Spartobacteria]
##  9: OTU_3910 Bacteria   Bacteroidetes      Flavobacteriia
## 10: OTU_2435 Bacteria  Proteobacteria Alphaproteobacteria
## 11:  OTU_281 Bacteria  Proteobacteria Alphaproteobacteria
## 12: OTU_1245 Bacteria      Firmicutes             Bacilli
## 13: OTU_2660 Bacteria   Acidobacteria     Acidobacteria-6
## 14: OTU_1400 Bacteria      Firmicutes          Clostridia
## 15:  OTU_646 Bacteria  Proteobacteria Alphaproteobacteria
## 16: OTU_2701 Bacteria  Proteobacteria Alphaproteobacteria
## 17: OTU_3346 Bacteria      Firmicutes             Bacilli
## 18:  OTU_160 Bacteria  Proteobacteria Gammaproteobacteria
## 19:  OTU_786 Bacteria  Proteobacteria  Betaproteobacteria
## 20: OTU_2575 Bacteria            GN02               BD1-5
## 21:  OTU_149 Bacteria  Actinobacteria      Actinobacteria
## 22:  OTU_329 Bacteria  Proteobacteria Alphaproteobacteria
## 23:  OTU_550 Bacteria  Proteobacteria Alphaproteobacteria
## 24:  OTU_558 Bacteria  Proteobacteria Alphaproteobacteria
## 25:  OTU_157 Bacteria  Actinobacteria      Actinobacteria
## 26:  OTU_524 Bacteria  Actinobacteria      Actinobacteria
## 27: OTU_1554 Bacteria  Proteobacteria Alphaproteobacteria
## 28:  OTU_411 Bacteria   Bacteroidetes    Sphingobacteriia
## 29: OTU_5373 Bacteria  Proteobacteria Alphaproteobacteria
## 30:  OTU_506 Bacteria  Proteobacteria Gammaproteobacteria
## 31: OTU_3664 Bacteria  Proteobacteria Gammaproteobacteria
## 32: OTU_1753 Bacteria  Proteobacteria  Betaproteobacteria
## 33: OTU_1365 Bacteria  Proteobacteria  Betaproteobacteria
## 34: OTU_2504 Bacteria  Proteobacteria Alphaproteobacteria
## 35: OTU_1532 Bacteria  Proteobacteria Alphaproteobacteria
## 36:  OTU_705 Bacteria  Proteobacteria Alphaproteobacteria
## 37:  OTU_928 Bacteria  Proteobacteria Alphaproteobacteria
## 38:  OTU_711 Bacteria   Bacteroidetes      Flavobacteriia
## 39: OTU_4935 Bacteria  Proteobacteria  Betaproteobacteria
## 40:   OTU_85 Bacteria   Bacteroidetes          Cytophagia
## 41:  OTU_906 Bacteria  Actinobacteria      Actinobacteria
## 42:  OTU_836 Bacteria  Proteobacteria Alphaproteobacteria
## 43: OTU_2734 Bacteria Armatimonadetes    [Fimbriimonadia]
## 44: OTU_3282 Bacteria  Proteobacteria  Betaproteobacteria
## 45: OTU_4883 Bacteria   Acidobacteria     Acidobacteria-6
## 46: OTU_4082 Bacteria  Actinobacteria      Actinobacteria
## 47:  OTU_969 Bacteria  Proteobacteria Alphaproteobacteria
## 48:  OTU_968 Bacteria  Proteobacteria Gammaproteobacteria
## 49: OTU_1071 Bacteria  Proteobacteria Alphaproteobacteria
## 50:  OTU_972 Bacteria             OD1                 ZB2
## 51:   OTU_93 Bacteria  Proteobacteria Gammaproteobacteria
## 52:   OTU_96 Bacteria  Proteobacteria Alphaproteobacteria
## 53: OTU_3371 Bacteria  Proteobacteria Alphaproteobacteria
## 54:  OTU_944 Bacteria  Proteobacteria Alphaproteobacteria
##          OTU   domain          phylum               class
##                    order                family            genus
##  1:      Burkholderiales      Oxalobacteraceae                 
##  2:           Bacillales           Bacillaceae         Bacillus
##  3:      Burkholderiales        Comamonadaceae       Rhodoferax
##  4:        Clostridiales        Clostridiaceae                 
##  5:     Rhodospirillales     Rhodospirillaceae                 
##  6:   Sphingobacteriales   Sphingobacteriaceae                 
##  7:      Burkholderiales      Oxalobacteraceae                 
##  8: [Chthoniobacterales] [Chthoniobacteraceae]                 
##  9:     Flavobacteriales       [Weeksellaceae] Chryseobacterium
## 10:          Rhizobiales   Methylobacteriaceae                 
## 11:     Sphingomonadales     Sphingomonadaceae     Sphingomonas
## 12:      Lactobacillales         Aerococcaceae     Alloiococcus
## 13:              iii1-15                                       
## 14:        Clostridiales       Ruminococcaceae                 
## 15:          Rhizobiales                                       
## 16:      Caulobacterales      Caulobacteraceae Phenylobacterium
## 17:      Lactobacillales     Carnobacteriaceae                 
## 18:        Legionellales          Coxiellaceae    Rickettsiella
## 19:      Burkholderiales        Comamonadaceae                 
## 20:                                                            
## 21:      Actinomycetales                                       
## 22:      Caulobacterales      Caulobacteraceae                 
## 23:          Rhizobiales   Methylobacteriaceae Methylobacterium
## 24:     Rhodospirillales     Rhodospirillaceae      Skermanella
## 25:      Actinomycetales        Micrococcaceae      Micrococcus
## 26:      Actinomycetales     Cellulomonadaceae     Cellulomonas
## 27:      Rhodobacterales      Rhodobacteraceae      Rhodobacter
## 28:   Sphingobacteriales   Sphingobacteriaceae                 
## 29:      Rhodobacterales      Rhodobacteraceae      Rhodobacter
## 30:        Legionellales                                       
## 31:        Aeromonadales        Aeromonadaceae        Tolumonas
## 32:     Procabacteriales     Procabacteriaceae                 
## 33:      Burkholderiales        Comamonadaceae                 
## 34:     Sphingomonadales     Sphingomonadaceae     Kaistobacter
## 35:          Rhizobiales     Hyphomicrobiaceae      Rhodoplanes
## 36:          Rhizobiales     Bradyrhizobiaceae      Balneimonas
## 37:          Rhizobiales     Hyphomicrobiaceae   Hyphomicrobium
## 38:     Flavobacteriales       [Weeksellaceae]  Elizabethkingia
## 39:      Burkholderiales      Oxalobacteraceae                 
## 40:         Cytophagales         Cytophagaceae     Hymenobacter
## 41:      Actinomycetales     Microbacteriaceae                 
## 42:     Sphingomonadales    Erythrobacteraceae                 
## 43:   [Fimbriimonadales]   [Fimbriimonadaceae]                 
## 44:      Burkholderiales        Comamonadaceae        Comamonas
## 45:              iii1-15                                       
## 46:      Actinomycetales     Cellulomonadaceae     Cellulomonas
## 47:     Sphingomonadales     Sphingomonadaceae     Kaistobacter
## 48:      Xanthomonadales      Xanthomonadaceae                 
## 49:        Rickettsiales          mitochondria                 
## 50:                                                            
## 51:        Legionellales        Legionellaceae       Legionella
## 52:     Sphingomonadales     Sphingomonadaceae     Kaistobacter
## 53:          Rhizobiales     Hyphomicrobiaceae   Hyphomicrobium
## 54:          Rhizobiales     Hyphomicrobiaceae    Pedomicrobium
##                    order                family            genus
## [1] &quot;Highest degree OTU was OTU_5972 (degree = 23 ):&quot;
##         OTU   domain         phylum              class           order
## 1: OTU_5972 Bacteria Proteobacteria Betaproteobacteria Burkholderiales
##            family         genus
## 1: Comamonadaceae Limnohabitans
## [1] &quot;Other OTUs in the same community as OTU_5972 :&quot;
##          OTU   domain          phylum                 class
##  1:  OTU_435 Bacteria  Actinobacteria        Actinobacteria
##  2:   OTU_65 Bacteria  Proteobacteria   Alphaproteobacteria
##  3:  OTU_841 Bacteria  Proteobacteria   Gammaproteobacteria
##  4:  OTU_743 Bacteria   Bacteroidetes         [Saprospirae]
##  5:  OTU_479 Bacteria  Proteobacteria   Alphaproteobacteria
##  6:  OTU_872 Bacteria  Actinobacteria        Actinobacteria
##  7: OTU_3477 Bacteria  Actinobacteria        Actinobacteria
##  8:  OTU_868 Bacteria      Firmicutes               Bacilli
##  9:   OTU_69 Bacteria  Proteobacteria   Gammaproteobacteria
## 10: OTU_1422 Bacteria  Proteobacteria   Alphaproteobacteria
## 11:  OTU_819 Bacteria             OP3                koll11
## 12: OTU_3112 Bacteria             OP3                koll11
## 13:  OTU_486 Bacteria   Bacteroidetes            Cytophagia
## 14: OTU_4633 Bacteria  Proteobacteria   Gammaproteobacteria
## 15: OTU_4624 Bacteria  Proteobacteria    Betaproteobacteria
## 16: OTU_2653 Bacteria  Proteobacteria   Deltaproteobacteria
## 17: OTU_4161 Bacteria  Proteobacteria   Alphaproteobacteria
## 18:  OTU_751 Bacteria   Bacteroidetes      Sphingobacteriia
## 19: OTU_3608 Bacteria  Proteobacteria    Betaproteobacteria
## 20:  OTU_596 Bacteria   Bacteroidetes      Sphingobacteriia
## 21: OTU_3445 Bacteria  Proteobacteria   Gammaproteobacteria
## 22: OTU_3447 Bacteria  Proteobacteria    Betaproteobacteria
## 23: OTU_5108 Bacteria  Proteobacteria    Betaproteobacteria
## 24:  OTU_148 Bacteria Verrucomicrobia        [Pedosphaerae]
## 25:  OTU_327 Bacteria             OD1                   ZB2
## 26: OTU_1379 Bacteria  Proteobacteria Epsilonproteobacteria
## 27:  OTU_193 Bacteria  Actinobacteria       Thermoleophilia
## 28:  OTU_393 Bacteria      Firmicutes            Clostridia
## 29:  OTU_820 Bacteria Verrucomicrobia              Opitutae
## 30: OTU_5972 Bacteria  Proteobacteria    Betaproteobacteria
## 31:  OTU_404 Bacteria             TM6                 SJA-4
## 32: OTU_4482 Bacteria  Proteobacteria    Betaproteobacteria
## 33: OTU_5775 Bacteria  Proteobacteria   Gammaproteobacteria
## 34: OTU_3375 Bacteria  Proteobacteria   Alphaproteobacteria
## 35: OTU_3967 Bacteria  Actinobacteria        Actinobacteria
## 36: OTU_4516 Bacteria  Proteobacteria    Betaproteobacteria
##          OTU   domain          phylum                 class
##                   order             family         genus
##  1:     Actinomycetales     Micrococcaceae       Kocuria
##  2:    Sphingomonadales  Sphingomonadaceae  Sphingomonas
##  3:                                                     
##  4:     [Saprospirales]   Chitinophagaceae              
##  5:     Rhodobacterales   Rhodobacteraceae    Paracoccus
##  6:     Actinomycetales    Nocardioidaceae              
##  7:     Actinomycetales  Microbacteriaceae              
##  8:          Bacillales        Bacillaceae      Bacillus
##  9:     Alteromonadales   Alteromonadaceae    Cellvibrio
## 10:       Rickettsiales                                 
## 11:                                                     
## 12:                                                     
## 13:        Cytophagales      Cytophagaceae     Emticicia
## 14:     Pseudomonadales      Moraxellaceae Acinetobacter
## 15:     Burkholderiales     Comamonadaceae   Curvibacter
## 16:               MIZ46                                 
## 17:       Rickettsiales       mitochondria              
## 18:  Sphingobacteriales                                 
## 19:     Burkholderiales     Comamonadaceae    Acidovorax
## 20:  Sphingobacteriales                                 
## 21:   Enterobacteriales Enterobacteriaceae              
## 22:     Burkholderiales     Comamonadaceae              
## 23:     Burkholderiales     Comamonadaceae Limnohabitans
## 24:    [Pedosphaerales]          auto67_4W              
## 25:                                                     
## 26:   Campylobacterales  Helicobacteraceae Sulfuricurvum
## 27: Solirubrobacterales  Patulibacteraceae              
## 28:       Clostridiales     Clostridiaceae   Clostridium
## 29:    [Cerasicoccales]  [Cerasicoccaceae]              
## 30:     Burkholderiales     Comamonadaceae Limnohabitans
## 31:                                                     
## 32:     Burkholderiales     Comamonadaceae Limnohabitans
## 33:   Enterobacteriales Enterobacteriaceae    Klebsiella
## 34:         Rhizobiales  Hyphomicrobiaceae       Devosia
## 35:     Actinomycetales  Sanguibacteraceae  Sanguibacter
## 36:     Burkholderiales     Comamonadaceae Limnohabitans
##                   order             family         genus
## [1] &quot;Highest degree OTU was OTU_2676 (degree = 20 ):&quot;
##         OTU   domain         phylum              class           order
## 1: OTU_2676 Bacteria Proteobacteria Betaproteobacteria Burkholderiales
##            family genus
## 1: Comamonadaceae      
## [1] &quot;Other OTUs in the same community as OTU_2676 :&quot;
##          OTU   domain          phylum                 class
##  1: OTU_3781 Bacteria   Bacteroidetes            Cytophagia
##  2:   OTU_60 Bacteria   Bacteroidetes        Flavobacteriia
##  3: OTU_3434 Bacteria  Proteobacteria Epsilonproteobacteria
##  4:  OTU_428 Bacteria Verrucomicrobia      [Spartobacteria]
##  5: OTU_3158 Bacteria  Proteobacteria    Betaproteobacteria
##  6:  OTU_181 Bacteria  Planctomycetes        Planctomycetia
##  7:  OTU_638 Bacteria  Actinobacteria        Actinobacteria
##  8: OTU_3148 Bacteria  Actinobacteria        Actinobacteria
##  9: OTU_3691 Bacteria  Proteobacteria    Betaproteobacteria
## 10: OTU_5302 Bacteria  Proteobacteria   Alphaproteobacteria
## 11:  OTU_964 Bacteria  Proteobacteria   Deltaproteobacteria
## 12: OTU_2676 Bacteria  Proteobacteria    Betaproteobacteria
## 13:  OTU_803 Bacteria  Proteobacteria   Gammaproteobacteria
## 14: OTU_1240 Bacteria   Cyanobacteria                4C0d-2
## 15:  OTU_353 Bacteria  Proteobacteria   Gammaproteobacteria
## 16:  OTU_376       No           blast                   hit
## 17:  OTU_375 Bacteria    Spirochaetes          Spirochaetes
## 18:  OTU_798 Bacteria  Proteobacteria    Betaproteobacteria
## 19:  OTU_146 Bacteria             OP3                koll11
## 20: OTU_5791 Bacteria   Bacteroidetes      Sphingobacteriia
## 21:  OTU_525 Bacteria             OD1                SM2F11
## 22:  OTU_536 Bacteria             OP3                koll11
## 23: OTU_1743 Bacteria  Proteobacteria    Betaproteobacteria
## 24:  OTU_392 Bacteria  Proteobacteria    Betaproteobacteria
## 25: OTU_1890 Bacteria             OD1                   ZB2
## 26: OTU_2275 Bacteria  Proteobacteria   Deltaproteobacteria
## 27:  OTU_730 Bacteria     Tenericutes            Mollicutes
## 28: OTU_2870 Bacteria  Proteobacteria    Betaproteobacteria
## 29: OTU_3350 Bacteria  Proteobacteria   Alphaproteobacteria
## 30:    OTU_9 Bacteria  Proteobacteria   Gammaproteobacteria
## 31: OTU_5812 Bacteria  Proteobacteria    Betaproteobacteria
## 32: OTU_5763 Bacteria  Proteobacteria   Alphaproteobacteria
## 33: OTU_2245       No           blast                   hit
## 34: OTU_2025 Bacteria  Proteobacteria   Gammaproteobacteria
## 35:  OTU_766 Bacteria             OD1                      
## 36:   OTU_91 Bacteria  Proteobacteria   Alphaproteobacteria
## 37:  OTU_778 Bacteria  Proteobacteria   Deltaproteobacteria
## 38:  OTU_770 Bacteria  Proteobacteria                  TA18
## 39: OTU_1961 Bacteria   Bacteroidetes      Sphingobacteriia
##          OTU   domain          phylum                 class
##                    order                family          genus
##  1:         Cytophagales         Cytophagaceae Flectobacillus
##  2:     Flavobacteriales     Flavobacteriaceae Flavobacterium
##  3:    Campylobacterales    Campylobacteraceae     Arcobacter
##  4: [Chthoniobacterales] [Chthoniobacteraceae]               
##  5:      Burkholderiales      Oxalobacteraceae Herbaspirillum
##  6:     Planctomycetales     Planctomycetaceae   Planctomyces
##  7:      Actinomycetales                ACK-M1               
##  8:      Actinomycetales   Geodermatophilaceae   Blastococcus
##  9:      Burkholderiales        Comamonadaceae      Comamonas
## 10:        Rickettsiales          mitochondria               
## 11:         Myxococcales                                     
## 12:      Burkholderiales        Comamonadaceae               
## 13:      Alteromonadales      Alteromonadaceae     Cellvibrio
## 14:              MLE1-12                                     
## 15:      Pseudomonadales         Moraxellaceae  Perlucidibaca
## 16:                                                          
## 17:       Spirochaetales       Spirochaetaceae    Spirochaeta
## 18:      Burkholderiales        Comamonadaceae      Comamonas
## 19:                                                          
## 20:   Sphingobacteriales                                     
## 21:                                                          
## 22:                                                          
## 23:      Burkholderiales      Burkholderiaceae   Burkholderia
## 24:     Procabacteriales     Procabacteriaceae               
## 25:                                                          
## 26:    Bdellovibrionales    Bdellovibrionaceae   Bdellovibrio
## 27:    Acholeplasmatales    Acholeplasmataceae     Candidatus
## 28:      Burkholderiales        Comamonadaceae  Limnohabitans
## 29:     Rhodospirillales      Acetobacteraceae               
## 30:      Pseudomonadales      Pseudomonadaceae    Pseudomonas
## 31:      Burkholderiales        Comamonadaceae     Rhodoferax
## 32:                                                          
## 33:                                                          
## 34:        Legionellales          Coxiellaceae               
## 35:                                                          
## 36:      Caulobacterales      Caulobacteraceae    Caulobacter
## 37:         Myxococcales                                     
## 38:            PHOS-HD29                                     
## 39:   Sphingobacteriales                                     
##                    order                family          genus
## [1] &quot;Highest degree OTU was OTU_4570 (degree = 50 ):&quot;
##         OTU   domain         phylum               class           order
## 1: OTU_4570 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##           family         genus
## 1: Moraxellaceae Acinetobacter
## [1] &quot;Other OTUs in the same community as OTU_4570 :&quot;
##          OTU   domain         phylum                 class
##  1: OTU_4337 Bacteria Proteobacteria   Gammaproteobacteria
##  2: OTU_3426 Bacteria Proteobacteria    Betaproteobacteria
##  3:  OTU_895 Bacteria  Acidobacteria       Acidobacteria-6
##  4: OTU_3884 Bacteria Proteobacteria    Betaproteobacteria
##  5: OTU_3883 Bacteria Proteobacteria    Betaproteobacteria
##  6:  OTU_421 Bacteria  Cyanobacteria Oscillatoriophycideae
##  7: OTU_1490 Bacteria  Bacteroidetes            Cytophagia
##  8: OTU_1005 Bacteria Proteobacteria   Gammaproteobacteria
##  9: OTU_5682 Bacteria Proteobacteria   Gammaproteobacteria
## 10: OTU_1169 Bacteria Proteobacteria   Deltaproteobacteria
## 11: OTU_5213 Bacteria Proteobacteria   Gammaproteobacteria
## 12: OTU_2401 Bacteria Actinobacteria        Coriobacteriia
## 13:   OTU_29 Bacteria Proteobacteria    Betaproteobacteria
## 14:   OTU_28 Bacteria  Bacteroidetes        Flavobacteriia
## 15:  OTU_460 Bacteria Proteobacteria   Gammaproteobacteria
## 16:  OTU_464 Bacteria Proteobacteria   Deltaproteobacteria
## 17: OTU_3906 Bacteria Proteobacteria   Gammaproteobacteria
## 18: OTU_3302 Bacteria Proteobacteria    Betaproteobacteria
## 19:   OTU_14 Bacteria Proteobacteria    Betaproteobacteria
## 20: OTU_3115 Bacteria Proteobacteria   Gammaproteobacteria
## 21: OTU_5778 Bacteria Proteobacteria   Gammaproteobacteria
## 22: OTU_5776 Bacteria Proteobacteria   Gammaproteobacteria
## 23: OTU_2673 Bacteria Proteobacteria   Alphaproteobacteria
## 24: OTU_1438 Bacteria Proteobacteria    Betaproteobacteria
## 25: OTU_1654 Bacteria  Bacteroidetes           Bacteroidia
## 26:  OTU_585 Bacteria Proteobacteria   Alphaproteobacteria
## 27:  OTU_580 Bacteria Proteobacteria   Gammaproteobacteria
## 28: OTU_1616 Bacteria       [Thermi]            Deinococci
## 29: OTU_5166 Bacteria Proteobacteria   Gammaproteobacteria
## 30: OTU_3440 Bacteria Proteobacteria    Betaproteobacteria
## 31: OTU_4400 Bacteria Proteobacteria    Betaproteobacteria
## 32: OTU_1627 Bacteria Proteobacteria   Alphaproteobacteria
## 33: OTU_4191 Bacteria Proteobacteria   Gammaproteobacteria
## 34: OTU_4004 Bacteria  Bacteroidetes         [Saprospirae]
## 35: OTU_4036 Bacteria Proteobacteria   Gammaproteobacteria
## 36: OTU_3986 Bacteria Proteobacteria   Gammaproteobacteria
## 37: OTU_5324 Bacteria Proteobacteria   Gammaproteobacteria
## 38: OTU_5819 Bacteria Proteobacteria    Betaproteobacteria
## 39: OTU_5834 Bacteria Proteobacteria   Gammaproteobacteria
## 40: OTU_2350 Bacteria     Firmicutes               Bacilli
## 41: OTU_1802 Bacteria    Nitrospirae            Nitrospira
## 42: OTU_3232 Bacteria Proteobacteria   Gammaproteobacteria
## 43:  OTU_401 Bacteria Proteobacteria   Deltaproteobacteria
## 44:  OTU_402 Bacteria Proteobacteria    Betaproteobacteria
## 45: OTU_3204 Bacteria Proteobacteria   Gammaproteobacteria
## 46: OTU_5845 Bacteria Proteobacteria   Gammaproteobacteria
## 47: OTU_5667 Bacteria Proteobacteria    Betaproteobacteria
## 48:  OTU_532 Bacteria  Bacteroidetes         [Saprospirae]
## 49: OTU_5852 Bacteria Proteobacteria   Gammaproteobacteria
## 50:  OTU_278 Bacteria Proteobacteria   Deltaproteobacteria
## 51: OTU_4278 Bacteria  Bacteroidetes            Cytophagia
## 52: OTU_1699 Bacteria  Acidobacteria       Acidobacteria-6
## 53: OTU_4059 Bacteria Proteobacteria   Gammaproteobacteria
## 54:  OTU_127 Bacteria Proteobacteria   Alphaproteobacteria
## 55: OTU_4597 Bacteria Proteobacteria   Gammaproteobacteria
## 56: OTU_5931 Bacteria Proteobacteria   Gammaproteobacteria
## 57: OTU_2298 Bacteria  Bacteroidetes      Sphingobacteriia
## 58:  OTU_343 Bacteria Proteobacteria   Alphaproteobacteria
## 59: OTU_4701 Bacteria Proteobacteria   Gammaproteobacteria
## 60: OTU_4796 Bacteria Proteobacteria   Gammaproteobacteria
## 61: OTU_1085 Bacteria     Firmicutes               Bacilli
## 62:   OTU_81 Bacteria     Firmicutes               Bacilli
## 63: OTU_3823 Bacteria Proteobacteria   Gammaproteobacteria
## 64: OTU_1091 Bacteria            OD1                   ZB2
## 65:  OTU_837 Bacteria Proteobacteria   Gammaproteobacteria
## 66: OTU_4895 Bacteria Proteobacteria    Betaproteobacteria
## 67: OTU_4887 Bacteria Proteobacteria   Gammaproteobacteria
## 68: OTU_1116 Bacteria Proteobacteria   Alphaproteobacteria
## 69:    OTU_8 Bacteria Proteobacteria   Alphaproteobacteria
## 70:    OTU_6 Bacteria Proteobacteria   Gammaproteobacteria
## 71:   OTU_27 Bacteria     Firmicutes               Bacilli
## 72: OTU_4345 Bacteria Proteobacteria   Gammaproteobacteria
## 73: OTU_4570 Bacteria Proteobacteria   Gammaproteobacteria
## 74: OTU_5029 Bacteria Proteobacteria    Betaproteobacteria
## 75: OTU_2595 Bacteria Proteobacteria   Gammaproteobacteria
##          OTU   domain         phylum                 class
##                  order             family             genus
##  1:    Pseudomonadales      Moraxellaceae     Acinetobacter
##  2:    Burkholderiales     Comamonadaceae                  
##  3:            iii1-15                                     
##  4:    Burkholderiales     Comamonadaceae                  
##  5:    Burkholderiales     Comamonadaceae         Comamonas
##  6:      Chroococcales      Xenococcaceae Chroococcidiopsis
##  7:       Cytophagales      Cytophagaceae         Cytophaga
##  8:      Aeromonadales     Aeromonadaceae                  
##  9:    Pseudomonadales      Moraxellaceae     Acinetobacter
## 10:  Bdellovibrionales Bacteriovoracaceae                  
## 11:    Pseudomonadales      Moraxellaceae     Acinetobacter
## 12:   Coriobacteriales  Coriobacteriaceae       Collinsella
## 13:       Neisseriales      Neisseriaceae                  
## 14:   Flavobacteriales    [Weeksellaceae]  Chryseobacterium
## 15:    Xanthomonadales   Xanthomonadaceae        Luteimonas
## 16:  Bdellovibrionales Bdellovibrionaceae      Bdellovibrio
## 17:    Pseudomonadales      Moraxellaceae     Acinetobacter
## 18:      Rhodocyclales     Rhodocyclaceae    Propionivibrio
## 19:    Burkholderiales     Comamonadaceae                  
## 20:    Pseudomonadales      Moraxellaceae     Acinetobacter
## 21:    Pseudomonadales      Moraxellaceae     Acinetobacter
## 22:    Pseudomonadales      Moraxellaceae     Acinetobacter
## 23:   Sphingomonadales  Sphingomonadaceae                  
## 24:    Burkholderiales   Oxalobacteraceae       Cupriavidus
## 25:      Bacteroidales                                     
## 26:      Rickettsiales     Rickettsiaceae                  
## 27:  Enterobacteriales Enterobacteriaceae          Serratia
## 28:      Deinococcales     Deinococcaceae       Deinococcus
## 29:  Enterobacteriales Enterobacteriaceae           Erwinia
## 30:    Burkholderiales     Comamonadaceae        Rhodoferax
## 31:    Burkholderiales     Comamonadaceae     Limnohabitans
## 32:    Caulobacterales   Caulobacteraceae     Asticcacaulis
## 33:    Pseudomonadales      Moraxellaceae     Acinetobacter
## 34:    [Saprospirales]   Chitinophagaceae Sediminibacterium
## 35:    Pseudomonadales      Moraxellaceae     Acinetobacter
## 36:    Pseudomonadales      Moraxellaceae     Acinetobacter
## 37:    Pseudomonadales      Moraxellaceae     Acinetobacter
## 38:    Burkholderiales   Oxalobacteraceae Janthinobacterium
## 39:    Pseudomonadales      Moraxellaceae     Acinetobacter
## 40:    Lactobacillales  Carnobacteriaceae    Granulicatella
## 41:      Nitrospirales     Nitrospiraceae        Nitrospira
## 42:  Enterobacteriales Enterobacteriaceae                  
## 43:  Bdellovibrionales Bdellovibrionaceae      Bdellovibrio
## 44:       Neisseriales      Neisseriaceae         Neisseria
## 45:    Xanthomonadales   Xanthomonadaceae                  
## 46:    Pseudomonadales      Moraxellaceae     Acinetobacter
## 47:    Burkholderiales     Comamonadaceae                  
## 48:    [Saprospirales]   Chitinophagaceae Sediminibacterium
## 49:    Pseudomonadales      Moraxellaceae     Acinetobacter
## 50:       Myxococcales      Haliangiaceae                  
## 51:       Cytophagales      Cytophagaceae                  
## 52:            iii1-15             mb2424                  
## 53:    Pseudomonadales   Pseudomonadaceae       Pseudomonas
## 54:        Rhizobiales                                     
## 55:    Pseudomonadales      Moraxellaceae     Acinetobacter
## 56:    Pseudomonadales      Moraxellaceae     Acinetobacter
## 57: Sphingobacteriales                                     
## 58:      Rickettsiales       mitochondria                  
## 59:    Alteromonadales   Alteromonadaceae                  
## 60:    Pseudomonadales      Moraxellaceae     Acinetobacter
## 61:         Bacillales        Bacillaceae          Bacillus
## 62:         Gemellales        Gemellaceae           Gemella
## 63:    Pseudomonadales      Moraxellaceae     Acinetobacter
## 64:                                                        
## 65:  Oceanospirillales     Halomonadaceae         Halomonas
## 66:    Burkholderiales     Comamonadaceae        Acidovorax
## 67:    Pseudomonadales      Moraxellaceae     Acinetobacter
## 68:    Rhodobacterales   Rhodobacteraceae  Rubellimicrobium
## 69:   Rhodospirillales   Acetobacteraceae     Gluconobacter
## 70:    Pseudomonadales      Moraxellaceae     Acinetobacter
## 71:    Lactobacillales   Streptococcaceae     Streptococcus
## 72:    Pseudomonadales      Moraxellaceae     Acinetobacter
## 73:    Pseudomonadales      Moraxellaceae     Acinetobacter
## 74:    Burkholderiales     Comamonadaceae                  
## 75:    Pseudomonadales      Moraxellaceae     Acinetobacter
##                  order             family             genus
## [1] &quot;Highest degree OTU was OTU_3510 (degree = 62 ):&quot;
##         OTU   domain         phylum               class            order
## 1: OTU_3510 Bacteria Proteobacteria Alphaproteobacteria Sphingomonadales
##               family genus
## 1: Sphingomonadaceae      
## [1] &quot;Other OTUs in the same community as OTU_3510 :&quot;
##           OTU   domain         phylum               class
##   1: OTU_5410 Bacteria Proteobacteria Alphaproteobacteria
##   2: OTU_5709 Bacteria Proteobacteria  Betaproteobacteria
##   3:   OTU_67 Bacteria Proteobacteria Alphaproteobacteria
##   4:   OTU_66 Bacteria Proteobacteria Alphaproteobacteria
##   5: OTU_3436 Bacteria Proteobacteria  Betaproteobacteria
##  ---                                                     
## 127:  OTU_779 Bacteria  Bacteroidetes         Bacteroidia
## 128:  OTU_774 Bacteria  Bacteroidetes       [Saprospirae]
## 129:  OTU_958 Bacteria  Bacteroidetes       [Saprospirae]
## 130:  OTU_543 Bacteria Actinobacteria      Actinobacteria
## 131: OTU_3174 Bacteria Proteobacteria Gammaproteobacteria
##                  order             family           genus
##   1:       Rhizobiales                                   
##   2:     Rhodocyclales     Rhodocyclaceae        Zoogloea
##   3:  Sphingomonadales Erythrobacteraceae                
##   4:  Rhodospirillales   Acetobacteraceae   Swaminathania
##   5:   Burkholderiales     Comamonadaceae                
##  ---                                                     
## 127:     Bacteroidales     Bacteroidaceae     Bacteroides
## 128:   [Saprospirales]   Chitinophagaceae                
## 129:   [Saprospirales]   Chitinophagaceae                
## 130: Bifidobacteriales Bifidobacteriaceae Bifidobacterium
## 131:   Pseudomonadales   Pseudomonadaceae     Pseudomonas
## [1] &quot;Highest degree OTU was OTU_407 (degree = 70 ):&quot;
##        OTU   domain     phylum   class      order           family
## 1: OTU_407 Bacteria Firmicutes Bacilli Bacillales Paenibacillaceae
##            genus
## 1: Paenibacillus
## [1] &quot;Other OTUs in the same community as OTU_407 :&quot;
##           OTU   domain         phylum               class
##   1: OTU_3950 Bacteria Proteobacteria  Betaproteobacteria
##   2:   OTU_64 Bacteria Proteobacteria Gammaproteobacteria
##   3:   OTU_21 Bacteria Proteobacteria Gammaproteobacteria
##   4:   OTU_20 Bacteria Proteobacteria Gammaproteobacteria
##   5:  OTU_635 Bacteria Proteobacteria Gammaproteobacteria
##  ---                                                     
## 143: OTU_3181 Bacteria Actinobacteria      Actinobacteria
## 144: OTU_4508 Bacteria Proteobacteria Alphaproteobacteria
## 145: OTU_3367 Bacteria Proteobacteria Gammaproteobacteria
## 146: OTU_2229 Bacteria Proteobacteria Alphaproteobacteria
## 147: OTU_1934 Bacteria Proteobacteria Alphaproteobacteria
##                  order             family            genus
##   1:   Burkholderiales     Comamonadaceae      Methylibium
##   2:   Pseudomonadales   Pseudomonadaceae                 
##   3:   Pseudomonadales   Pseudomonadaceae      Pseudomonas
##   4:   Pseudomonadales      Moraxellaceae    Acinetobacter
##   5:   Pseudomonadales      Moraxellaceae                 
##  ---                                                      
## 143:   Actinomycetales Corynebacteriaceae  Corynebacterium
## 144:     Rickettsiales       mitochondria                 
## 145: Enterobacteriales Enterobacteriaceae          Erwinia
## 146:   Rhodobacterales   Rhodobacteraceae Rubellimicrobium
## 147:     Rickettsiales       mitochondria                 
## [1] &quot;Highest degree OTU was OTU_3559 (degree = 46 ):&quot;
##         OTU   domain         phylum              class           order
## 1: OTU_3559 Bacteria Proteobacteria Betaproteobacteria Burkholderiales
##            family     genus
## 1: Comamonadaceae Comamonas
## [1] &quot;Other OTUs in the same community as OTU_3559 :&quot;
##           OTU   domain         phylum               class
##   1:  OTU_433 Bacteria Actinobacteria      Actinobacteria
##   2:  OTU_434 Bacteria Proteobacteria Alphaproteobacteria
##   3: OTU_1035 Bacteria  Bacteroidetes    Sphingobacteriia
##   4: OTU_5708 Bacteria Proteobacteria  Betaproteobacteria
##   5:  OTU_698 Bacteria Proteobacteria Alphaproteobacteria
##  ---                                                     
##  98:  OTU_132 Bacteria Proteobacteria Deltaproteobacteria
##  99: OTU_1028 Bacteria Proteobacteria Alphaproteobacteria
## 100: OTU_5257 Bacteria Proteobacteria  Betaproteobacteria
## 101:   OTU_74 Bacteria Actinobacteria      Actinobacteria
## 102:   OTU_75 Bacteria Proteobacteria Gammaproteobacteria
##                   order               family             genus
##   1:    Actinomycetales   Corynebacteriaceae   Corynebacterium
##   2:      Rickettsiales         mitochondria                  
##   3: Sphingobacteriales  Sphingobacteriaceae  Sphingobacterium
##   4:    Burkholderiales       Comamonadaceae                  
##   5:           Ellin329                                       
##  ---                                                          
##  98:       Myxococcales            0319-6G20                  
##  99:   Sphingomonadales    Sphingomonadaceae      Sphingopyxis
## 100:    Burkholderiales       Comamonadaceae         Pelomonas
## 101:    Actinomycetales Propionibacteriaceae Propionibacterium
## 102:    Pseudomonadales        Moraxellaceae         Moraxella
## [1] &quot;Highest degree OTU was OTU_38 (degree = 47 ):&quot;
##       OTU   domain         phylum               class           order
## 1: OTU_38 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##              family       genus
## 1: Pseudomonadaceae Pseudomonas
## [1] &quot;Other OTUs in the same community as OTU_38 :&quot;
##           OTU   domain          phylum                 class
##   1: OTU_3425 Bacteria  Proteobacteria    Betaproteobacteria
##   2: OTU_1484 Bacteria   Bacteroidetes      Sphingobacteriia
##   3: OTU_1154 Bacteria  Proteobacteria    Betaproteobacteria
##   4: OTU_1923 Bacteria  Proteobacteria   Alphaproteobacteria
##   5: OTU_3780 Bacteria  Proteobacteria    Betaproteobacteria
##  ---                                                        
## 155:  OTU_403 Bacteria  Actinobacteria        Actinobacteria
## 156: OTU_1212 Bacteria   Cyanobacteria Synechococcophycideae
## 157: OTU_1123 Bacteria Verrucomicrobia      Verrucomicrobiae
## 158: OTU_2220 Bacteria  Actinobacteria        Actinobacteria
## 159:   OTU_78 Bacteria  Proteobacteria   Gammaproteobacteria
##                   order              family         genus
##   1:    Burkholderiales      Comamonadaceae   Ramlibacter
##   2: Sphingobacteriales                                  
##   3:      Rhodocyclales      Rhodocyclaceae Dechloromonas
##   4:   Sphingomonadales   Sphingomonadaceae  Sphingomonas
##   5:      Rhodocyclales      Rhodocyclaceae Dechloromonas
##  ---                                                     
## 155:    Actinomycetales     Nocardioidaceae              
## 156:   Pseudanabaenales   Pseudanabaenaceae  Leptolyngbya
## 157: Verrucomicrobiales Verrucomicrobiaceae              
## 158:    Actinomycetales              ACK-M1              
## 159:    Xanthomonadales    Xanthomonadaceae</code></pre>
<pre class="r"><code>plot(complete_exposed_positive_communities, gr_complete_exposed_positive, 
     layout = layout.fruchterman.reingold(gr_complete_exposed_positive),
     rescaled = TRUE,
     vertex.size = 2, 
     vertex.label = NA
     )</code></pre>
<p><img src="bacteria_community_analysis_files/figure-html/cep.1-1.png" width="672" /></p>
<p>Modularity:</p>
<pre class="r"><code>(cep.mod &lt;- modularity(gr_complete_exposed_positive, membership(complete_exposed_positive_communities)))</code></pre>
<pre><code>## [1] 0.2484748</code></pre>
</div>
<div id="negative-weights-4" class="section level3">
<h3>Negative Weights</h3>
<pre class="r"><code>complete_exposed_negative &lt;- complete_negative_weights[treatment == &quot;Exposed&quot;]
complete_exposed_negative &lt;- complete_exposed_negative[, -1]
complete_exposed_negative[[3]] &lt;- abs(complete_exposed_negative[[3]])
gr_complete_exposed_negative &lt;- graph.data.frame(complete_exposed_negative, directed = FALSE)
complete_exposed_negative_communities &lt;- cluster_fast_greedy(gr_complete_exposed_negative, 
                                                           weights = E(gr_complete_exposed_negative)$rho)


hot_otus &lt;- vector()
for (community in communities(complete_exposed_negative_communities))
{
  sub_graph &lt;- induced.subgraph(graph = gr_complete_exposed_negative, 
                                    v = community, impl = &quot;auto&quot;)
  highest_degree_otu &lt;- V(sub_graph)[which.max(degree(sub_graph))]$name
  hot_otus &lt;- c(hot_otus, highest_degree_otu)
  print(paste(&quot;Highest degree OTU was&quot;, highest_degree_otu, &quot;(degree =&quot;,  
              degree(sub_graph, highest_degree_otu), &quot;):&quot;))
  print(taxa[OTU == highest_degree_otu])
        
  print(paste(&quot;Other OTUs in the same community as&quot;, highest_degree_otu, &quot;:&quot;))
  print(taxa[OTU %in% community])
}</code></pre>
<pre><code>## [1] &quot;Highest degree OTU was OTU_5 (degree = 14 ):&quot;
##      OTU   domain         phylum               class         order
## 1: OTU_5 Bacteria Proteobacteria Alphaproteobacteria Rickettsiales
##          family genus
## 1: mitochondria      
## [1] &quot;Other OTUs in the same community as OTU_5 :&quot;
##          OTU   domain         phylum               class             order
##  1: OTU_4337 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##  2:   OTU_20 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##  3: OTU_5192 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##  4: OTU_3128 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##  5: OTU_5778 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##  6: OTU_5776 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##  7:    OTU_5 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
##  8: OTU_4036 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##  9: OTU_5324 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
## 10: OTU_5839 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 11: OTU_5834 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
## 12: OTU_5867 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 13:  OTU_550 Bacteria Proteobacteria Alphaproteobacteria       Rhizobiales
## 14: OTU_3204 Bacteria Proteobacteria Gammaproteobacteria   Xanthomonadales
## 15:    OTU_3 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 16: OTU_4345 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##                  family            genus
##  1:       Moraxellaceae    Acinetobacter
##  2:       Moraxellaceae    Acinetobacter
##  3:      Comamonadaceae        Pelomonas
##  4:    Oxalobacteraceae                 
##  5:       Moraxellaceae    Acinetobacter
##  6:       Moraxellaceae    Acinetobacter
##  7:        mitochondria                 
##  8:       Moraxellaceae    Acinetobacter
##  9:       Moraxellaceae    Acinetobacter
## 10:  Enterobacteriaceae       Klebsiella
## 11:       Moraxellaceae    Acinetobacter
## 12:  Enterobacteriaceae                 
## 13: Methylobacteriaceae Methylobacterium
## 14:    Xanthomonadaceae                 
## 15:  Enterobacteriaceae          Erwinia
## 16:       Moraxellaceae    Acinetobacter
## [1] &quot;Highest degree OTU was OTU_6 (degree = 18 ):&quot;
##      OTU   domain         phylum               class           order
## 1: OTU_6 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##           family         genus
## 1: Moraxellaceae Acinetobacter
## [1] &quot;Other OTUs in the same community as OTU_6 :&quot;
##          OTU   domain         phylum               class
##  1: OTU_1035 Bacteria  Bacteroidetes    Sphingobacteriia
##  2: OTU_3950 Bacteria Proteobacteria  Betaproteobacteria
##  3:   OTU_45 Bacteria Proteobacteria Gammaproteobacteria
##  4:   OTU_49 Bacteria     Firmicutes             Bacilli
##  5:  OTU_446 Bacteria     Firmicutes          Clostridia
##  6:   OTU_16 Bacteria Proteobacteria  Betaproteobacteria
##  7: OTU_5289 Bacteria Proteobacteria Alphaproteobacteria
##  8: OTU_4387 Bacteria     Firmicutes             Bacilli
##  9: OTU_4161 Bacteria Proteobacteria Alphaproteobacteria
## 10:  OTU_336 Bacteria Proteobacteria Alphaproteobacteria
## 11: OTU_4222 Bacteria Proteobacteria Alphaproteobacteria
## 12: OTU_4227 Bacteria Proteobacteria Alphaproteobacteria
## 13: OTU_5247 Bacteria Proteobacteria Gammaproteobacteria
## 14: OTU_5553 Bacteria Proteobacteria Alphaproteobacteria
## 15:  OTU_397 Bacteria Proteobacteria Alphaproteobacteria
## 16: OTU_4938 Bacteria Proteobacteria Alphaproteobacteria
## 17: OTU_5854 Bacteria Proteobacteria  Betaproteobacteria
## 18: OTU_1076 Bacteria Actinobacteria      Actinobacteria
## 19:    OTU_8 Bacteria Proteobacteria Alphaproteobacteria
## 20:    OTU_6 Bacteria Proteobacteria Gammaproteobacteria
## 21: OTU_1759 Bacteria Proteobacteria Alphaproteobacteria
## 22: OTU_1934 Bacteria Proteobacteria Alphaproteobacteria
##          OTU   domain         phylum               class
##                  order              family            genus
##  1: Sphingobacteriales Sphingobacteriaceae Sphingobacterium
##  2:    Burkholderiales      Comamonadaceae      Methylibium
##  3:    Pseudomonadales       Moraxellaceae    Enhydrobacter
##  4:    Lactobacillales    Streptococcaceae    Streptococcus
##  5:      Clostridiales  [Mogibacteriaceae]                 
##  6:    Burkholderiales      Comamonadaceae    Aquabacterium
##  7:      Rickettsiales        mitochondria                 
##  8:         Bacillales         Bacillaceae    Anoxybacillus
##  9:      Rickettsiales        mitochondria                 
## 10:        Rhizobiales Methylobacteriaceae                 
## 11:      Rickettsiales        mitochondria                 
## 12:      Rickettsiales        mitochondria                 
## 13:  Enterobacteriales  Enterobacteriaceae                 
## 14:      Rickettsiales        mitochondria                 
## 15:    Rhodobacterales    Rhodobacteraceae       Paracoccus
## 16:      Rickettsiales        mitochondria                 
## 17:    Burkholderiales    Burkholderiaceae     Burkholderia
## 18:    Actinomycetales  Pseudonocardiaceae   Pseudonocardia
## 19:   Rhodospirillales    Acetobacteraceae    Gluconobacter
## 20:    Pseudomonadales       Moraxellaceae    Acinetobacter
## 21:      Rickettsiales        mitochondria                 
## 22:      Rickettsiales        mitochondria                 
##                  order              family            genus
## [1] &quot;Highest degree OTU was OTU_28 (degree = 10 ):&quot;
##       OTU   domain        phylum          class            order
## 1: OTU_28 Bacteria Bacteroidetes Flavobacteriia Flavobacteriales
##             family            genus
## 1: [Weeksellaceae] Chryseobacterium
## [1] &quot;Other OTUs in the same community as OTU_28 :&quot;
##          OTU   domain         phylum               class             order
##  1:   OTU_60 Bacteria  Bacteroidetes      Flavobacteriia  Flavobacteriales
##  2:   OTU_28 Bacteria  Bacteroidetes      Flavobacteriia  Flavobacteriales
##  3:  OTU_345 Bacteria Proteobacteria Gammaproteobacteria Oceanospirillales
##  4: OTU_5298 Bacteria Proteobacteria  Betaproteobacteria     Rhodocyclales
##  5: OTU_5629 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
##  6: OTU_1300 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
##  7: OTU_2079 Bacteria Actinobacteria      Actinobacteria   Actinomycetales
##  8: OTU_5976 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##  9:   OTU_94 Bacteria Proteobacteria                TA18         PHOS-HD29
## 10: OTU_4508 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
## 11: OTU_5257 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##                 family             genus
##  1:  Flavobacteriaceae    Flavobacterium
##  2:    [Weeksellaceae]  Chryseobacterium
##  3:     Halomonadaceae Haererehalobacter
##  4:     Rhodocyclaceae               C39
##  5: Enterobacteriaceae                  
##  6:       mitochondria                  
##  7:    Nocardioidaceae                  
##  8:     Comamonadaceae         Comamonas
##  9:                                     
## 10:       mitochondria                  
## 11:     Comamonadaceae         Pelomonas
## [1] &quot;Highest degree OTU was OTU_21 (degree = 5 ):&quot;
##       OTU   domain         phylum               class           order
## 1: OTU_21 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##              family       genus
## 1: Pseudomonadaceae Pseudomonas
## [1] &quot;Other OTUs in the same community as OTU_21 :&quot;
##          OTU   domain         phylum               class             order
##  1:   OTU_21 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##  2:   OTU_23 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##  3:  OTU_669 Bacteria  Bacteroidetes          Cytophagia      Cytophagales
##  4: OTU_4627 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##  5:  OTU_256 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##  6: OTU_4191 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##  7: OTU_5806 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
##  8: OTU_2168 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
##  9:  OTU_172 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 10: OTU_4218 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 11: OTU_5098 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 12:   OTU_88 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 13:  OTU_131 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##                 family             genus
##  1:   Pseudomonadaceae       Pseudomonas
##  2:     Comamonadaceae       Tepidimonas
##  3:      Cytophagaceae    Flectobacillus
##  4:     Comamonadaceae    Hydrogenophaga
##  5:   Oxalobacteraceae Janthinobacterium
##  6:      Moraxellaceae     Acinetobacter
##  7: Enterobacteriaceae                  
##  8: Enterobacteriaceae      Enterobacter
##  9:     Comamonadaceae        Rhodoferax
## 10:     Comamonadaceae        Rhodoferax
## 11:     Comamonadaceae         Comamonas
## 12:   Oxalobacteraceae                  
## 13:      Moraxellaceae                  
## [1] &quot;Highest degree OTU was OTU_5701 (degree = 4 ):&quot;
##         OTU   domain         phylum              class           order
## 1: OTU_5701 Bacteria Proteobacteria Betaproteobacteria Burkholderiales
##            family genus
## 1: Comamonadaceae      
## [1] &quot;Other OTUs in the same community as OTU_5701 :&quot;
##         OTU   domain         phylum               class            order
## 1: OTU_5838 Bacteria Proteobacteria Alphaproteobacteria Sphingomonadales
## 2: OTU_3986 Bacteria Proteobacteria Gammaproteobacteria  Pseudomonadales
## 3:   OTU_43 Bacteria Proteobacteria  Betaproteobacteria  Burkholderiales
## 4: OTU_5701 Bacteria Proteobacteria  Betaproteobacteria  Burkholderiales
## 5:   OTU_27 Bacteria     Firmicutes             Bacilli  Lactobacillales
## 6:  OTU_130 Bacteria Proteobacteria  Betaproteobacteria  Burkholderiales
##               family         genus
## 1: Sphingomonadaceae  Sphingomonas
## 2:     Moraxellaceae Acinetobacter
## 3:  Oxalobacteraceae   Cupriavidus
## 4:    Comamonadaceae              
## 5:  Streptococcaceae Streptococcus
## 6:  Oxalobacteraceae              
## [1] &quot;Highest degree OTU was OTU_22 (degree = 6 ):&quot;
##       OTU   domain         phylum              class           order
## 1: OTU_22 Bacteria Proteobacteria Betaproteobacteria Burkholderiales
##            family      genus
## 1: Comamonadaceae Variovorax
## [1] &quot;Other OTUs in the same community as OTU_22 :&quot;
##         OTU   domain         phylum               class            order
## 1:   OTU_64 Bacteria Proteobacteria Gammaproteobacteria  Pseudomonadales
## 2:   OTU_66 Bacteria Proteobacteria Alphaproteobacteria Rhodospirillales
## 3:   OTU_22 Bacteria Proteobacteria  Betaproteobacteria  Burkholderiales
## 4: OTU_3733 Bacteria Proteobacteria Alphaproteobacteria Sphingomonadales
## 5:   OTU_18 Bacteria     Firmicutes             Bacilli  Lactobacillales
## 6: OTU_5702 Bacteria Proteobacteria  Betaproteobacteria    Rhodocyclales
## 7:  OTU_253 Bacteria     Firmicutes             Bacilli       Bacillales
##               family           genus
## 1:  Pseudomonadaceae                
## 2:  Acetobacteraceae   Swaminathania
## 3:    Comamonadaceae      Variovorax
## 4: Sphingomonadaceae    Sphingomonas
## 5:  Lactobacillaceae   Lactobacillus
## 6:    Rhodocyclaceae   Dechloromonas
## 7:       Bacillaceae Natronobacillus
## [1] &quot;Highest degree OTU was OTU_214 (degree = 1 ):&quot;
##        OTU   domain         phylum               class           order
## 1: OTU_214 Bacteria Proteobacteria Gammaproteobacteria Xanthomonadales
##              family            genus
## 1: Xanthomonadaceae Stenotrophomonas
## [1] &quot;Other OTUs in the same community as OTU_214 :&quot;
##        OTU   domain         phylum               class           order
## 1:  OTU_51 Bacteria Actinobacteria      Actinobacteria Actinomycetales
## 2: OTU_214 Bacteria Proteobacteria Gammaproteobacteria Xanthomonadales
##               family            genus
## 1: Microbacteriaceae       Candidatus
## 2:  Xanthomonadaceae Stenotrophomonas
## [1] &quot;Highest degree OTU was OTU_2529 (degree = 1 ):&quot;
##         OTU   domain         phylum              class           order
## 1: OTU_2529 Bacteria Proteobacteria Betaproteobacteria Burkholderiales
##            family genus
## 1: Comamonadaceae      
## [1] &quot;Other OTUs in the same community as OTU_2529 :&quot;
##         OTU   domain         phylum              class           order
## 1: OTU_2529 Bacteria Proteobacteria Betaproteobacteria Burkholderiales
## 2:   OTU_74 Bacteria Actinobacteria     Actinobacteria Actinomycetales
##                  family             genus
## 1:       Comamonadaceae                  
## 2: Propionibacteriaceae Propionibacterium
## [1] &quot;Highest degree OTU was OTU_3492 (degree = 1 ):&quot;
##         OTU   domain         phylum               class             order
## 1: OTU_3492 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
##                family   genus
## 1: Enterobacteriaceae Erwinia
## [1] &quot;Other OTUs in the same community as OTU_3492 :&quot;
##         OTU   domain         phylum               class             order
## 1: OTU_3492 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 2: OTU_4680 Bacteria  Bacteroidetes      Flavobacteriia  Flavobacteriales
##                family          genus
## 1: Enterobacteriaceae        Erwinia
## 2:  Flavobacteriaceae Flavobacterium
## [1] &quot;Highest degree OTU was OTU_92 (degree = 1 ):&quot;
##       OTU   domain         phylum               class            order
## 1: OTU_92 Bacteria Proteobacteria Alphaproteobacteria Sphingomonadales
##               family        genus
## 1: Sphingomonadaceae Sphingomonas
## [1] &quot;Other OTUs in the same community as OTU_92 :&quot;
##         OTU   domain         phylum               class            order
## 1: OTU_1011 Bacteria Proteobacteria  Betaproteobacteria  Burkholderiales
## 2:   OTU_92 Bacteria Proteobacteria Alphaproteobacteria Sphingomonadales
##               family        genus
## 1:    Comamonadaceae             
## 2: Sphingomonadaceae Sphingomonas
## [1] &quot;Highest degree OTU was OTU_4153 (degree = 1 ):&quot;
##         OTU   domain         phylum               class             order
## 1: OTU_4153 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
##                family   genus
## 1: Enterobacteriaceae Erwinia
## [1] &quot;Other OTUs in the same community as OTU_4153 :&quot;
##         OTU   domain         phylum               class             order
## 1: OTU_3478 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
## 2: OTU_4153 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
##                family   genus
## 1:       mitochondria        
## 2: Enterobacteriaceae Erwinia
## [1] &quot;Highest degree OTU was OTU_9 (degree = 1 ):&quot;
##      OTU   domain         phylum               class           order
## 1: OTU_9 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##              family       genus
## 1: Pseudomonadaceae Pseudomonas
## [1] &quot;Other OTUs in the same community as OTU_9 :&quot;
##      OTU   domain         phylum               class            order
## 1: OTU_9 Bacteria Proteobacteria Gammaproteobacteria  Pseudomonadales
## 2: OTU_7 Bacteria  Bacteroidetes      Flavobacteriia Flavobacteriales
##              family           genus
## 1: Pseudomonadaceae     Pseudomonas
## 2:  [Weeksellaceae] Cloacibacterium</code></pre>
<pre class="r"><code>plot(complete_exposed_negative_communities, gr_complete_exposed_negative, 
     layout = layout.fruchterman.reingold(gr_complete_exposed_negative),
     rescaled = TRUE,
     vertex.size = 2, 
     vertex.label = NA
     )</code></pre>
<p><img src="bacteria_community_analysis_files/figure-html/cen.1-1.png" width="672" /></p>
<p>Modularity:</p>
<pre class="r"><code>(cen.mod &lt;- modularity(gr_complete_exposed_negative, membership(complete_exposed_negative_communities)))</code></pre>
<pre><code>## [1] 0.6004959</code></pre>
</div>
</div>
<div id="caged-communities-1" class="section level2">
<h2>Caged Communities</h2>
<div id="positive-weights-5" class="section level3">
<h3>Positive Weights</h3>
<pre class="r"><code>complete_caged_positive &lt;- complete_positive_weights[treatment == &quot;Caged&quot;]
complete_caged_positive &lt;- complete_caged_positive[, -1]
gr_complete_caged_positive &lt;- graph.data.frame(complete_caged_positive, directed = FALSE)
complete_caged_positive_communities &lt;- cluster_fast_greedy(gr_complete_caged_positive, 
                                                           weights = E(gr_complete_caged_positive)$rho)

hot_otus &lt;- vector()
for (community in communities(complete_caged_positive_communities))
{
  sub_graph &lt;- induced.subgraph(graph = gr_complete_caged_positive, 
                                    v = community, impl = &quot;auto&quot;)
  highest_degree_otu &lt;- V(sub_graph)[which.max(degree(sub_graph))]$name
  hot_otus &lt;- c(hot_otus, highest_degree_otu)
  print(paste(&quot;Highest degree OTU was&quot;, highest_degree_otu, &quot;(degree =&quot;,  
              degree(sub_graph, highest_degree_otu), &quot;):&quot;))
  print(taxa[OTU == highest_degree_otu])
        
  print(paste(&quot;Other OTUs in the same community as&quot;, highest_degree_otu, &quot;:&quot;))
  print(taxa[OTU %in% community])
}</code></pre>
<pre><code>## [1] &quot;Highest degree OTU was OTU_1214 (degree = 29 ):&quot;
##         OTU   domain        phylum       class order family genus
## 1: OTU_1214 Bacteria Bacteroidetes VC2_1_Bac22                   
## [1] &quot;Other OTUs in the same community as OTU_1214 :&quot;
##          OTU   domain          phylum                 class
##  1: OTU_1159 Bacteria      Firmicutes               Bacilli
##  2: OTU_3884 Bacteria  Proteobacteria    Betaproteobacteria
##  3: OTU_5709 Bacteria  Proteobacteria    Betaproteobacteria
##  4: OTU_3434 Bacteria  Proteobacteria Epsilonproteobacteria
##  5:  OTU_632 Bacteria      Firmicutes            Clostridia
##  6:  OTU_601 Bacteria  Proteobacteria   Gammaproteobacteria
##  7: OTU_3906 Bacteria  Proteobacteria   Gammaproteobacteria
##  8: OTU_5289 Bacteria  Proteobacteria   Alphaproteobacteria
##  9: OTU_1657 Bacteria   Bacteroidetes        Flavobacteriia
## 10: OTU_4161 Bacteria  Proteobacteria   Alphaproteobacteria
## 11:  OTU_751 Bacteria   Bacteroidetes      Sphingobacteriia
## 12: OTU_3731 Bacteria  Proteobacteria    Betaproteobacteria
## 13:  OTU_585 Bacteria  Proteobacteria   Alphaproteobacteria
## 14:  OTU_368 Bacteria   Bacteroidetes        Flavobacteriia
## 15: OTU_1275 Bacteria   Bacteroidetes        Flavobacteriia
## 16:  OTU_592 Bacteria  Proteobacteria   Gammaproteobacteria
## 17:  OTU_591 Bacteria  Proteobacteria    Betaproteobacteria
## 18:  OTU_373 Bacteria  Proteobacteria   Deltaproteobacteria
## 19:  OTU_186 Bacteria  Proteobacteria   Alphaproteobacteria
## 20:  OTU_324 Bacteria  Proteobacteria    Betaproteobacteria
## 21:  OTU_240       No           blast                   hit
## 22: OTU_1993 Bacteria  Proteobacteria   Alphaproteobacteria
## 23: OTU_1753 Bacteria  Proteobacteria    Betaproteobacteria
## 24: OTU_1741 Bacteria      Firmicutes               Bacilli
## 25: OTU_1346 Bacteria  Planctomycetes        Planctomycetia
## 26:  OTU_544 Bacteria  Actinobacteria        Actinobacteria
## 27: OTU_5734 Bacteria  Proteobacteria   Gammaproteobacteria
## 28: OTU_5883 Bacteria  Proteobacteria    Betaproteobacteria
## 29: OTU_1080 Bacteria   Bacteroidetes        Flavobacteriia
## 30:  OTU_820 Bacteria Verrucomicrobia              Opitutae
## 31: OTU_4938 Bacteria  Proteobacteria   Alphaproteobacteria
## 32:  OTU_905 Bacteria  Proteobacteria   Deltaproteobacteria
## 33: OTU_3823 Bacteria  Proteobacteria   Gammaproteobacteria
## 34: OTU_2733 Bacteria  Proteobacteria   Alphaproteobacteria
## 35: OTU_3282 Bacteria  Proteobacteria    Betaproteobacteria
## 36: OTU_1527 Bacteria Verrucomicrobia      Verrucomicrobiae
## 37:  OTU_972 Bacteria             OD1                   ZB2
## 38: OTU_1918 Bacteria  Planctomycetes        Planctomycetia
## 39: OTU_4071 Bacteria  Actinobacteria        Actinobacteria
## 40: OTU_1214 Bacteria   Bacteroidetes           VC2_1_Bac22
## 41: OTU_5038 Bacteria  Proteobacteria    Betaproteobacteria
## 42: OTU_4516 Bacteria  Proteobacteria    Betaproteobacteria
##          OTU   domain          phylum                 class
##                  order              family            genus
##  1:    Lactobacillales       Aerococcaceae        Facklamia
##  2:    Burkholderiales      Comamonadaceae                 
##  3:      Rhodocyclales      Rhodocyclaceae         Zoogloea
##  4:  Campylobacterales  Campylobacteraceae       Arcobacter
##  5:      Clostridiales      Clostridiaceae                 
##  6:  Enterobacteriales  Enterobacteriaceae         Yersinia
##  7:    Pseudomonadales       Moraxellaceae    Acinetobacter
##  8:      Rickettsiales        mitochondria                 
##  9:   Flavobacteriales     [Weeksellaceae]                 
## 10:      Rickettsiales        mitochondria                 
## 11: Sphingobacteriales                                     
## 12:    Burkholderiales      Comamonadaceae        Comamonas
## 13:      Rickettsiales      Rickettsiaceae                 
## 14:   Flavobacteriales   Flavobacteriaceae   Flavobacterium
## 15:   Flavobacteriales   Flavobacteriaceae   Flavobacterium
## 16:    Xanthomonadales    Xanthomonadaceae                 
## 17:    Burkholderiales      Comamonadaceae                 
## 18:       Myxococcales       Haliangiaceae                 
## 19:        Rhizobiales    Beijerinckiaceae                 
## 20:    Burkholderiales    Oxalobacteraceae                 
## 21:                                                        
## 22:                                                        
## 23:   Procabacteriales   Procabacteriaceae                 
## 24:    Lactobacillales    Lactobacillaceae    Lactobacillus
## 25:   Planctomycetales   Planctomycetaceae     Planctomyces
## 26:    Actinomycetales     Kineosporiaceae                 
## 27:  Enterobacteriales  Enterobacteriaceae          Erwinia
## 28:    Burkholderiales      Comamonadaceae    Limnohabitans
## 29:   Flavobacteriales     [Weeksellaceae] Chryseobacterium
## 30:   [Cerasicoccales]   [Cerasicoccaceae]                 
## 31:      Rickettsiales        mitochondria                 
## 32:              MIZ46                                     
## 33:    Pseudomonadales       Moraxellaceae    Acinetobacter
## 34:        Rhizobiales   Hyphomicrobiaceae                 
## 35:    Burkholderiales      Comamonadaceae        Comamonas
## 36: Verrucomicrobiales Verrucomicrobiaceae                 
## 37:                                                        
## 38:       Pirellulales       Pirellulaceae                 
## 39:    Actinomycetales                                     
## 40:                                                        
## 41:      Rhodocyclales      Rhodocyclaceae    Dechloromonas
## 42:    Burkholderiales      Comamonadaceae    Limnohabitans
##                  order              family            genus
## [1] &quot;Highest degree OTU was OTU_571 (degree = 53 ):&quot;
##        OTU   domain     phylum   class      order           family
## 1: OTU_571 Bacteria Firmicutes Bacilli Bacillales Paenibacillaceae
##            genus
## 1: Paenibacillus
## [1] &quot;Other OTUs in the same community as OTU_571 :&quot;
##           OTU   domain         phylum               class            order
##   1: OTU_5410 Bacteria Proteobacteria Alphaproteobacteria      Rhizobiales
##   2: OTU_3780 Bacteria Proteobacteria  Betaproteobacteria    Rhodocyclales
##   3: OTU_3304 Bacteria Proteobacteria  Betaproteobacteria  Burkholderiales
##   4:   OTU_64 Bacteria Proteobacteria Gammaproteobacteria  Pseudomonadales
##   5:   OTU_66 Bacteria Proteobacteria Alphaproteobacteria Rhodospirillales
##  ---                                                                      
## 113:  OTU_958 Bacteria  Bacteroidetes       [Saprospirae]  [Saprospirales]
## 114: OTU_1934 Bacteria Proteobacteria Alphaproteobacteria    Rickettsiales
## 115: OTU_2595 Bacteria Proteobacteria Gammaproteobacteria  Pseudomonadales
## 116: OTU_3174 Bacteria Proteobacteria Gammaproteobacteria  Pseudomonadales
## 117:   OTU_74 Bacteria Actinobacteria      Actinobacteria  Actinomycetales
##                    family             genus
##   1:                                       
##   2:       Rhodocyclaceae     Dechloromonas
##   3:     Oxalobacteraceae                  
##   4:     Pseudomonadaceae                  
##   5:     Acetobacteraceae     Swaminathania
##  ---                                       
## 113:     Chitinophagaceae                  
## 114:         mitochondria                  
## 115:        Moraxellaceae     Acinetobacter
## 116:     Pseudomonadaceae       Pseudomonas
## 117: Propionibacteriaceae Propionibacterium
## [1] &quot;Highest degree OTU was OTU_156 (degree = 23 ):&quot;
##        OTU   domain         phylum              class           order
## 1: OTU_156 Bacteria Proteobacteria Betaproteobacteria Burkholderiales
##              family            genus
## 1: Oxalobacteraceae Polynucleobacter
## [1] &quot;Other OTUs in the same community as OTU_156 :&quot;
##          OTU   domain          phylum                 class
##  1: OTU_4337 Bacteria  Proteobacteria   Gammaproteobacteria
##  2:  OTU_435 Bacteria  Actinobacteria        Actinobacteria
##  3:  OTU_434 Bacteria  Proteobacteria   Alphaproteobacteria
##  4:  OTU_699 Bacteria  Proteobacteria   Alphaproteobacteria
##  5:  OTU_989 Bacteria      Firmicutes            Clostridia
##  6:  OTU_446 Bacteria      Firmicutes            Clostridia
##  7:  OTU_743 Bacteria   Bacteroidetes         [Saprospirae]
##  8:  OTU_464 Bacteria  Proteobacteria   Deltaproteobacteria
##  9: OTU_5451 Bacteria  Proteobacteria    Betaproteobacteria
## 10:   OTU_13 Bacteria  Proteobacteria    Betaproteobacteria
## 11: OTU_3112 Bacteria             OP3                koll11
## 12: OTU_5498 Bacteria  Proteobacteria    Betaproteobacteria
## 13: OTU_5307 Bacteria  Proteobacteria    Betaproteobacteria
## 14: OTU_1277 Bacteria  Proteobacteria    Betaproteobacteria
## 15: OTU_5823 Bacteria  Proteobacteria   Gammaproteobacteria
## 16:  OTU_371       No           blast                   hit
## 17: OTU_4036 Bacteria  Proteobacteria   Gammaproteobacteria
## 18:  OTU_798 Bacteria  Proteobacteria    Betaproteobacteria
## 19: OTU_3986 Bacteria  Proteobacteria   Gammaproteobacteria
## 20: OTU_5324 Bacteria  Proteobacteria   Gammaproteobacteria
## 21: OTU_2172 Bacteria  Proteobacteria   Gammaproteobacteria
## 22:  OTU_899 Bacteria  Proteobacteria   Gammaproteobacteria
## 23: OTU_5312 Bacteria  Actinobacteria        Actinobacteria
## 24:  OTU_156 Bacteria  Proteobacteria    Betaproteobacteria
## 25: OTU_4228 Bacteria  Proteobacteria    Betaproteobacteria
## 26: OTU_2303 Bacteria           WPS-2                      
## 27:  OTU_412 Bacteria  Actinobacteria        Actinobacteria
## 28:  OTU_126 Bacteria   Bacteroidetes      Sphingobacteriia
## 29:  OTU_701 Bacteria  Proteobacteria   Deltaproteobacteria
## 30: OTU_1088 Bacteria   Cyanobacteria Synechococcophycideae
## 31: OTU_5706 Bacteria  Proteobacteria    Betaproteobacteria
## 32: OTU_2734 Bacteria Armatimonadetes      [Fimbriimonadia]
## 33: OTU_4955 Bacteria  Proteobacteria    Betaproteobacteria
## 34: OTU_4887 Bacteria  Proteobacteria   Gammaproteobacteria
## 35: OTU_4082 Bacteria  Actinobacteria        Actinobacteria
## 36:  OTU_766 Bacteria             OD1                      
## 37: OTU_4570 Bacteria  Proteobacteria   Gammaproteobacteria
## 38: OTU_3972 Bacteria  Proteobacteria    Betaproteobacteria
## 39:  OTU_824 Bacteria  Proteobacteria   Alphaproteobacteria
## 40:  OTU_403 Bacteria  Actinobacteria        Actinobacteria
##          OTU   domain          phylum                 class
##                  order              family            genus
##  1:    Pseudomonadales       Moraxellaceae    Acinetobacter
##  2:    Actinomycetales      Micrococcaceae          Kocuria
##  3:      Rickettsiales        mitochondria                 
##  4:        Rhizobiales   Hyphomicrobiaceae                 
##  5:      Clostridiales   [Tissierellaceae]     Anaerococcus
##  6:      Clostridiales  [Mogibacteriaceae]                 
##  7:    [Saprospirales]    Chitinophagaceae                 
##  8:  Bdellovibrionales  Bdellovibrionaceae     Bdellovibrio
##  9:    Burkholderiales      Comamonadaceae       Acidovorax
## 10:    Burkholderiales      Comamonadaceae       Acidovorax
## 11:                                                        
## 12:    Burkholderiales      Comamonadaceae       Roseateles
## 13:    Burkholderiales      Comamonadaceae                 
## 14:    Burkholderiales      Alcaligenaceae    Denitrobacter
## 15:    Pseudomonadales       Moraxellaceae    Acinetobacter
## 16:                                                        
## 17:    Pseudomonadales       Moraxellaceae    Acinetobacter
## 18:    Burkholderiales      Comamonadaceae        Comamonas
## 19:    Pseudomonadales       Moraxellaceae    Acinetobacter
## 20:    Pseudomonadales       Moraxellaceae    Acinetobacter
## 21:     Pasteurellales     Pasteurellaceae   Actinobacillus
## 22:      Legionellales      Legionellaceae                 
## 23:    Actinomycetales Geodermatophilaceae                 
## 24:    Burkholderiales    Oxalobacteraceae Polynucleobacter
## 25:      Rhodocyclales      Rhodocyclaceae    Dechloromonas
## 26:                                                        
## 27:    Actinomycetales   Brevibacteriaceae   Brevibacterium
## 28: Sphingobacteriales Sphingobacteriaceae       Pedobacter
## 29:       Myxococcales       Myxococcaceae                 
## 30:   Pseudanabaenales   Pseudanabaenaceae     Leptolyngbya
## 31:    Burkholderiales      Comamonadaceae                 
## 32: [Fimbriimonadales] [Fimbriimonadaceae]                 
## 33:      Rhodocyclales      Rhodocyclaceae    Dechloromonas
## 34:    Pseudomonadales       Moraxellaceae    Acinetobacter
## 35:    Actinomycetales   Cellulomonadaceae     Cellulomonas
## 36:                                                        
## 37:    Pseudomonadales       Moraxellaceae    Acinetobacter
## 38:      Rhodocyclales      Rhodocyclaceae    Dechloromonas
## 39:        Rhizobiales    Methylocystaceae                 
## 40:    Actinomycetales     Nocardioidaceae                 
##                  order              family            genus
## [1] &quot;Highest degree OTU was OTU_4464 (degree = 53 ):&quot;
##         OTU   domain         phylum              class           order
## 1: OTU_4464 Bacteria Proteobacteria Betaproteobacteria Burkholderiales
##            family         genus
## 1: Comamonadaceae Limnohabitans
## [1] &quot;Other OTUs in the same community as OTU_4464 :&quot;
##           OTU   domain         phylum               class
##   1: OTU_3425 Bacteria Proteobacteria  Betaproteobacteria
##   2: OTU_1923 Bacteria Proteobacteria Alphaproteobacteria
##   3:   OTU_60 Bacteria  Bacteroidetes      Flavobacteriia
##   4: OTU_1149 Bacteria Proteobacteria Deltaproteobacteria
##   5: OTU_5135 Bacteria Proteobacteria  Betaproteobacteria
##  ---                                                     
## 104: OTU_3370 Bacteria Proteobacteria  Betaproteobacteria
## 105: OTU_4909 Bacteria  Bacteroidetes      Flavobacteriia
## 106: OTU_1055 Bacteria   Fusobacteria       Fusobacteriia
## 107: OTU_2220 Bacteria Actinobacteria      Actinobacteria
## 108: OTU_5257 Bacteria Proteobacteria  Betaproteobacteria
##                  order             family          genus
##   1:   Burkholderiales     Comamonadaceae    Ramlibacter
##   2:  Sphingomonadales  Sphingomonadaceae   Sphingomonas
##   3:  Flavobacteriales  Flavobacteriaceae Flavobacterium
##   4: Bdellovibrionales Bdellovibrionaceae   Bdellovibrio
##   5:   Burkholderiales     Comamonadaceae               
##  ---                                                    
## 104:   Burkholderiales     Comamonadaceae  Limnohabitans
## 105:  Flavobacteriales  Flavobacteriaceae Flavobacterium
## 106:   Fusobacteriales                                  
## 107:   Actinomycetales             ACK-M1               
## 108:   Burkholderiales     Comamonadaceae      Pelomonas
## [1] &quot;Highest degree OTU was OTU_5345 (degree = 23 ):&quot;
##         OTU   domain        phylum            class              order
## 1: OTU_5345 Bacteria Bacteroidetes Sphingobacteriia Sphingobacteriales
##    family genus
## 1:             
## [1] &quot;Other OTUs in the same community as OTU_5345 :&quot;
##          OTU   domain          phylum                 class
##  1: OTU_1484 Bacteria   Bacteroidetes      Sphingobacteriia
##  2:   OTU_65 Bacteria  Proteobacteria   Alphaproteobacteria
##  3: OTU_1004 Bacteria  Proteobacteria    Betaproteobacteria
##  4:  OTU_638 Bacteria  Actinobacteria        Actinobacteria
##  5: OTU_5064 Bacteria  Proteobacteria   Alphaproteobacteria
##  6: OTU_3930 Bacteria  Proteobacteria   Alphaproteobacteria
##  7: OTU_5682 Bacteria  Proteobacteria   Gammaproteobacteria
##  8:  OTU_440 Bacteria      Firmicutes               Bacilli
##  9: OTU_5475 Bacteria  Proteobacteria   Gammaproteobacteria
## 10: OTU_1205 Bacteria Verrucomicrobia      [Spartobacteria]
## 11: OTU_4555 Bacteria      Firmicutes               Bacilli
## 12: OTU_4336 Bacteria  Proteobacteria   Gammaproteobacteria
## 13:  OTU_750 Bacteria  Proteobacteria   Deltaproteobacteria
## 14: OTU_1245 Bacteria      Firmicutes               Bacilli
## 15: OTU_1864 Bacteria  Actinobacteria        Actinobacteria
## 16: OTU_1866 Bacteria  Proteobacteria    Betaproteobacteria
## 17: OTU_2120 Bacteria  Proteobacteria   Alphaproteobacteria
## 18: OTU_3525 Bacteria  Proteobacteria    Betaproteobacteria
## 19:  OTU_105 Bacteria  Proteobacteria   Alphaproteobacteria
## 20: OTU_3509 Bacteria  Proteobacteria    Betaproteobacteria
## 21: OTU_5345 Bacteria   Bacteroidetes      Sphingobacteriia
## 22: OTU_1829 Bacteria  Proteobacteria   Alphaproteobacteria
## 23:  OTU_165 Bacteria  Proteobacteria   Alphaproteobacteria
## 24:  OTU_786 Bacteria  Proteobacteria    Betaproteobacteria
## 25: OTU_4004 Bacteria   Bacteroidetes         [Saprospirae]
## 26: OTU_5836 Bacteria  Proteobacteria    Betaproteobacteria
## 27: OTU_3559 Bacteria  Proteobacteria    Betaproteobacteria
## 28: OTU_5867 Bacteria  Proteobacteria   Gammaproteobacteria
## 29:  OTU_888 Bacteria    Spirochaetes          Spirochaetes
## 30:  OTU_524 Bacteria  Actinobacteria        Actinobacteria
## 31: OTU_5669 Bacteria  Proteobacteria    Betaproteobacteria
## 32:  OTU_306 Bacteria      Firmicutes            Clostridia
## 33: OTU_5702 Bacteria  Proteobacteria    Betaproteobacteria
## 34:  OTU_503 Bacteria  Proteobacteria   Gammaproteobacteria
## 35: OTU_1570 Bacteria   Bacteroidetes            Cytophagia
## 36: OTU_3269 Bacteria  Proteobacteria   Alphaproteobacteria
## 37: OTU_1987 Bacteria  Proteobacteria    Betaproteobacteria
## 38:  OTU_510 Bacteria  Proteobacteria    Betaproteobacteria
## 39:  OTU_928 Bacteria  Proteobacteria   Alphaproteobacteria
## 40: OTU_5953 Bacteria  Proteobacteria   Alphaproteobacteria
## 41:  OTU_625 Bacteria  Proteobacteria   Alphaproteobacteria
## 42: OTU_1724 Bacteria  Proteobacteria   Alphaproteobacteria
## 43:  OTU_939 Bacteria  Actinobacteria         Rubrobacteria
## 44: OTU_2718 Bacteria  Proteobacteria   Alphaproteobacteria
## 45:   OTU_82 Bacteria   Bacteroidetes      Sphingobacteriia
## 46: OTU_5938 Bacteria  Proteobacteria   Alphaproteobacteria
## 47:  OTU_238 Bacteria  Proteobacteria   Alphaproteobacteria
## 48: OTU_4482 Bacteria  Proteobacteria    Betaproteobacteria
## 49: OTU_1114 Bacteria  Proteobacteria   Gammaproteobacteria
## 50: OTU_4345 Bacteria  Proteobacteria   Gammaproteobacteria
## 51: OTU_1759 Bacteria  Proteobacteria   Alphaproteobacteria
## 52: OTU_5763 Bacteria  Proteobacteria   Alphaproteobacteria
## 53: OTU_4577 Bacteria  Proteobacteria   Alphaproteobacteria
## 54:   OTU_94 Bacteria  Proteobacteria                  TA18
## 55: OTU_5440 Bacteria  Proteobacteria    Betaproteobacteria
## 56:  OTU_772 Bacteria   Acidobacteria  [Chloracidobacteria]
## 57: OTU_1212 Bacteria   Cyanobacteria Synechococcophycideae
##          OTU   domain          phylum                 class
##                    order                family             genus
##  1:   Sphingobacteriales                                        
##  2:     Sphingomonadales     Sphingomonadaceae      Sphingomonas
##  3:      Burkholderiales        Comamonadaceae        Variovorax
##  4:      Actinomycetales                ACK-M1                  
##  5:        Rickettsiales          mitochondria                  
##  6:          Rhizobiales     Bradyrhizobiaceae                  
##  7:      Pseudomonadales         Moraxellaceae     Acinetobacter
##  8:      Lactobacillales      Lactobacillaceae     Lactobacillus
##  9:      Pseudomonadales      Pseudomonadaceae       Pseudomonas
## 10: [Chthoniobacterales] [Chthoniobacteraceae]                  
## 11:           Bacillales        Planococcaceae      Solibacillus
## 12:        Legionellales        Legionellaceae                  
## 13:         Myxococcales                                        
## 14:      Lactobacillales         Aerococcaceae      Alloiococcus
## 15:      Actinomycetales        Dermacoccaceae       Dermacoccus
## 16:      Burkholderiales        Comamonadaceae      Giesbergeria
## 17:          Rhizobiales     Hyphomicrobiaceae       Rhodoplanes
## 18:      Burkholderiales      Burkholderiaceae      Burkholderia
## 19:      Rhodobacterales      Rhodobacteraceae       Rhodobacter
## 20:      Burkholderiales      Oxalobacteraceae                  
## 21:   Sphingobacteriales                                        
## 22:          Rhizobiales     Hyphomicrobiaceae           Devosia
## 23:     Sphingomonadales                                        
## 24:      Burkholderiales        Comamonadaceae                  
## 25:      [Saprospirales]      Chitinophagaceae Sediminibacterium
## 26:      Burkholderiales        Comamonadaceae        Variovorax
## 27:      Burkholderiales        Comamonadaceae         Comamonas
## 28:    Enterobacteriales    Enterobacteriaceae                  
## 29:       Spirochaetales       Spirochaetaceae         Treponema
## 30:      Actinomycetales     Cellulomonadaceae      Cellulomonas
## 31:      Burkholderiales        Comamonadaceae         Pelomonas
## 32:        Clostridiales       Veillonellaceae       Veillonella
## 33:        Rhodocyclales        Rhodocyclaceae     Dechloromonas
## 34:        Legionellales        Legionellaceae        Legionella
## 35:         Cytophagales         Cytophagaceae      Hymenobacter
## 36:     Sphingomonadales     Sphingomonadaceae      Sphingomonas
## 37:      Burkholderiales        Comamonadaceae                  
## 38:        Rhodocyclales        Rhodocyclaceae     Dechloromonas
## 39:          Rhizobiales     Hyphomicrobiaceae    Hyphomicrobium
## 40:     Sphingomonadales     Sphingomonadaceae      Sphingomonas
## 41:          Rhizobiales     Hyphomicrobiaceae    Hyphomicrobium
## 42:      Caulobacterales      Caulobacteraceae     Brevundimonas
## 43:      Rubrobacterales      Rubrobacteraceae       Rubrobacter
## 44:      Caulobacterales      Caulobacteraceae                  
## 45:   Sphingobacteriales                                        
## 46:          Rhizobiales     Bradyrhizobiaceae                  
## 47:          Rhizobiales          Rhizobiaceae        Candidatus
## 48:      Burkholderiales        Comamonadaceae     Limnohabitans
## 49:      Xanthomonadales       Sinobacteraceae                  
## 50:      Pseudomonadales         Moraxellaceae     Acinetobacter
## 51:        Rickettsiales          mitochondria                  
## 52:                                                             
## 53:      Rhodobacterales      Rhodobacteraceae  Rubellimicrobium
## 54:            PHOS-HD29                                        
## 55:      Burkholderiales        Comamonadaceae         Comamonas
## 56:                 PK29                                        
## 57:     Pseudanabaenales     Pseudanabaenaceae      Leptolyngbya
##                    order                family             genus
## [1] &quot;Highest degree OTU was OTU_1018 (degree = 24 ):&quot;
##         OTU   domain         phylum               class           order
## 1: OTU_1018 Bacteria Proteobacteria Alphaproteobacteria Rhodobacterales
##             family genus
## 1: Hyphomonadaceae      
## [1] &quot;Other OTUs in the same community as OTU_1018 :&quot;
##          OTU   domain         phylum               class             order
##  1: OTU_3950 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##  2: OTU_1791 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
##  3:  OTU_634 Bacteria Actinobacteria      Actinobacteria   Actinomycetales
##  4:  OTU_982 Bacteria Proteobacteria Gammaproteobacteria   Xanthomonadales
##  5: OTU_5066 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##  6: OTU_1018 Bacteria Proteobacteria Alphaproteobacteria   Rhodobacterales
##  7:  OTU_444 Bacteria Proteobacteria Deltaproteobacteria Bdellovibrionales
##  8: OTU_2406 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
##  9:   OTU_14 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 10: OTU_1422 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
## 11: OTU_4447 Bacteria Proteobacteria Gammaproteobacteria     Legionellales
## 12: OTU_1674 Bacteria    Chloroflexi         Chloroflexi   [Roseiflexales]
## 13: OTU_5819 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 14:  OTU_149 Bacteria Actinobacteria      Actinobacteria   Actinomycetales
## 15:  OTU_881 Bacteria  Bacteroidetes          Cytophagia      Cytophagales
## 16:  OTU_336 Bacteria Proteobacteria Alphaproteobacteria       Rhizobiales
## 17: OTU_4224 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 18:  OTU_539 Bacteria  Fibrobacteres                                      
## 19:  OTU_272 Bacteria Actinobacteria      Actinobacteria   Actinomycetales
## 20: OTU_4598 Bacteria     Firmicutes             Bacilli        Bacillales
## 21: OTU_5775 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 22: OTU_5812 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 23:   OTU_91 Bacteria Proteobacteria Alphaproteobacteria   Caulobacterales
## 24: OTU_3979 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##          OTU   domain         phylum               class             order
##                  family             genus
##  1:      Comamonadaceae       Methylibium
##  2:                                      
##  3:  Corynebacteriaceae   Corynebacterium
##  4:    Xanthomonadaceae        Dokdonella
##  5:      Comamonadaceae                  
##  6:     Hyphomonadaceae                  
##  7:  Bdellovibrionaceae      Bdellovibrio
##  8:        mitochondria                  
##  9:      Comamonadaceae                  
## 10:                                      
## 11:      Legionellaceae                  
## 12:                                      
## 13:    Oxalobacteraceae Janthinobacterium
## 14:                                      
## 15:       Cytophagaceae         Emticicia
## 16: Methylobacteriaceae                  
## 17:  Enterobacteriaceae                  
## 18:                                      
## 19:   Microbacteriaceae       Clavibacter
## 20:         Bacillaceae     Anoxybacillus
## 21:  Enterobacteriaceae        Klebsiella
## 22:      Comamonadaceae        Rhodoferax
## 23:    Caulobacteraceae       Caulobacter
## 24:      Comamonadaceae     Limnohabitans
##                  family             genus
## [1] &quot;Highest degree OTU was OTU_4153 (degree = 23 ):&quot;
##         OTU   domain         phylum               class             order
## 1: OTU_4153 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
##                family   genus
## 1: Enterobacteriaceae Erwinia
## [1] &quot;Other OTUs in the same community as OTU_4153 :&quot;
##          OTU   domain         phylum               class
##  1:   OTU_67 Bacteria Proteobacteria Alphaproteobacteria
##  2: OTU_1002 Bacteria Actinobacteria     Thermoleophilia
##  3: OTU_3922 Bacteria Actinobacteria      Actinobacteria
##  4:  OTU_872 Bacteria Actinobacteria      Actinobacteria
##  5: OTU_3913 Bacteria Proteobacteria  Betaproteobacteria
##  6: OTU_5194 Bacteria Actinobacteria      Actinobacteria
##  7: OTU_3128 Bacteria Proteobacteria  Betaproteobacteria
##  8: OTU_1228 Bacteria Proteobacteria Alphaproteobacteria
##  9:  OTU_490 Bacteria Actinobacteria      Actinobacteria
## 10: OTU_4153 Bacteria Proteobacteria Gammaproteobacteria
## 11:  OTU_351 Bacteria Proteobacteria  Betaproteobacteria
## 12: OTU_1607 Bacteria Proteobacteria Alphaproteobacteria
## 13:  OTU_303 Bacteria     Firmicutes          Clostridia
## 14: OTU_4999 Bacteria Proteobacteria Gammaproteobacteria
## 15: OTU_5535 Bacteria Actinobacteria      Actinobacteria
## 16:  OTU_705 Bacteria Proteobacteria Alphaproteobacteria
## 17:  OTU_397 Bacteria Proteobacteria Alphaproteobacteria
## 18:   OTU_88 Bacteria Proteobacteria  Betaproteobacteria
## 19: OTU_2485 Bacteria Actinobacteria      Actinobacteria
## 20: OTU_3350 Bacteria Proteobacteria Alphaproteobacteria
## 21: OTU_1054 Bacteria     Firmicutes          Clostridia
## 22: OTU_3187 Bacteria Proteobacteria Alphaproteobacteria
##          OTU   domain         phylum               class
##                   order                family           genus
##  1:    Sphingomonadales    Erythrobacteraceae                
##  2: Solirubrobacterales                                      
##  3:     Actinomycetales       Nocardioidaceae                
##  4:     Actinomycetales       Nocardioidaceae                
##  5:     Burkholderiales        Comamonadaceae                
##  6:     Actinomycetales     Microbacteriaceae Salinibacterium
##  7:     Burkholderiales      Oxalobacteraceae                
##  8:    Rhodospirillales      Acetobacteraceae      Roseomonas
##  9:     Actinomycetales        Micrococcaceae          Rothia
## 10:   Enterobacteriales    Enterobacteriaceae         Erwinia
## 11:       Rhodocyclales        Rhodocyclaceae   Dechloromonas
## 12:    Sphingomonadales     Sphingomonadaceae    Sphingomonas
## 13:       Clostridiales Peptostreptococcaceae                
## 14:   Enterobacteriales    Enterobacteriaceae      Salmonella
## 15:     Actinomycetales        Micrococcaceae          Rothia
## 16:         Rhizobiales     Bradyrhizobiaceae     Balneimonas
## 17:     Rhodobacterales      Rhodobacteraceae      Paracoccus
## 18:     Burkholderiales      Oxalobacteraceae                
## 19:     Actinomycetales    Micromonosporaceae    Actinoplanes
## 20:    Rhodospirillales      Acetobacteraceae                
## 21:       Clostridiales       Veillonellaceae     Veillonella
## 22:         Rhizobiales     Hyphomicrobiaceae         Devosia
##                   order                family           genus
## [1] &quot;Highest degree OTU was OTU_1454 (degree = 43 ):&quot;
##         OTU   domain         phylum                 class
## 1: OTU_1454 Bacteria Proteobacteria Epsilonproteobacteria
##                order            family         genus
## 1: Campylobacterales Helicobacteraceae Sulfuricurvum
## [1] &quot;Other OTUs in the same community as OTU_1454 :&quot;
##          OTU   domain          phylum                 class
##  1: OTU_1492 Bacteria  Proteobacteria   Alphaproteobacteria
##  2: OTU_1000 Bacteria  Proteobacteria   Alphaproteobacteria
##  3:  OTU_633 Bacteria  Proteobacteria   Alphaproteobacteria
##  4: OTU_4261 Bacteria  Proteobacteria    Betaproteobacteria
##  5: OTU_1011 Bacteria  Proteobacteria    Betaproteobacteria
##  6:   OTU_47 Bacteria  Actinobacteria        Actinobacteria
##  7:   OTU_49 Bacteria      Firmicutes               Bacilli
##  8: OTU_3733 Bacteria  Proteobacteria   Alphaproteobacteria
##  9: OTU_1193 Bacteria  Actinobacteria        Actinobacteria
## 10: OTU_5190 Bacteria  Proteobacteria    Betaproteobacteria
## 11:  OTU_690 Bacteria  Actinobacteria        Actinobacteria
## 12: OTU_2435 Bacteria  Proteobacteria   Alphaproteobacteria
## 13:  OTU_285 Bacteria   Bacteroidetes        Flavobacteriia
## 14:   OTU_18 Bacteria      Firmicutes               Bacilli
## 15:  OTU_480 Bacteria  Proteobacteria   Alphaproteobacteria
## 16: OTU_1437 Bacteria  Proteobacteria   Alphaproteobacteria
## 17: OTU_1438 Bacteria  Proteobacteria    Betaproteobacteria
## 18: OTU_4631 Bacteria  Proteobacteria   Alphaproteobacteria
## 19: OTU_5035 Bacteria   Bacteroidetes      Sphingobacteriia
## 20: OTU_2444 Bacteria Verrucomicrobia        [Pedosphaerae]
## 21: OTU_2660 Bacteria   Acidobacteria       Acidobacteria-6
## 22: OTU_1808 Bacteria  Actinobacteria        Actinobacteria
## 23: OTU_5408 Bacteria  Proteobacteria    Betaproteobacteria
## 24: OTU_3385 Bacteria  Proteobacteria   Alphaproteobacteria
## 25:  OTU_138 Bacteria  Proteobacteria   Deltaproteobacteria
## 26: OTU_3510 Bacteria  Proteobacteria   Alphaproteobacteria
## 27:  OTU_582 Bacteria  Proteobacteria   Alphaproteobacteria
## 28: OTU_2109 Bacteria  Proteobacteria   Alphaproteobacteria
## 29:  OTU_162 Bacteria  Proteobacteria   Gammaproteobacteria
## 30:  OTU_166 Bacteria   Bacteroidetes         [Saprospirae]
## 31: OTU_5838 Bacteria  Proteobacteria   Alphaproteobacteria
## 32:  OTU_176 Bacteria  Actinobacteria        Actinobacteria
## 33:  OTU_318 Bacteria Verrucomicrobia      Verrucomicrobiae
## 34:  OTU_326 Bacteria  Proteobacteria   Gammaproteobacteria
## 35:  OTU_338 Bacteria  Proteobacteria   Gammaproteobacteria
## 36: OTU_2961 Bacteria  Proteobacteria    Betaproteobacteria
## 37: OTU_4222 Bacteria  Proteobacteria   Alphaproteobacteria
## 38:   OTU_92 Bacteria  Proteobacteria   Alphaproteobacteria
## 39: OTU_5724 Bacteria  Actinobacteria        Actinobacteria
## 40: OTU_1762 Bacteria  Proteobacteria   Alphaproteobacteria
## 41: OTU_5447 Bacteria  Proteobacteria    Betaproteobacteria
## 42:  OTU_250 Bacteria   Bacteroidetes      Sphingobacteriia
## 43: OTU_4706 Bacteria  Proteobacteria    Betaproteobacteria
## 44: OTU_4701 Bacteria  Proteobacteria   Gammaproteobacteria
## 45: OTU_1454 Bacteria  Proteobacteria Epsilonproteobacteria
## 46:   OTU_86 Bacteria  Proteobacteria   Gammaproteobacteria
## 47: OTU_2018 Bacteria  Actinobacteria        Actinobacteria
## 48:  OTU_210 Bacteria      Firmicutes            Clostridia
## 49:   OTU_80 Bacteria             OD1                   ZB2
## 50:   OTU_90 Bacteria  Proteobacteria    Betaproteobacteria
## 51:  OTU_409 Bacteria      Firmicutes            Clostridia
## 52: OTU_5743 Bacteria  Proteobacteria   Alphaproteobacteria
## 53:   OTU_78 Bacteria  Proteobacteria   Gammaproteobacteria
##          OTU   domain          phylum                 class
##                  order              family             genus
##  1:        Rhizobiales                                      
##  2:        Rhizobiales        Rhizobiaceae     Agrobacterium
##  3:   Rhodospirillales   Rhodospirillaceae       Skermanella
##  4:    Burkholderiales    Oxalobacteraceae Janthinobacterium
##  5:    Burkholderiales      Comamonadaceae                  
##  6:    Actinomycetales  Corynebacteriaceae   Corynebacterium
##  7:    Lactobacillales    Streptococcaceae     Streptococcus
##  8:   Sphingomonadales   Sphingomonadaceae      Sphingomonas
##  9:    Actinomycetales        Nocardiaceae       Rhodococcus
## 10:    Burkholderiales    Oxalobacteraceae                  
## 11:    Actinomycetales     Kineosporiaceae                  
## 12:        Rhizobiales Methylobacteriaceae                  
## 13:   Flavobacteriales     [Weeksellaceae]  Chryseobacterium
## 14:    Lactobacillales    Lactobacillaceae     Lactobacillus
## 15:   Rhodospirillales    Acetobacteraceae                  
## 16:   Rhodospirillales    Acetobacteraceae                  
## 17:    Burkholderiales    Oxalobacteraceae       Cupriavidus
## 18:   Sphingomonadales   Sphingomonadaceae      Sphingomonas
## 19: Sphingobacteriales                                      
## 20:   [Pedosphaerales]                                      
## 21:            iii1-15                                      
## 22:    Actinomycetales     Sporichthyaceae                  
## 23:    Burkholderiales                                      
## 24:   Sphingomonadales   Sphingomonadaceae      Sphingomonas
## 25:                                                         
## 26:   Sphingomonadales   Sphingomonadaceae                  
## 27:    Caulobacterales    Caulobacteraceae                  
## 28:   Rhodospirillales    Acetobacteraceae       Roseococcus
## 29:    Pseudomonadales       Moraxellaceae     Acinetobacter
## 30:    [Saprospirales]      Saprospiraceae                  
## 31:   Sphingomonadales   Sphingomonadaceae      Sphingomonas
## 32:    Actinomycetales      Micrococcaceae                  
## 33: Verrucomicrobiales Verrucomicrobiaceae   Prosthecobacter
## 34:    Alteromonadales    Alteromonadaceae        Cellvibrio
## 35:    Pseudomonadales    Pseudomonadaceae       Pseudomonas
## 36:    Burkholderiales                                      
## 37:      Rickettsiales        mitochondria                  
## 38:   Sphingomonadales   Sphingomonadaceae      Sphingomonas
## 39:    Actinomycetales Geodermatophilaceae     Modestobacter
## 40:   Sphingomonadales   Sphingomonadaceae      Sphingomonas
## 41:    Burkholderiales      Comamonadaceae        Acidovorax
## 42: Sphingobacteriales                                      
## 43:    Burkholderiales      Comamonadaceae                  
## 44:    Alteromonadales    Alteromonadaceae                  
## 45:  Campylobacterales   Helicobacteraceae     Sulfuricurvum
## 46:      Aeromonadales      Aeromonadaceae                  
## 47:    Actinomycetales   Microbacteriaceae                  
## 48:      Clostridiales   [Tissierellaceae]     Peptoniphilus
## 49:                                                         
## 50:    Burkholderiales      Alcaligenaceae     Achromobacter
## 51:      Clostridiales     Lachnospiraceae       Coprococcus
## 52:   Sphingomonadales   Sphingomonadaceae      Sphingomonas
## 53:    Xanthomonadales    Xanthomonadaceae                  
##                  order              family             genus
## [1] &quot;Highest degree OTU was OTU_543 (degree = 36 ):&quot;
##        OTU   domain         phylum          class             order
## 1: OTU_543 Bacteria Actinobacteria Actinobacteria Bifidobacteriales
##                family           genus
## 1: Bifidobacteriaceae Bifidobacterium
## [1] &quot;Other OTUs in the same community as OTU_543 :&quot;
##          OTU   domain          phylum                 class
##  1:   OTU_22 Bacteria  Proteobacteria    Betaproteobacteria
##  2:  OTU_854 Bacteria             OD1                   ZB2
##  3: OTU_3148 Bacteria  Actinobacteria        Actinobacteria
##  4:   OTU_44 Bacteria  Proteobacteria   Gammaproteobacteria
##  5: OTU_1786 Bacteria Verrucomicrobia        [Pedosphaerae]
##  6:  OTU_620 Bacteria  Planctomycetes        Planctomycetia
##  7:  OTU_622 Bacteria  Proteobacteria   Deltaproteobacteria
##  8:  OTU_991 Bacteria  Actinobacteria        Actinobacteria
##  9:  OTU_840 Bacteria  Proteobacteria   Deltaproteobacteria
## 10:  OTU_610 Bacteria  Proteobacteria   Deltaproteobacteria
## 11:   OTU_69 Bacteria  Proteobacteria   Gammaproteobacteria
## 12:   OTU_62 Bacteria  Proteobacteria   Alphaproteobacteria
## 13: OTU_1421 Bacteria  Proteobacteria    Betaproteobacteria
## 14: OTU_4627 Bacteria  Proteobacteria    Betaproteobacteria
## 15:  OTU_832 Bacteria  Proteobacteria   Alphaproteobacteria
## 16:  OTU_256 Bacteria  Proteobacteria    Betaproteobacteria
## 17: OTU_1476 Bacteria   Cyanobacteria Oscillatoriophycideae
## 18: OTU_3512 Bacteria   Bacteroidetes           Bacteroidia
## 19:  OTU_367 Bacteria             SR1                      
## 20: OTU_1270 Bacteria  Proteobacteria   Gammaproteobacteria
## 21:  OTU_118 Bacteria  Proteobacteria   Alphaproteobacteria
## 22: OTU_4218 Bacteria  Proteobacteria    Betaproteobacteria
## 23:  OTU_339 Bacteria      Firmicutes               Bacilli
## 24: OTU_3237 Bacteria   Bacteroidetes      Sphingobacteriia
## 25:  OTU_402 Bacteria  Proteobacteria    Betaproteobacteria
## 26: OTU_1084 Bacteria  Proteobacteria                  TA18
## 27: OTU_2323 Bacteria  Proteobacteria   Gammaproteobacteria
## 28: OTU_2504 Bacteria  Proteobacteria   Alphaproteobacteria
## 29:  OTU_125 Bacteria  Proteobacteria   Gammaproteobacteria
## 30: OTU_3061 Bacteria   Bacteroidetes         [Saprospirae]
## 31:  OTU_834 Bacteria  Proteobacteria   Alphaproteobacteria
## 32: OTU_3653 Bacteria  Proteobacteria    Betaproteobacteria
## 33: OTU_3258 Bacteria      Firmicutes               Bacilli
## 34:  OTU_710 Bacteria      Firmicutes               Bacilli
## 35: OTU_1450 Bacteria      Firmicutes            Clostridia
## 36: OTU_1082 Bacteria   Bacteroidetes        Flavobacteriia
## 37:  OTU_736 Bacteria  Actinobacteria        Actinobacteria
## 38:  OTU_730 Bacteria     Tenericutes            Mollicutes
## 39:  OTU_225 Bacteria  Proteobacteria   Gammaproteobacteria
## 40: OTU_1708 Bacteria   Bacteroidetes         [Saprospirae]
## 41:   OTU_71 Bacteria   Acidobacteria  [Chloracidobacteria]
## 42:    OTU_9 Bacteria  Proteobacteria   Gammaproteobacteria
## 43:  OTU_200 Bacteria  Proteobacteria   Gammaproteobacteria
## 44: OTU_5443 Bacteria  Proteobacteria    Betaproteobacteria
## 45:  OTU_779 Bacteria   Bacteroidetes           Bacteroidia
## 46:  OTU_543 Bacteria  Actinobacteria        Actinobacteria
## 47:   OTU_75 Bacteria  Proteobacteria   Gammaproteobacteria
##          OTU   domain          phylum                 class
##                  order              family             genus
##  1:    Burkholderiales      Comamonadaceae        Variovorax
##  2:                                                         
##  3:    Actinomycetales Geodermatophilaceae      Blastococcus
##  4:    Pseudomonadales    Pseudomonadaceae       Pseudomonas
##  5:   [Pedosphaerales]            Ellin517                  
##  6:   Planctomycetales   Planctomycetaceae      Planctomyces
##  7:  Bdellovibrionales  Bdellovibrionaceae      Bdellovibrio
##  8:    Actinomycetales   Cellulomonadaceae         Demequina
##  9:  Bdellovibrionales  Bdellovibrionaceae      Bdellovibrio
## 10:              MIZ46                                      
## 11:    Alteromonadales    Alteromonadaceae        Cellvibrio
## 12:        Rhizobiales Methylobacteriaceae  Methylobacterium
## 13:    Methylophilales    Methylophilaceae     Methylotenera
## 14:    Burkholderiales      Comamonadaceae    Hydrogenophaga
## 15:   Rhodospirillales    Acetobacteraceae                  
## 16:    Burkholderiales    Oxalobacteraceae Janthinobacterium
## 17:      Chroococcales       Xenococcaceae                  
## 18:      Bacteroidales      Bacteroidaceae       Bacteroides
## 19:                                                         
## 20:      Thiotrichales      Thiotrichaceae                  
## 21:    Rhodobacterales     Hyphomonadaceae                  
## 22:    Burkholderiales      Comamonadaceae        Rhodoferax
## 23:    Lactobacillales     Enterococcaceae      Enterococcus
## 24: Sphingobacteriales                                      
## 25:       Neisseriales       Neisseriaceae         Neisseria
## 26:          PHOS-HD29                                      
## 27:    Pseudomonadales       Moraxellaceae     Acinetobacter
## 28:   Sphingomonadales   Sphingomonadaceae      Kaistobacter
## 29:    Alteromonadales    Alteromonadaceae                  
## 30:    [Saprospirales]    Chitinophagaceae Sediminibacterium
## 31:        Rhizobiales   Hyphomicrobiaceae    Hyphomicrobium
## 32:    Burkholderiales    Oxalobacteraceae Janthinobacterium
## 33:    Lactobacillales     Enterococcaceae      Enterococcus
## 34:         Bacillales         Bacillaceae     Anoxybacillus
## 35:      Clostridiales   [Tissierellaceae]      Anaerococcus
## 36:   Flavobacteriales     [Weeksellaceae]                  
## 37:    Actinomycetales    Actinomycetaceae               N09
## 38:  Acholeplasmatales  Acholeplasmataceae        Candidatus
## 39:    Pseudomonadales       Moraxellaceae     Acinetobacter
## 40:    [Saprospirales]                                      
## 41:               RB41           Ellin6075                  
## 42:    Pseudomonadales    Pseudomonadaceae       Pseudomonas
## 43:     Pasteurellales     Pasteurellaceae       Haemophilus
## 44:    Burkholderiales    Oxalobacteraceae                  
## 45:      Bacteroidales      Bacteroidaceae       Bacteroides
## 46:  Bifidobacteriales  Bifidobacteriaceae   Bifidobacterium
## 47:    Pseudomonadales       Moraxellaceae         Moraxella
##                  order              family             genus</code></pre>
<pre class="r"><code>plot(complete_caged_positive_communities, gr_complete_caged_positive, 
     layout = layout.fruchterman.reingold(gr_complete_caged_positive),
     rescaled = TRUE,
     vertex.size = 2, 
     vertex.label = NA
     )</code></pre>
<p><img src="bacteria_community_analysis_files/figure-html/ccp.1-1.png" width="672" /></p>
<p>Modularity:</p>
<pre class="r"><code>(ccp.mod &lt;- modularity(gr_complete_caged_positive, membership(complete_caged_positive_communities)))</code></pre>
<pre><code>## [1] 0.3459842</code></pre>
</div>
<div id="negative-weights-5" class="section level3">
<h3>Negative Weights</h3>
<pre class="r"><code>complete_caged_negative &lt;- complete_negative_weights[treatment == &quot;Caged&quot;]
complete_caged_negative &lt;- complete_caged_negative[, -1]
complete_caged_negative[[3]] &lt;- abs(complete_caged_negative[[3]])
gr_complete_caged_negative &lt;- graph.data.frame(complete_caged_negative, directed = FALSE)
complete_caged_negative_communities &lt;- cluster_fast_greedy(gr_complete_caged_negative, 
                                                           weights = E(gr_complete_caged_negative)$rho)

hot_otus &lt;- vector()
for (community in communities(complete_caged_negative_communities))
{
  sub_graph &lt;- induced.subgraph(graph = gr_complete_caged_negative, 
                                    v = community, impl = &quot;auto&quot;)
  highest_degree_otu &lt;- V(sub_graph)[which.max(degree(sub_graph))]$name
  hot_otus &lt;- c(hot_otus, highest_degree_otu)
  print(paste(&quot;Highest degree OTU was&quot;, highest_degree_otu, &quot;(degree =&quot;,  
              degree(sub_graph, highest_degree_otu), &quot;):&quot;))
  print(taxa[OTU == highest_degree_otu])
        
  print(paste(&quot;Other OTUs in the same community as&quot;, highest_degree_otu, &quot;:&quot;))
  print(taxa[OTU %in% community])
}</code></pre>
<pre><code>## [1] &quot;Highest degree OTU was OTU_5302 (degree = 3 ):&quot;
##         OTU   domain         phylum               class         order
## 1: OTU_5302 Bacteria Proteobacteria Alphaproteobacteria Rickettsiales
##          family genus
## 1: mitochondria      
## [1] &quot;Other OTUs in the same community as OTU_5302 :&quot;
##         OTU   domain         phylum               class            order
## 1: OTU_5302 Bacteria Proteobacteria Alphaproteobacteria    Rickettsiales
## 2: OTU_4227 Bacteria Proteobacteria Alphaproteobacteria    Rickettsiales
## 3: OTU_5702 Bacteria Proteobacteria  Betaproteobacteria    Rhodocyclales
## 4:  OTU_233 Bacteria     Firmicutes             Bacilli       Bacillales
## 5:    OTU_8 Bacteria Proteobacteria Alphaproteobacteria Rhodospirillales
## 6:    OTU_9 Bacteria Proteobacteria Gammaproteobacteria  Pseudomonadales
## 7:    OTU_6 Bacteria Proteobacteria Gammaproteobacteria  Pseudomonadales
## 8:    OTU_7 Bacteria  Bacteroidetes      Flavobacteriia Flavobacteriales
##              family           genus
## 1:     mitochondria                
## 2:     mitochondria                
## 3:   Rhodocyclaceae   Dechloromonas
## 4: Paenibacillaceae   Paenibacillus
## 5: Acetobacteraceae   Gluconobacter
## 6: Pseudomonadaceae     Pseudomonas
## 7:    Moraxellaceae   Acinetobacter
## 8:  [Weeksellaceae] Cloacibacterium
## [1] &quot;Highest degree OTU was OTU_21 (degree = 4 ):&quot;
##       OTU   domain         phylum               class           order
## 1: OTU_21 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##              family       genus
## 1: Pseudomonadaceae Pseudomonas
## [1] &quot;Other OTUs in the same community as OTU_21 :&quot;
##          OTU   domain         phylum               class             order
##  1:   OTU_21 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##  2:   OTU_22 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##  3:   OTU_44 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##  4: OTU_5289 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
##  5: OTU_3492 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
##  6:  OTU_164 Bacteria     Firmicutes             Bacilli        Bacillales
##  7: OTU_4004 Bacteria  Bacteroidetes       [Saprospirae]   [Saprospirales]
##  8: OTU_5806 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
##  9:  OTU_172 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 10: OTU_4218 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 11: OTU_5098 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##                 family             genus
##  1:   Pseudomonadaceae       Pseudomonas
##  2:     Comamonadaceae        Variovorax
##  3:   Pseudomonadaceae       Pseudomonas
##  4:       mitochondria                  
##  5: Enterobacteriaceae           Erwinia
##  6:   Paenibacillaceae     Paenibacillus
##  7:   Chitinophagaceae Sediminibacterium
##  8: Enterobacteriaceae                  
##  9:     Comamonadaceae        Rhodoferax
## 10:     Comamonadaceae        Rhodoferax
## 11:     Comamonadaceae         Comamonas
## [1] &quot;Highest degree OTU was OTU_5 (degree = 15 ):&quot;
##      OTU   domain         phylum               class         order
## 1: OTU_5 Bacteria Proteobacteria Alphaproteobacteria Rickettsiales
##          family genus
## 1: mitochondria      
## [1] &quot;Other OTUs in the same community as OTU_5 :&quot;
##          OTU   domain          phylum               class
##  1:   OTU_42 Bacteria   Bacteroidetes          Cytophagia
##  2: OTU_1205 Bacteria Verrucomicrobia    [Spartobacteria]
##  3: OTU_3733 Bacteria  Proteobacteria Alphaproteobacteria
##  4:    OTU_5 Bacteria  Proteobacteria Alphaproteobacteria
##  5: OTU_3505 Bacteria  Proteobacteria Gammaproteobacteria
##  6:  OTU_110 Bacteria  Proteobacteria Alphaproteobacteria
##  7: OTU_5838 Bacteria  Proteobacteria Alphaproteobacteria
##  8: OTU_3986 Bacteria  Proteobacteria Gammaproteobacteria
##  9: OTU_5616 Bacteria  Proteobacteria  Betaproteobacteria
## 10: OTU_5834 Bacteria  Proteobacteria Gammaproteobacteria
## 11:  OTU_148 Bacteria Verrucomicrobia      [Pedosphaerae]
## 12:  OTU_156 Bacteria  Proteobacteria  Betaproteobacteria
## 13:   OTU_43 Bacteria  Proteobacteria  Betaproteobacteria
## 14:  OTU_260 Bacteria  Proteobacteria Gammaproteobacteria
## 15: OTU_5939 Bacteria  Proteobacteria Gammaproteobacteria
## 16:    OTU_3 Bacteria  Proteobacteria Gammaproteobacteria
##                    order                family            genus
##  1:         Cytophagales         Cytophagaceae                 
##  2: [Chthoniobacterales] [Chthoniobacteraceae]                 
##  3:     Sphingomonadales     Sphingomonadaceae     Sphingomonas
##  4:        Rickettsiales          mitochondria                 
##  5:    Enterobacteriales    Enterobacteriaceae          Erwinia
##  6:          Rhizobiales    Phyllobacteriaceae                 
##  7:     Sphingomonadales     Sphingomonadaceae     Sphingomonas
##  8:      Pseudomonadales         Moraxellaceae    Acinetobacter
##  9:      Burkholderiales        Comamonadaceae        Comamonas
## 10:      Pseudomonadales         Moraxellaceae    Acinetobacter
## 11:     [Pedosphaerales]             auto67_4W                 
## 12:      Burkholderiales      Oxalobacteraceae Polynucleobacter
## 13:      Burkholderiales      Oxalobacteraceae      Cupriavidus
## 14:    Oceanospirillales        Halomonadaceae        Kushneria
## 15:    Enterobacteriales    Enterobacteriaceae       Klebsiella
## 16:    Enterobacteriales    Enterobacteriaceae          Erwinia
## [1] &quot;Highest degree OTU was OTU_4161 (degree = 3 ):&quot;
##         OTU   domain         phylum               class         order
## 1: OTU_4161 Bacteria Proteobacteria Alphaproteobacteria Rickettsiales
##          family genus
## 1: mitochondria      
## [1] &quot;Other OTUs in the same community as OTU_4161 :&quot;
##         OTU   domain         phylum               class            order
## 1:   OTU_64 Bacteria Proteobacteria Gammaproteobacteria  Pseudomonadales
## 2:   OTU_20 Bacteria Proteobacteria Gammaproteobacteria  Pseudomonadales
## 3:   OTU_28 Bacteria  Bacteroidetes      Flavobacteriia Flavobacteriales
## 4: OTU_4161 Bacteria Proteobacteria Alphaproteobacteria    Rickettsiales
## 5:  OTU_267 Bacteria     Firmicutes             Bacilli       Bacillales
##              family            genus
## 1: Pseudomonadaceae                 
## 2:    Moraxellaceae    Acinetobacter
## 3:  [Weeksellaceae] Chryseobacterium
## 4:     mitochondria                 
## 5: Paenibacillaceae    Paenibacillus
## [1] &quot;Highest degree OTU was OTU_5629 (degree = 1 ):&quot;
##         OTU   domain         phylum               class             order
## 1: OTU_5629 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
##                family genus
## 1: Enterobacteriaceae      
## [1] &quot;Other OTUs in the same community as OTU_5629 :&quot;
##         OTU   domain         phylum               class             order
## 1: OTU_5629 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 2: OTU_4938 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
##                family genus
## 1: Enterobacteriaceae      
## 2:       mitochondria      
## [1] &quot;Highest degree OTU was OTU_5553 (degree = 1 ):&quot;
##         OTU   domain         phylum               class         order
## 1: OTU_5553 Bacteria Proteobacteria Alphaproteobacteria Rickettsiales
##          family genus
## 1: mitochondria      
## [1] &quot;Other OTUs in the same community as OTU_5553 :&quot;
##         OTU   domain         phylum               class           order
## 1: OTU_5498 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
## 2: OTU_5553 Bacteria Proteobacteria Alphaproteobacteria   Rickettsiales
##            family      genus
## 1: Comamonadaceae Roseateles
## 2:   mitochondria           
## [1] &quot;Highest degree OTU was OTU_225 (degree = 1 ):&quot;
##        OTU   domain         phylum               class           order
## 1: OTU_225 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##           family         genus
## 1: Moraxellaceae Acinetobacter
## [1] &quot;Other OTUs in the same community as OTU_225 :&quot;
##         OTU   domain         phylum               class             order
## 1: OTU_2168 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 2:  OTU_225 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##                family         genus
## 1: Enterobacteriaceae  Enterobacter
## 2:      Moraxellaceae Acinetobacter</code></pre>
<pre class="r"><code>plot(complete_caged_negative_communities, gr_complete_caged_negative, 
     layout = layout.fruchterman.reingold(gr_complete_caged_negative),
     rescaled = TRUE,
     vertex.size = 2, 
     vertex.label = NA
     )</code></pre>
<p><img src="bacteria_community_analysis_files/figure-html/ccn.1-1.png" width="672" /></p>
<p>Modularity:</p>
<pre class="r"><code>(ccn.mod &lt;- modularity(gr_complete_caged_negative, membership(complete_caged_negative_communities)))</code></pre>
<pre><code>## [1] 0.5346</code></pre>
</div>
</div>
<div id="bagged-communities-1" class="section level2">
<h2>Bagged Communities</h2>
<div id="positive-weights-6" class="section level3">
<h3>Positive Weights</h3>
<pre class="r"><code>complete_bagged_positive &lt;- complete_positive_weights[treatment == &quot;Bagged&quot;]
complete_bagged_positive &lt;- complete_bagged_positive[, -1]
gr_complete_bagged_positive &lt;- graph.data.frame(complete_bagged_positive, directed = FALSE)
complete_bagged_positive_communities &lt;- cluster_fast_greedy(gr_complete_bagged_positive, 
                                                           weights = E(gr_complete_bagged_positive)$rho)

hot_otus &lt;- vector()
for (community in communities(complete_bagged_positive_communities))
{
  sub_graph &lt;- induced.subgraph(graph = gr_complete_bagged_positive, 
                                    v = community, impl = &quot;auto&quot;)
  highest_degree_otu &lt;- V(sub_graph)[which.max(degree(sub_graph))]$name
  hot_otus &lt;- c(hot_otus, highest_degree_otu)
  print(paste(&quot;Highest degree OTU was&quot;, highest_degree_otu, &quot;(degree =&quot;,  
              degree(sub_graph, highest_degree_otu), &quot;):&quot;))
  print(taxa[OTU == highest_degree_otu])
        
  print(paste(&quot;Other OTUs in the same community as&quot;, highest_degree_otu, &quot;:&quot;))
  print(taxa[OTU %in% community])
}</code></pre>
<pre><code>## [1] &quot;Highest degree OTU was OTU_4218 (degree = 29 ):&quot;
##         OTU   domain         phylum              class           order
## 1: OTU_4218 Bacteria Proteobacteria Betaproteobacteria Burkholderiales
##            family      genus
## 1: Comamonadaceae Rhodoferax
## [1] &quot;Other OTUs in the same community as OTU_4218 :&quot;
##          OTU   domain          phylum                 class
##  1: OTU_3434 Bacteria  Proteobacteria Epsilonproteobacteria
##  2:  OTU_699 Bacteria  Proteobacteria   Alphaproteobacteria
##  3:  OTU_421 Bacteria   Cyanobacteria Oscillatoriophycideae
##  4: OTU_5135 Bacteria  Proteobacteria    Betaproteobacteria
##  5: OTU_1018 Bacteria  Proteobacteria   Alphaproteobacteria
##  6: OTU_3932 Bacteria  Proteobacteria   Alphaproteobacteria
##  7:  OTU_610 Bacteria  Proteobacteria   Deltaproteobacteria
##  8: OTU_3128 Bacteria  Proteobacteria    Betaproteobacteria
##  9:   OTU_29 Bacteria  Proteobacteria    Betaproteobacteria
## 10:   OTU_28 Bacteria   Bacteroidetes        Flavobacteriia
## 11:  OTU_609 Bacteria  Actinobacteria        Actinobacteria
## 12:  OTU_282 Bacteria Verrucomicrobia      Verrucomicrobiae
## 13: OTU_5238 Bacteria  Proteobacteria   Alphaproteobacteria
## 14:  OTU_964 Bacteria  Proteobacteria   Deltaproteobacteria
## 15: OTU_1425 Bacteria  Actinobacteria        Actinobacteria
## 16: OTU_1632 Bacteria  Proteobacteria Epsilonproteobacteria
## 17:  OTU_653 Bacteria   Bacteroidetes            Cytophagia
## 18:  OTU_349 Bacteria  Proteobacteria   Deltaproteobacteria
## 19:    OTU_5 Bacteria  Proteobacteria   Alphaproteobacteria
## 20: OTU_1477 Bacteria  Proteobacteria    Betaproteobacteria
## 21:  OTU_367 Bacteria             SR1                      
## 22: OTU_3721 Bacteria  Proteobacteria    Betaproteobacteria
## 23:  OTU_375 Bacteria    Spirochaetes          Spirochaetes
## 24:  OTU_371       No           blast                   hit
## 25:  OTU_303 Bacteria      Firmicutes            Clostridia
## 26: OTU_2169 Bacteria   Acidobacteria          Solibacteres
## 27:  OTU_172 Bacteria  Proteobacteria    Betaproteobacteria
## 28:  OTU_313 Bacteria   Bacteroidetes            Cytophagia
## 29: OTU_4218 Bacteria  Proteobacteria    Betaproteobacteria
## 30: OTU_2244 Bacteria  Proteobacteria   Deltaproteobacteria
## 31: OTU_5872 Bacteria  Proteobacteria    Betaproteobacteria
## 32: OTU_5879 Bacteria  Proteobacteria   Alphaproteobacteria
## 33: OTU_4227 Bacteria  Proteobacteria   Alphaproteobacteria
## 34: OTU_1302 Bacteria  Proteobacteria   Alphaproteobacteria
## 35: OTU_5664 Bacteria   Bacteroidetes        Flavobacteriia
## 36:  OTU_193 Bacteria  Actinobacteria       Thermoleophilia
## 37:  OTU_277 Bacteria   Bacteroidetes      Sphingobacteriia
## 38: OTU_1741 Bacteria      Firmicutes               Bacilli
## 39:  OTU_928 Bacteria  Proteobacteria   Alphaproteobacteria
## 40: OTU_5553 Bacteria  Proteobacteria   Alphaproteobacteria
## 41: OTU_3006 Bacteria  Proteobacteria   Gammaproteobacteria
## 42:  OTU_238 Bacteria  Proteobacteria   Alphaproteobacteria
## 43: OTU_4719 Bacteria  Proteobacteria    Betaproteobacteria
## 44: OTU_3824 Bacteria  Proteobacteria   Alphaproteobacteria
## 45: OTU_5710 Bacteria  Proteobacteria    Betaproteobacteria
## 46: OTU_5972 Bacteria  Proteobacteria    Betaproteobacteria
## 47: OTU_4895 Bacteria  Proteobacteria    Betaproteobacteria
## 48: OTU_2734 Bacteria Armatimonadetes      [Fimbriimonadia]
## 49:  OTU_218 Bacteria   Acidobacteria  [Chloracidobacteria]
## 50:  OTU_969 Bacteria  Proteobacteria   Alphaproteobacteria
## 51: OTU_4482 Bacteria  Proteobacteria    Betaproteobacteria
## 52: OTU_5771 Bacteria  Proteobacteria    Betaproteobacteria
## 53: OTU_2746 Bacteria  Actinobacteria        Actinobacteria
## 54:   OTU_27 Bacteria      Firmicutes               Bacilli
## 55: OTU_1759 Bacteria  Proteobacteria   Alphaproteobacteria
## 56: OTU_3979 Bacteria  Proteobacteria    Betaproteobacteria
##          OTU   domain          phylum                 class
##                   order                family              genus
##  1:   Campylobacterales    Campylobacteraceae         Arcobacter
##  2:         Rhizobiales     Hyphomicrobiaceae                   
##  3:       Chroococcales         Xenococcaceae  Chroococcidiopsis
##  4:     Burkholderiales        Comamonadaceae                   
##  5:     Rhodobacterales       Hyphomonadaceae                   
##  6:    Sphingomonadales     Sphingomonadaceae       Sphingomonas
##  7:               MIZ46                                         
##  8:     Burkholderiales      Oxalobacteraceae                   
##  9:        Neisseriales         Neisseriaceae                   
## 10:    Flavobacteriales       [Weeksellaceae]   Chryseobacterium
## 11:     Actinomycetales    Corynebacteriaceae    Corynebacterium
## 12:  Verrucomicrobiales   Verrucomicrobiaceae                   
## 13:    Sphingomonadales     Sphingomonadaceae    Novosphingobium
## 14:        Myxococcales                                         
## 15:     Actinomycetales Promicromonosporaceae Cellulosimicrobium
## 16:   Campylobacterales     Helicobacteraceae                   
## 17:        Cytophagales         Cytophagaceae          Emticicia
## 18:               MIZ46                                         
## 19:       Rickettsiales          mitochondria                   
## 20:           Ellin6067                                         
## 21:                                                             
## 22:     Burkholderiales      Oxalobacteraceae  Janthinobacterium
## 23:      Spirochaetales       Spirochaetaceae        Spirochaeta
## 24:                                                             
## 25:       Clostridiales Peptostreptococcaceae                   
## 26:      Solibacterales                                         
## 27:     Burkholderiales        Comamonadaceae         Rhodoferax
## 28:        Cytophagales         Cytophagaceae       Hymenobacter
## 29:     Burkholderiales        Comamonadaceae         Rhodoferax
## 30:               MIZ46                                         
## 31:     Burkholderiales        Comamonadaceae                   
## 32:         Rhizobiales                                         
## 33:       Rickettsiales          mitochondria                   
## 34:         Rhizobiales     Hyphomicrobiaceae            Devosia
## 35:    Flavobacteriales     Flavobacteriaceae     Flavobacterium
## 36: Solirubrobacterales     Patulibacteraceae                   
## 37:  Sphingobacteriales   Sphingobacteriaceae         Pedobacter
## 38:     Lactobacillales      Lactobacillaceae      Lactobacillus
## 39:         Rhizobiales     Hyphomicrobiaceae     Hyphomicrobium
## 40:       Rickettsiales          mitochondria                   
## 41:     Xanthomonadales      Xanthomonadaceae                   
## 42:         Rhizobiales          Rhizobiaceae         Candidatus
## 43:     Burkholderiales        Comamonadaceae                   
## 44:    Sphingomonadales     Sphingomonadaceae       Sphingomonas
## 45:     Burkholderiales        Comamonadaceae         Rhodoferax
## 46:     Burkholderiales        Comamonadaceae      Limnohabitans
## 47:     Burkholderiales        Comamonadaceae         Acidovorax
## 48:  [Fimbriimonadales]   [Fimbriimonadaceae]                   
## 49:                RB41             Ellin6075                   
## 50:    Sphingomonadales     Sphingomonadaceae       Kaistobacter
## 51:     Burkholderiales        Comamonadaceae      Limnohabitans
## 52:     Burkholderiales        Comamonadaceae                   
## 53:     Actinomycetales        Micrococcaceae       Arthrobacter
## 54:     Lactobacillales      Streptococcaceae      Streptococcus
## 55:       Rickettsiales          mitochondria                   
## 56:     Burkholderiales        Comamonadaceae      Limnohabitans
##                   order                family              genus
## [1] &quot;Highest degree OTU was OTU_5745 (degree = 75 ):&quot;
##         OTU   domain         phylum              class           order
## 1: OTU_5745 Bacteria Proteobacteria Betaproteobacteria Burkholderiales
##            family genus
## 1: Comamonadaceae      
## [1] &quot;Other OTUs in the same community as OTU_5745 :&quot;
##           OTU   domain         phylum               class           order
##   1: OTU_3426 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
##   2:  OTU_435 Bacteria Actinobacteria      Actinobacteria Actinomycetales
##   3: OTU_1159 Bacteria     Firmicutes             Bacilli Lactobacillales
##   4: OTU_3883 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
##   5: OTU_5709 Bacteria Proteobacteria  Betaproteobacteria   Rhodocyclales
##  ---                                                                     
## 109: OTU_4508 Bacteria Proteobacteria Alphaproteobacteria   Rickettsiales
## 110: OTU_5038 Bacteria Proteobacteria  Betaproteobacteria   Rhodocyclales
## 111: OTU_3174 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
## 112:   OTU_78 Bacteria Proteobacteria Gammaproteobacteria Xanthomonadales
## 113:   OTU_74 Bacteria Actinobacteria      Actinobacteria Actinomycetales
##                    family             genus
##   1:       Comamonadaceae                  
##   2:       Micrococcaceae           Kocuria
##   3:        Aerococcaceae         Facklamia
##   4:       Comamonadaceae         Comamonas
##   5:       Rhodocyclaceae          Zoogloea
##  ---                                       
## 109:         mitochondria                  
## 110:       Rhodocyclaceae     Dechloromonas
## 111:     Pseudomonadaceae       Pseudomonas
## 112:     Xanthomonadaceae                  
## 113: Propionibacteriaceae Propionibacterium
## [1] &quot;Highest degree OTU was OTU_5870 (degree = 36 ):&quot;
## Empty data.table (0 rows) of 7 cols: OTU,domain,phylum,class,order,family...
## [1] &quot;Other OTUs in the same community as OTU_5870 :&quot;
##          OTU   domain          phylum                 class
##  1:   OTU_26 Bacteria  Proteobacteria    Betaproteobacteria
##  2: OTU_1002 Bacteria  Actinobacteria       Thermoleophilia
##  3: OTU_3930 Bacteria  Proteobacteria   Alphaproteobacteria
##  4:   OTU_47 Bacteria  Actinobacteria        Actinobacteria
##  5: OTU_1786 Bacteria Verrucomicrobia        [Pedosphaerae]
##  6:  OTU_990 Bacteria   Bacteroidetes      Sphingobacteriia
##  7:  OTU_444 Bacteria  Proteobacteria   Deltaproteobacteria
##  8:  OTU_445 Bacteria  Proteobacteria                  TA18
##  9:  OTU_743 Bacteria   Bacteroidetes         [Saprospirae]
## 10:   OTU_32 Bacteria  Proteobacteria   Gammaproteobacteria
## 11:  OTU_466 Bacteria  Proteobacteria   Deltaproteobacteria
## 12:  OTU_464 Bacteria  Proteobacteria   Deltaproteobacteria
## 13: OTU_5454 Bacteria  Proteobacteria   Gammaproteobacteria
## 14: OTU_1228 Bacteria  Proteobacteria   Alphaproteobacteria
## 15: OTU_1399 Bacteria  Planctomycetes        Planctomycetia
## 16:  OTU_122 Bacteria   Bacteroidetes      Sphingobacteriia
## 17: OTU_3429 Bacteria  Proteobacteria   Gammaproteobacteria
## 18:  OTU_139 Bacteria  Actinobacteria        Actinobacteria
## 19:  OTU_359 Bacteria             OD1                   ZB2
## 20: OTU_1476 Bacteria   Cyanobacteria Oscillatoriophycideae
## 21: OTU_3510 Bacteria  Proteobacteria   Alphaproteobacteria
## 22:  OTU_582 Bacteria  Proteobacteria   Alphaproteobacteria
## 23: OTU_5600 Bacteria  Proteobacteria   Alphaproteobacteria
## 24:  OTU_596 Bacteria   Bacteroidetes      Sphingobacteriia
## 25:  OTU_973 Bacteria    Spirochaetes          Spirochaetes
## 26:  OTU_786 Bacteria  Proteobacteria    Betaproteobacteria
## 27: OTU_1631 Bacteria  Proteobacteria   Alphaproteobacteria
## 28:  OTU_158 Bacteria  Proteobacteria   Deltaproteobacteria
## 29: OTU_5780 Bacteria  Proteobacteria   Alphaproteobacteria
## 30: OTU_1552 Bacteria     Chloroflexi             Ellin6529
## 31: OTU_4222 Bacteria  Proteobacteria   Alphaproteobacteria
## 32:  OTU_412 Bacteria  Actinobacteria        Actinobacteria
## 33: OTU_1762 Bacteria  Proteobacteria   Alphaproteobacteria
## 34: OTU_3269 Bacteria  Proteobacteria   Alphaproteobacteria
## 35: OTU_4059 Bacteria  Proteobacteria   Gammaproteobacteria
## 36: OTU_3061 Bacteria   Bacteroidetes         [Saprospirae]
## 37:  OTU_250 Bacteria   Bacteroidetes      Sphingobacteriia
## 38: OTU_1454 Bacteria  Proteobacteria Epsilonproteobacteria
## 39: OTU_1717 Bacteria  Actinobacteria        Actinobacteria
## 40: OTU_3688 Bacteria  Proteobacteria    Betaproteobacteria
## 41:    OTU_9 Bacteria  Proteobacteria   Gammaproteobacteria
## 42: OTU_2748 Bacteria   Bacteroidetes           Bacteroidia
## 43: OTU_1416 Bacteria      Firmicutes               Bacilli
## 44: OTU_4577 Bacteria  Proteobacteria   Alphaproteobacteria
## 45:   OTU_90 Bacteria  Proteobacteria    Betaproteobacteria
## 46: OTU_1055 Bacteria    Fusobacteria         Fusobacteriia
## 47:  OTU_355 Bacteria  Proteobacteria   Gammaproteobacteria
## 48:  OTU_824 Bacteria  Proteobacteria   Alphaproteobacteria
## 49:  OTU_403 Bacteria  Actinobacteria        Actinobacteria
## 50: OTU_1934 Bacteria  Proteobacteria   Alphaproteobacteria
##          OTU   domain          phylum                 class
##                   order              family             genus
##  1:                                                          
##  2: Solirubrobacterales                                      
##  3:         Rhizobiales   Bradyrhizobiaceae                  
##  4:     Actinomycetales  Corynebacteriaceae   Corynebacterium
##  5:    [Pedosphaerales]            Ellin517                  
##  6:  Sphingobacteriales Sphingobacteriaceae                  
##  7:   Bdellovibrionales  Bdellovibrionaceae      Bdellovibrio
##  8:           PHOS-HD29                                      
##  9:     [Saprospirales]    Chitinophagaceae                  
## 10:   Enterobacteriales  Enterobacteriaceae                  
## 11:  Desulfuromonadales      Geobacteraceae         Geobacter
## 12:   Bdellovibrionales  Bdellovibrionaceae      Bdellovibrio
## 13:     Xanthomonadales    Xanthomonadaceae                  
## 14:    Rhodospirillales    Acetobacteraceae        Roseomonas
## 15:          Gemmatales      Isosphaeraceae                  
## 16:  Sphingobacteriales                                      
## 17:   Enterobacteriales  Enterobacteriaceae           Erwinia
## 18:     Actinomycetales              ACK-M1                  
## 19:                                                          
## 20:       Chroococcales       Xenococcaceae                  
## 21:    Sphingomonadales   Sphingomonadaceae                  
## 22:     Caulobacterales    Caulobacteraceae                  
## 23:       Rickettsiales        mitochondria                  
## 24:  Sphingobacteriales                                      
## 25:      Spirochaetales     Spirochaetaceae         Treponema
## 26:     Burkholderiales      Comamonadaceae                  
## 27:         Rhizobiales Methylobacteriaceae                  
## 28:        Myxococcales                                      
## 29:       Rickettsiales        mitochondria                  
## 30:                                                          
## 31:       Rickettsiales        mitochondria                  
## 32:     Actinomycetales   Brevibacteriaceae    Brevibacterium
## 33:    Sphingomonadales   Sphingomonadaceae      Sphingomonas
## 34:    Sphingomonadales   Sphingomonadaceae      Sphingomonas
## 35:     Pseudomonadales    Pseudomonadaceae       Pseudomonas
## 36:     [Saprospirales]    Chitinophagaceae Sediminibacterium
## 37:  Sphingobacteriales                                      
## 38:   Campylobacterales   Helicobacteraceae     Sulfuricurvum
## 39:     Actinomycetales     Nocardioidaceae      Nocardioides
## 40:       Rhodocyclales      Rhodocyclaceae               C39
## 41:     Pseudomonadales    Pseudomonadaceae       Pseudomonas
## 42:       Bacteroidales      Bacteroidaceae       Bacteroides
## 43:          Bacillales    Paenibacillaceae     Paenibacillus
## 44:     Rhodobacterales    Rhodobacteraceae  Rubellimicrobium
## 45:     Burkholderiales      Alcaligenaceae     Achromobacter
## 46:     Fusobacteriales                                      
## 47:   Oceanospirillales      Halomonadaceae         Halomonas
## 48:         Rhizobiales    Methylocystaceae                  
## 49:     Actinomycetales     Nocardioidaceae                  
## 50:       Rickettsiales        mitochondria                  
##                   order              family             genus
## [1] &quot;Highest degree OTU was OTU_233 (degree = 49 ):&quot;
##        OTU   domain     phylum   class      order           family
## 1: OTU_233 Bacteria Firmicutes Bacilli Bacillales Paenibacillaceae
##            genus
## 1: Paenibacillus
## [1] &quot;Other OTUs in the same community as OTU_233 :&quot;
##           OTU   domain         phylum               class
##   1: OTU_1035 Bacteria  Bacteroidetes    Sphingobacteriia
##   2:   OTU_65 Bacteria Proteobacteria Alphaproteobacteria
##   3:   OTU_64 Bacteria Proteobacteria Gammaproteobacteria
##   4:   OTU_21 Bacteria Proteobacteria Gammaproteobacteria
##   5: OTU_2057 Bacteria Proteobacteria Gammaproteobacteria
##  ---                                                     
## 107: OTU_3187 Bacteria Proteobacteria Alphaproteobacteria
## 108: OTU_3181 Bacteria Actinobacteria      Actinobacteria
## 109: OTU_1530 Bacteria Proteobacteria Alphaproteobacteria
## 110: OTU_5743 Bacteria Proteobacteria Alphaproteobacteria
## 111: OTU_2229 Bacteria Proteobacteria Alphaproteobacteria
##                   order              family            genus
##   1: Sphingobacteriales Sphingobacteriaceae Sphingobacterium
##   2:   Sphingomonadales   Sphingomonadaceae     Sphingomonas
##   3:    Pseudomonadales    Pseudomonadaceae                 
##   4:    Pseudomonadales    Pseudomonadaceae      Pseudomonas
##   5:    Xanthomonadales     Sinobacteraceae                 
##  ---                                                        
## 107:        Rhizobiales   Hyphomicrobiaceae          Devosia
## 108:    Actinomycetales  Corynebacteriaceae  Corynebacterium
## 109:    Caulobacterales    Caulobacteraceae                 
## 110:   Sphingomonadales   Sphingomonadaceae     Sphingomonas
## 111:    Rhodobacterales    Rhodobacteraceae Rubellimicrobium
## [1] &quot;Highest degree OTU was OTU_88 (degree = 43 ):&quot;
##       OTU   domain         phylum              class           order
## 1: OTU_88 Bacteria Proteobacteria Betaproteobacteria Burkholderiales
##              family genus
## 1: Oxalobacteraceae      
## [1] &quot;Other OTUs in the same community as OTU_88 :&quot;
##           OTU   domain         phylum               class            order
##   1: OTU_4337 Bacteria Proteobacteria Gammaproteobacteria  Pseudomonadales
##   2: OTU_3169 Bacteria Actinobacteria      Actinobacteria  Actinomycetales
##   3: OTU_3781 Bacteria  Bacteroidetes          Cytophagia     Cytophagales
##   4:   OTU_66 Bacteria Proteobacteria Alphaproteobacteria Rhodospirillales
##   5:   OTU_22 Bacteria Proteobacteria  Betaproteobacteria  Burkholderiales
##  ---                                                                      
## 122: OTU_4071 Bacteria Actinobacteria      Actinobacteria  Actinomycetales
## 123: OTU_5443 Bacteria Proteobacteria  Betaproteobacteria  Burkholderiales
## 124:  OTU_779 Bacteria  Bacteroidetes         Bacteroidia    Bacteroidales
## 125:  OTU_132 Bacteria Proteobacteria Deltaproteobacteria     Myxococcales
## 126: OTU_2595 Bacteria Proteobacteria Gammaproteobacteria  Pseudomonadales
##                    family             genus
##   1:        Moraxellaceae     Acinetobacter
##   2: Propionibacteriaceae Propionibacterium
##   3:        Cytophagaceae    Flectobacillus
##   4:     Acetobacteraceae     Swaminathania
##   5:       Comamonadaceae        Variovorax
##  ---                                       
## 122:                                       
## 123:     Oxalobacteraceae                  
## 124:       Bacteroidaceae       Bacteroides
## 125:            0319-6G20                  
## 126:        Moraxellaceae     Acinetobacter
## [1] &quot;Highest degree OTU was OTU_1082 (degree = 76 ):&quot;
##         OTU   domain        phylum          class            order
## 1: OTU_1082 Bacteria Bacteroidetes Flavobacteriia Flavobacteriales
##             family genus
## 1: [Weeksellaceae]      
## [1] &quot;Other OTUs in the same community as OTU_1082 :&quot;
##           OTU   domain         phylum               class            order
##   1: OTU_3425 Bacteria Proteobacteria  Betaproteobacteria  Burkholderiales
##   2:  OTU_433 Bacteria Actinobacteria      Actinobacteria  Actinomycetales
##   3:  OTU_434 Bacteria Proteobacteria Alphaproteobacteria    Rickettsiales
##   4: OTU_3884 Bacteria Proteobacteria  Betaproteobacteria  Burkholderiales
##   5:   OTU_60 Bacteria  Bacteroidetes      Flavobacteriia Flavobacteriales
##  ---                                                                      
## 106:  OTU_409 Bacteria     Firmicutes          Clostridia    Clostridiales
## 107: OTU_1028 Bacteria Proteobacteria Alphaproteobacteria Sphingomonadales
## 108: OTU_2220 Bacteria Actinobacteria      Actinobacteria  Actinomycetales
## 109: OTU_5257 Bacteria Proteobacteria  Betaproteobacteria  Burkholderiales
## 110: OTU_4516 Bacteria Proteobacteria  Betaproteobacteria  Burkholderiales
##                  family           genus
##   1:     Comamonadaceae     Ramlibacter
##   2: Corynebacteriaceae Corynebacterium
##   3:       mitochondria                
##   4:     Comamonadaceae                
##   5:  Flavobacteriaceae  Flavobacterium
##  ---                                   
## 106:    Lachnospiraceae     Coprococcus
## 107:  Sphingomonadaceae    Sphingopyxis
## 108:             ACK-M1                
## 109:     Comamonadaceae       Pelomonas
## 110:     Comamonadaceae   Limnohabitans</code></pre>
<pre class="r"><code>plot(complete_bagged_positive_communities, gr_complete_bagged_positive, 
     layout = layout.fruchterman.reingold(gr_complete_bagged_positive),
     rescaled = TRUE,
     vertex.size = 2, 
     vertex.label = NA
     )</code></pre>
<p><img src="bacteria_community_analysis_files/figure-html/cbp.1-1.png" width="672" /></p>
<p>Modularity:</p>
<pre class="r"><code>(cbp.mod &lt;- modularity(gr_complete_bagged_positive, membership(complete_bagged_positive_communities)))</code></pre>
<pre><code>## [1] 0.3653204</code></pre>
</div>
<div id="negative-weights-6" class="section level3">
<h3>Negative Weights</h3>
<pre class="r"><code>complete_bagged_negative &lt;- complete_negative_weights[treatment == &quot;Bagged&quot;]
complete_bagged_negative &lt;- complete_bagged_negative[, -1]
complete_bagged_negative[[3]] &lt;- abs(complete_bagged_negative[[3]])
gr_complete_bagged_negative &lt;- graph.data.frame(complete_bagged_negative, directed = FALSE)
complete_bagged_negative_communities &lt;- cluster_fast_greedy(gr_complete_bagged_negative, 
                                                           weights = E(gr_complete_bagged_negative)$rho)

hot_otus &lt;- vector()
for (community in communities(complete_bagged_negative_communities))
{
  sub_graph &lt;- induced.subgraph(graph = gr_complete_bagged_negative, 
                                    v = community, impl = &quot;auto&quot;)
  highest_degree_otu &lt;- V(sub_graph)[which.max(degree(sub_graph))]$name
  hot_otus &lt;- c(hot_otus, highest_degree_otu)
  print(paste(&quot;Highest degree OTU was&quot;, highest_degree_otu, &quot;(degree =&quot;,  
              degree(sub_graph, highest_degree_otu), &quot;):&quot;))
  print(taxa[OTU == highest_degree_otu])
        
  print(paste(&quot;Other OTUs in the same community as&quot;, highest_degree_otu, &quot;:&quot;))
  print(taxa[OTU %in% community])
}</code></pre>
<pre><code>## [1] &quot;Highest degree OTU was OTU_21 (degree = 4 ):&quot;
##       OTU   domain         phylum               class           order
## 1: OTU_21 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##              family       genus
## 1: Pseudomonadaceae Pseudomonas
## [1] &quot;Other OTUs in the same community as OTU_21 :&quot;
##         OTU   domain         phylum               class             order
## 1:   OTU_21 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
## 2:   OTU_51 Bacteria Actinobacteria      Actinobacteria   Actinomycetales
## 3: OTU_3492 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 4: OTU_4036 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
## 5:  OTU_510 Bacteria Proteobacteria  Betaproteobacteria     Rhodocyclales
## 6:    OTU_6 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
## 7:  OTU_131 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##                family         genus
## 1:   Pseudomonadaceae   Pseudomonas
## 2:  Microbacteriaceae    Candidatus
## 3: Enterobacteriaceae       Erwinia
## 4:      Moraxellaceae Acinetobacter
## 5:     Rhodocyclaceae Dechloromonas
## 6:      Moraxellaceae Acinetobacter
## 7:      Moraxellaceae              
## [1] &quot;Highest degree OTU was OTU_5 (degree = 19 ):&quot;
##      OTU   domain         phylum               class         order
## 1: OTU_5 Bacteria Proteobacteria Alphaproteobacteria Rickettsiales
##          family genus
## 1: mitochondria      
## [1] &quot;Other OTUs in the same community as OTU_5 :&quot;
##          OTU   domain         phylum               class             order
##  1:   OTU_28 Bacteria  Bacteroidetes      Flavobacteriia  Flavobacteriales
##  2: OTU_4616 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
##  3: OTU_3646 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
##  4:    OTU_5 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
##  5: OTU_3509 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##  6: OTU_5629 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
##  7: OTU_5795 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
##  8: OTU_5667 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##  9: OTU_5247 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 10: OTU_4598 Bacteria     Firmicutes             Bacilli        Bacillales
## 11: OTU_5939 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 12:  OTU_233 Bacteria     Firmicutes             Bacilli        Bacillales
## 13: OTU_3603 Bacteria Actinobacteria      Actinobacteria   Actinomycetales
## 14: OTU_5745 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 15:   OTU_27 Bacteria     Firmicutes             Bacilli   Lactobacillales
## 16: OTU_4759 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 17: OTU_5443 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 18: OTU_3181 Bacteria Actinobacteria      Actinobacteria   Actinomycetales
##                 family            genus
##  1:    [Weeksellaceae] Chryseobacterium
##  2: Enterobacteriaceae       Klebsiella
##  3: Enterobacteriaceae                 
##  4:       mitochondria                 
##  5:   Oxalobacteraceae                 
##  6: Enterobacteriaceae                 
##  7: Enterobacteriaceae                 
##  8:     Comamonadaceae                 
##  9: Enterobacteriaceae                 
## 10:        Bacillaceae    Anoxybacillus
## 11: Enterobacteriaceae       Klebsiella
## 12:   Paenibacillaceae    Paenibacillus
## 13:  Microbacteriaceae                 
## 14:     Comamonadaceae                 
## 15:   Streptococcaceae    Streptococcus
## 16:     Comamonadaceae                 
## 17:   Oxalobacteraceae                 
## 18: Corynebacteriaceae  Corynebacterium
## [1] &quot;Highest degree OTU was OTU_92 (degree = 2 ):&quot;
##       OTU   domain         phylum               class            order
## 1: OTU_92 Bacteria Proteobacteria Alphaproteobacteria Sphingomonadales
##               family        genus
## 1: Sphingomonadaceae Sphingomonas
## [1] &quot;Other OTUs in the same community as OTU_92 :&quot;
##         OTU   domain         phylum               class            order
## 1:   OTU_92 Bacteria Proteobacteria Alphaproteobacteria Sphingomonadales
## 2: OTU_5553 Bacteria Proteobacteria Alphaproteobacteria    Rickettsiales
## 3: OTU_4938 Bacteria Proteobacteria Alphaproteobacteria    Rickettsiales
## 4: OTU_5398 Bacteria Proteobacteria Gammaproteobacteria  Pseudomonadales
##               family        genus
## 1: Sphingomonadaceae Sphingomonas
## 2:      mitochondria             
## 3:      mitochondria             
## 4:  Pseudomonadaceae  Pseudomonas
## [1] &quot;Highest degree OTU was OTU_5806 (degree = 5 ):&quot;
##         OTU   domain         phylum               class             order
## 1: OTU_5806 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
##                family genus
## 1: Enterobacteriaceae      
## [1] &quot;Other OTUs in the same community as OTU_5806 :&quot;
##         OTU   domain         phylum               class             order
## 1:   OTU_60 Bacteria  Bacteroidetes      Flavobacteriia  Flavobacteriales
## 2:   OTU_22 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 3: OTU_3913 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 4: OTU_4153 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 5: OTU_5806 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 6: OTU_2168 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 7: OTU_3559 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 8:   OTU_88 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##                family          genus
## 1:  Flavobacteriaceae Flavobacterium
## 2:     Comamonadaceae     Variovorax
## 3:     Comamonadaceae               
## 4: Enterobacteriaceae        Erwinia
## 5: Enterobacteriaceae               
## 6: Enterobacteriaceae   Enterobacter
## 7:     Comamonadaceae      Comamonas
## 8:   Oxalobacteraceae               
## [1] &quot;Highest degree OTU was OTU_8 (degree = 4 ):&quot;
##      OTU   domain         phylum               class            order
## 1: OTU_8 Bacteria Proteobacteria Alphaproteobacteria Rhodospirillales
##              family         genus
## 1: Acetobacteraceae Gluconobacter
## [1] &quot;Other OTUs in the same community as OTU_8 :&quot;
##         OTU   domain         phylum               class             order
## 1: OTU_3478 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
## 2: OTU_5867 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 3:    OTU_8 Bacteria Proteobacteria Alphaproteobacteria  Rhodospirillales
## 4:    OTU_3 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 5: OTU_5257 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##                family         genus
## 1:       mitochondria              
## 2: Enterobacteriaceae              
## 3:   Acetobacteraceae Gluconobacter
## 4: Enterobacteriaceae       Erwinia
## 5:     Comamonadaceae     Pelomonas
## [1] &quot;Highest degree OTU was OTU_4161 (degree = 3 ):&quot;
##         OTU   domain         phylum               class         order
## 1: OTU_4161 Bacteria Proteobacteria Alphaproteobacteria Rickettsiales
##          family genus
## 1: mitochondria      
## [1] &quot;Other OTUs in the same community as OTU_4161 :&quot;
##         OTU   domain         phylum               class            order
## 1:  OTU_435 Bacteria Actinobacteria      Actinobacteria  Actinomycetales
## 2: OTU_4161 Bacteria Proteobacteria Alphaproteobacteria    Rickettsiales
## 3: OTU_5838 Bacteria Proteobacteria Alphaproteobacteria Sphingomonadales
## 4: OTU_5701 Bacteria Proteobacteria  Betaproteobacteria  Burkholderiales
##               family        genus
## 1:    Micrococcaceae      Kocuria
## 2:      mitochondria             
## 3: Sphingomonadaceae Sphingomonas
## 4:    Comamonadaceae             
## [1] &quot;Highest degree OTU was OTU_4227 (degree = 3 ):&quot;
##         OTU   domain         phylum               class         order
## 1: OTU_4227 Bacteria Proteobacteria Alphaproteobacteria Rickettsiales
##          family genus
## 1: mitochondria      
## [1] &quot;Other OTUs in the same community as OTU_4227 :&quot;
##         OTU   domain         phylum               class           order
## 1: OTU_3924 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
## 2:  OTU_479 Bacteria Proteobacteria Alphaproteobacteria Rhodobacterales
## 3: OTU_4227 Bacteria Proteobacteria Alphaproteobacteria   Rickettsiales
## 4: OTU_2529 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
##              family      genus
## 1:   Comamonadaceae           
## 2: Rhodobacteraceae Paracoccus
## 3:     mitochondria           
## 4:   Comamonadaceae           
## [1] &quot;Highest degree OTU was OTU_5098 (degree = 2 ):&quot;
##         OTU   domain         phylum              class           order
## 1: OTU_5098 Bacteria Proteobacteria Betaproteobacteria Burkholderiales
##            family     genus
## 1: Comamonadaceae Comamonas
## [1] &quot;Other OTUs in the same community as OTU_5098 :&quot;
##         OTU   domain         phylum               class             order
## 1: OTU_5098 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 2: OTU_5970 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 3: OTU_1934 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
##                family     genus
## 1:     Comamonadaceae Comamonas
## 2: Enterobacteriaceae          
## 3:       mitochondria          
## [1] &quot;Highest degree OTU was OTU_74 (degree = 1 ):&quot;
##       OTU   domain         phylum          class           order
## 1: OTU_74 Bacteria Actinobacteria Actinobacteria Actinomycetales
##                  family             genus
## 1: Propionibacteriaceae Propionibacterium
## [1] &quot;Other OTUs in the same community as OTU_74 :&quot;
##         OTU   domain         phylum               class           order
## 1: OTU_4222 Bacteria Proteobacteria Alphaproteobacteria   Rickettsiales
## 2:   OTU_74 Bacteria Actinobacteria      Actinobacteria Actinomycetales
##                  family             genus
## 1:         mitochondria                  
## 2: Propionibacteriaceae Propionibacterium</code></pre>
<pre class="r"><code>plot(complete_bagged_negative_communities, gr_complete_bagged_negative, 
     layout = layout.fruchterman.reingold(gr_complete_bagged_negative),
     rescaled = TRUE,
     vertex.size = 2, 
     vertex.label = NA
     )</code></pre>
<p><img src="bacteria_community_analysis_files/figure-html/cbn.1-1.png" width="672" /></p>
<p>Modularity:</p>
<pre class="r"><code>(cbn.mod &lt;- modularity(gr_complete_bagged_negative, membership(complete_bagged_negative_communities)))</code></pre>
<pre><code>## [1] 0.6176386</code></pre>
</div>
</div>
<div id="all-treatments-1" class="section level2">
<h2>All Treatments</h2>
<div id="positive-weights-7" class="section level3">
<h3>Positive Weights</h3>
<pre class="r"><code>complete_all_positive &lt;- complete_positive_weights[, -1]
gr_complete_all_positive &lt;- graph.data.frame(complete_all_positive, directed = FALSE)
gr_complete_all_positive &lt;- simplify(gr_complete_all_positive, 
                                    edge.attr.comb = &quot;mean&quot;)
complete_all_positive_communities &lt;- cluster_fast_greedy(gr_complete_all_positive, 
                                    weights = E(gr_complete_all_positive)$rho)

hot_otus &lt;- vector()
for (community in communities(complete_all_positive_communities))
{
  sub_graph &lt;- induced.subgraph(graph = gr_complete_all_positive, 
                                    v = community, impl = &quot;auto&quot;)
  highest_degree_otu &lt;- V(sub_graph)[which.max(degree(sub_graph))]$name
  hot_otus &lt;- c(hot_otus, highest_degree_otu)
  print(paste(&quot;Highest degree OTU was&quot;, highest_degree_otu, &quot;(degree =&quot;,  
              degree(sub_graph, highest_degree_otu), &quot;):&quot;))
  print(taxa[OTU == highest_degree_otu])
        
  print(paste(&quot;Other OTUs in the same community as&quot;, highest_degree_otu, &quot;:&quot;))
  print(taxa[OTU %in% community])
}</code></pre>
<pre><code>## [1] &quot;Highest degree OTU was OTU_131 (degree = 119 ):&quot;
##        OTU   domain         phylum               class           order
## 1: OTU_131 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##           family genus
## 1: Moraxellaceae      
## [1] &quot;Other OTUs in the same community as OTU_131 :&quot;
##           OTU   domain         phylum               class
##   1: OTU_3425 Bacteria Proteobacteria  Betaproteobacteria
##   2: OTU_5709 Bacteria Proteobacteria  Betaproteobacteria
##   3: OTU_3304 Bacteria Proteobacteria  Betaproteobacteria
##   4:   OTU_67 Bacteria Proteobacteria Alphaproteobacteria
##   5:   OTU_66 Bacteria Proteobacteria Alphaproteobacteria
##  ---                                                     
## 227:  OTU_958 Bacteria  Bacteroidetes       [Saprospirae]
## 228:  OTU_543 Bacteria Actinobacteria      Actinobacteria
## 229: OTU_2595 Bacteria Proteobacteria Gammaproteobacteria
## 230: OTU_3174 Bacteria Proteobacteria Gammaproteobacteria
## 231:   OTU_75 Bacteria Proteobacteria Gammaproteobacteria
##                  order             family           genus
##   1:   Burkholderiales     Comamonadaceae     Ramlibacter
##   2:     Rhodocyclales     Rhodocyclaceae        Zoogloea
##   3:   Burkholderiales   Oxalobacteraceae                
##   4:  Sphingomonadales Erythrobacteraceae                
##   5:  Rhodospirillales   Acetobacteraceae   Swaminathania
##  ---                                                     
## 227:   [Saprospirales]   Chitinophagaceae                
## 228: Bifidobacteriales Bifidobacteriaceae Bifidobacterium
## 229:   Pseudomonadales      Moraxellaceae   Acinetobacter
## 230:   Pseudomonadales   Pseudomonadaceae     Pseudomonas
## 231:   Pseudomonadales      Moraxellaceae       Moraxella
## [1] &quot;Highest degree OTU was OTU_253 (degree = 106 ):&quot;
##        OTU   domain     phylum   class      order      family
## 1: OTU_253 Bacteria Firmicutes Bacilli Bacillales Bacillaceae
##              genus
## 1: Natronobacillus
## [1] &quot;Other OTUs in the same community as OTU_253 :&quot;
##           OTU   domain         phylum               class
##   1:  OTU_434 Bacteria Proteobacteria Alphaproteobacteria
##   2: OTU_5410 Bacteria Proteobacteria Alphaproteobacteria
##   3: OTU_1035 Bacteria  Bacteroidetes    Sphingobacteriia
##   4:   OTU_65 Bacteria Proteobacteria Alphaproteobacteria
##   5:   OTU_64 Bacteria Proteobacteria Gammaproteobacteria
##  ---                                                     
## 220: OTU_4508 Bacteria Proteobacteria Alphaproteobacteria
## 221:  OTU_409 Bacteria     Firmicutes          Clostridia
## 222: OTU_5743 Bacteria Proteobacteria Alphaproteobacteria
## 223: OTU_1934 Bacteria Proteobacteria Alphaproteobacteria
## 224:   OTU_74 Bacteria Actinobacteria      Actinobacteria
##                   order               family             genus
##   1:      Rickettsiales         mitochondria                  
##   2:        Rhizobiales                                       
##   3: Sphingobacteriales  Sphingobacteriaceae  Sphingobacterium
##   4:   Sphingomonadales    Sphingomonadaceae      Sphingomonas
##   5:    Pseudomonadales     Pseudomonadaceae                  
##  ---                                                          
## 220:      Rickettsiales         mitochondria                  
## 221:      Clostridiales      Lachnospiraceae       Coprococcus
## 222:   Sphingomonadales    Sphingomonadaceae      Sphingomonas
## 223:      Rickettsiales         mitochondria                  
## 224:    Actinomycetales Propionibacteriaceae Propionibacterium
## [1] &quot;Highest degree OTU was OTU_4516 (degree = 116 ):&quot;
##         OTU   domain         phylum              class           order
## 1: OTU_4516 Bacteria Proteobacteria Betaproteobacteria Burkholderiales
##            family         genus
## 1: Comamonadaceae Limnohabitans
## [1] &quot;Other OTUs in the same community as OTU_4516 :&quot;
##           OTU   domain         phylum               class           order
##   1: OTU_4337 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##   2: OTU_3426 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
##   3:  OTU_895 Bacteria  Acidobacteria     Acidobacteria-6         iii1-15
##   4:  OTU_433 Bacteria Actinobacteria      Actinobacteria Actinomycetales
##   5:  OTU_435 Bacteria Actinobacteria      Actinobacteria Actinomycetales
##  ---                                                                     
## 256: OTU_5038 Bacteria Proteobacteria  Betaproteobacteria   Rhodocyclales
## 257: OTU_2220 Bacteria Actinobacteria      Actinobacteria Actinomycetales
## 258: OTU_5257 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
## 259: OTU_4516 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
## 260:   OTU_78 Bacteria Proteobacteria Gammaproteobacteria Xanthomonadales
##                  family           genus
##   1:      Moraxellaceae   Acinetobacter
##   2:     Comamonadaceae                
##   3:                                   
##   4: Corynebacteriaceae Corynebacterium
##   5:     Micrococcaceae         Kocuria
##  ---                                   
## 256:     Rhodocyclaceae   Dechloromonas
## 257:             ACK-M1                
## 258:     Comamonadaceae       Pelomonas
## 259:     Comamonadaceae   Limnohabitans
## 260:   Xanthomonadaceae                
## [1] &quot;Highest degree OTU was OTU_14 (degree = 67 ):&quot;
##       OTU   domain         phylum              class           order
## 1: OTU_14 Bacteria Proteobacteria Betaproteobacteria Burkholderiales
##            family genus
## 1: Comamonadaceae      
## [1] &quot;Other OTUs in the same community as OTU_14 :&quot;
##           OTU   domain         phylum               class
##   1: OTU_1484 Bacteria  Bacteroidetes    Sphingobacteriia
##   2: OTU_1154 Bacteria Proteobacteria  Betaproteobacteria
##   3: OTU_3950 Bacteria Proteobacteria  Betaproteobacteria
##   4: OTU_3780 Bacteria Proteobacteria  Betaproteobacteria
##   5:  OTU_699 Bacteria Proteobacteria Alphaproteobacteria
##  ---                                                     
## 125: OTU_5440 Bacteria Proteobacteria  Betaproteobacteria
## 126: OTU_3367 Bacteria Proteobacteria Gammaproteobacteria
## 127:  OTU_132 Bacteria Proteobacteria Deltaproteobacteria
## 128: OTU_3967 Bacteria Actinobacteria      Actinobacteria
## 129: OTU_2229 Bacteria Proteobacteria Alphaproteobacteria
##                   order             family            genus
##   1: Sphingobacteriales                                    
##   2:      Rhodocyclales     Rhodocyclaceae    Dechloromonas
##   3:    Burkholderiales     Comamonadaceae      Methylibium
##   4:      Rhodocyclales     Rhodocyclaceae    Dechloromonas
##   5:        Rhizobiales  Hyphomicrobiaceae                 
##  ---                                                       
## 125:    Burkholderiales     Comamonadaceae        Comamonas
## 126:  Enterobacteriales Enterobacteriaceae          Erwinia
## 127:       Myxococcales          0319-6G20                 
## 128:    Actinomycetales  Sanguibacteraceae     Sanguibacter
## 129:    Rhodobacterales   Rhodobacteraceae Rubellimicrobium</code></pre>
<pre class="r"><code>plot(complete_all_positive_communities, gr_complete_all_positive, 
     layout = layout.fruchterman.reingold(gr_complete_all_positive),
     rescaled = TRUE,
     vertex.size = 2, 
     vertex.label = NA
)</code></pre>
<p><img src="bacteria_community_analysis_files/figure-html/cap.1-1.png" width="672" /></p>
<p>Modularity score:</p>
<pre class="r"><code>(cap.mod &lt;- modularity(gr_complete_all_positive, membership(complete_all_positive_communities)))</code></pre>
<pre><code>## [1] 0.1754305</code></pre>
</div>
<div id="negative-weights-7" class="section level3">
<h3>Negative Weights</h3>
<pre class="r"><code>complete_all_negative &lt;- complete_negative_weights[, -1]
complete_all_negative[[3]] &lt;- abs(complete_all_negative[[3]])
gr_complete_all_negative &lt;- graph.data.frame(complete_all_negative, directed = FALSE)
gr_complete_all_negative &lt;- simplify(gr_complete_all_negative, 
                                    edge.attr.comb = &quot;mean&quot;)
complete_all_negative_communities &lt;- cluster_fast_greedy(gr_complete_all_negative, 
                                    weights = E(gr_complete_all_negative)$rho)

hot_otus &lt;- vector()
for (community in communities(complete_all_negative_communities))
{
  sub_graph &lt;- induced.subgraph(graph = gr_complete_all_negative, 
                                    v = community, impl = &quot;auto&quot;)
  highest_degree_otu &lt;- V(sub_graph)[which.max(degree(sub_graph))]$name
  hot_otus &lt;- c(hot_otus, highest_degree_otu)
  print(paste(&quot;Highest degree OTU was&quot;, highest_degree_otu, &quot;(degree =&quot;,  
              degree(sub_graph, highest_degree_otu), &quot;):&quot;))
  print(taxa[OTU == highest_degree_otu])
        
  print(paste(&quot;Other OTUs in the same community as&quot;, highest_degree_otu, &quot;:&quot;))
  print(taxa[OTU %in% community])
}</code></pre>
<pre><code>## [1] &quot;Highest degree OTU was OTU_8 (degree = 9 ):&quot;
##      OTU   domain         phylum               class            order
## 1: OTU_8 Bacteria Proteobacteria Alphaproteobacteria Rhodospirillales
##              family         genus
## 1: Acetobacteraceae Gluconobacter
## [1] &quot;Other OTUs in the same community as OTU_8 :&quot;
##          OTU   domain         phylum               class             order
##  1:  OTU_435 Bacteria Actinobacteria      Actinobacteria   Actinomycetales
##  2:   OTU_64 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##  3:   OTU_66 Bacteria Proteobacteria Alphaproteobacteria  Rhodospirillales
##  4:   OTU_20 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##  5: OTU_3478 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
##  6: OTU_5192 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##  7: OTU_4627 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##  8: OTU_4161 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
##  9: OTU_5838 Bacteria Proteobacteria Alphaproteobacteria  Sphingomonadales
## 10: OTU_5324 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
## 11: OTU_5867 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 12: OTU_4222 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
## 13:  OTU_397 Bacteria Proteobacteria Alphaproteobacteria   Rhodobacterales
## 14: OTU_5701 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 15:    OTU_8 Bacteria Proteobacteria Alphaproteobacteria  Rhodospirillales
## 16:    OTU_3 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 17:   OTU_27 Bacteria     Firmicutes             Bacilli   Lactobacillales
## 18:  OTU_130 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 19: OTU_1759 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
##                 family          genus
##  1:     Micrococcaceae        Kocuria
##  2:   Pseudomonadaceae               
##  3:   Acetobacteraceae  Swaminathania
##  4:      Moraxellaceae  Acinetobacter
##  5:       mitochondria               
##  6:     Comamonadaceae      Pelomonas
##  7:     Comamonadaceae Hydrogenophaga
##  8:       mitochondria               
##  9:  Sphingomonadaceae   Sphingomonas
## 10:      Moraxellaceae  Acinetobacter
## 11: Enterobacteriaceae               
## 12:       mitochondria               
## 13:   Rhodobacteraceae     Paracoccus
## 14:     Comamonadaceae               
## 15:   Acetobacteraceae  Gluconobacter
## 16: Enterobacteriaceae        Erwinia
## 17:   Streptococcaceae  Streptococcus
## 18:   Oxalobacteraceae               
## 19:       mitochondria               
## [1] &quot;Highest degree OTU was OTU_21 (degree = 9 ):&quot;
##       OTU   domain         phylum               class           order
## 1: OTU_21 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##              family       genus
## 1: Pseudomonadaceae Pseudomonas
## [1] &quot;Other OTUs in the same community as OTU_21 :&quot;
##          OTU   domain         phylum               class             order
##  1:   OTU_21 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##  2:   OTU_22 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##  3:   OTU_44 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
##  4:   OTU_18 Bacteria     Firmicutes             Bacilli   Lactobacillales
##  5: OTU_5289 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
##  6:  OTU_669 Bacteria  Bacteroidetes          Cytophagia      Cytophagales
##  7: OTU_4153 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
##  8:  OTU_256 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##  9:  OTU_164 Bacteria     Firmicutes             Bacilli        Bacillales
## 10: OTU_4191 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
## 11: OTU_4004 Bacteria  Bacteroidetes       [Saprospirae]   [Saprospirales]
## 12: OTU_5806 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 13:  OTU_172 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 14: OTU_4218 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 15:  OTU_510 Bacteria Proteobacteria  Betaproteobacteria     Rhodocyclales
## 16: OTU_5098 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 17:   OTU_88 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 18: OTU_5970 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
## 19:  OTU_131 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
## 20: OTU_1934 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
##                 family             genus
##  1:   Pseudomonadaceae       Pseudomonas
##  2:     Comamonadaceae        Variovorax
##  3:   Pseudomonadaceae       Pseudomonas
##  4:   Lactobacillaceae     Lactobacillus
##  5:       mitochondria                  
##  6:      Cytophagaceae    Flectobacillus
##  7: Enterobacteriaceae           Erwinia
##  8:   Oxalobacteraceae Janthinobacterium
##  9:   Paenibacillaceae     Paenibacillus
## 10:      Moraxellaceae     Acinetobacter
## 11:   Chitinophagaceae Sediminibacterium
## 12: Enterobacteriaceae                  
## 13:     Comamonadaceae        Rhodoferax
## 14:     Comamonadaceae        Rhodoferax
## 15:     Rhodocyclaceae     Dechloromonas
## 16:     Comamonadaceae         Comamonas
## 17:   Oxalobacteraceae                  
## 18: Enterobacteriaceae                  
## 19:      Moraxellaceae                  
## 20:       mitochondria                  
## [1] &quot;Highest degree OTU was OTU_5 (degree = 37 ):&quot;
##      OTU   domain         phylum               class         order
## 1: OTU_5 Bacteria Proteobacteria Alphaproteobacteria Rickettsiales
##          family genus
## 1: mitochondria      
## [1] &quot;Other OTUs in the same community as OTU_5 :&quot;
##          OTU   domain          phylum               class
##  1: OTU_4337 Bacteria  Proteobacteria Gammaproteobacteria
##  2:   OTU_42 Bacteria   Bacteroidetes          Cytophagia
##  3: OTU_1205 Bacteria Verrucomicrobia    [Spartobacteria]
##  4: OTU_3733 Bacteria  Proteobacteria Alphaproteobacteria
##  5: OTU_3128 Bacteria  Proteobacteria  Betaproteobacteria
##  6: OTU_4616 Bacteria  Proteobacteria Gammaproteobacteria
##  7: OTU_5778 Bacteria  Proteobacteria Gammaproteobacteria
##  8: OTU_5776 Bacteria  Proteobacteria Gammaproteobacteria
##  9: OTU_3492 Bacteria  Proteobacteria Gammaproteobacteria
## 10: OTU_3646 Bacteria  Proteobacteria Gammaproteobacteria
## 11:    OTU_5 Bacteria  Proteobacteria Alphaproteobacteria
## 12: OTU_3505 Bacteria  Proteobacteria Gammaproteobacteria
## 13: OTU_3509 Bacteria  Proteobacteria  Betaproteobacteria
## 14:  OTU_110 Bacteria  Proteobacteria Alphaproteobacteria
## 15: OTU_4036 Bacteria  Proteobacteria Gammaproteobacteria
## 16: OTU_3986 Bacteria  Proteobacteria Gammaproteobacteria
## 17: OTU_5616 Bacteria  Proteobacteria  Betaproteobacteria
## 18: OTU_5839 Bacteria  Proteobacteria Gammaproteobacteria
## 19: OTU_5834 Bacteria  Proteobacteria Gammaproteobacteria
## 20: OTU_4680 Bacteria   Bacteroidetes      Flavobacteriia
## 21:  OTU_148 Bacteria Verrucomicrobia      [Pedosphaerae]
## 22: OTU_5795 Bacteria  Proteobacteria Gammaproteobacteria
## 23:  OTU_550 Bacteria  Proteobacteria Alphaproteobacteria
## 24:  OTU_156 Bacteria  Proteobacteria  Betaproteobacteria
## 25: OTU_3204 Bacteria  Proteobacteria Gammaproteobacteria
## 26: OTU_5667 Bacteria  Proteobacteria  Betaproteobacteria
## 27: OTU_5247 Bacteria  Proteobacteria Gammaproteobacteria
## 28:   OTU_43 Bacteria  Proteobacteria  Betaproteobacteria
## 29:  OTU_260 Bacteria  Proteobacteria Gammaproteobacteria
## 30: OTU_4598 Bacteria      Firmicutes             Bacilli
## 31: OTU_5939 Bacteria  Proteobacteria Gammaproteobacteria
## 32: OTU_3603 Bacteria  Actinobacteria      Actinobacteria
## 33: OTU_5745 Bacteria  Proteobacteria  Betaproteobacteria
## 34: OTU_4345 Bacteria  Proteobacteria Gammaproteobacteria
## 35: OTU_4759 Bacteria  Proteobacteria  Betaproteobacteria
## 36: OTU_5443 Bacteria  Proteobacteria  Betaproteobacteria
## 37: OTU_3181 Bacteria  Actinobacteria      Actinobacteria
##          OTU   domain          phylum               class
##                    order                family            genus
##  1:      Pseudomonadales         Moraxellaceae    Acinetobacter
##  2:         Cytophagales         Cytophagaceae                 
##  3: [Chthoniobacterales] [Chthoniobacteraceae]                 
##  4:     Sphingomonadales     Sphingomonadaceae     Sphingomonas
##  5:      Burkholderiales      Oxalobacteraceae                 
##  6:    Enterobacteriales    Enterobacteriaceae       Klebsiella
##  7:      Pseudomonadales         Moraxellaceae    Acinetobacter
##  8:      Pseudomonadales         Moraxellaceae    Acinetobacter
##  9:    Enterobacteriales    Enterobacteriaceae          Erwinia
## 10:    Enterobacteriales    Enterobacteriaceae                 
## 11:        Rickettsiales          mitochondria                 
## 12:    Enterobacteriales    Enterobacteriaceae          Erwinia
## 13:      Burkholderiales      Oxalobacteraceae                 
## 14:          Rhizobiales    Phyllobacteriaceae                 
## 15:      Pseudomonadales         Moraxellaceae    Acinetobacter
## 16:      Pseudomonadales         Moraxellaceae    Acinetobacter
## 17:      Burkholderiales        Comamonadaceae        Comamonas
## 18:    Enterobacteriales    Enterobacteriaceae       Klebsiella
## 19:      Pseudomonadales         Moraxellaceae    Acinetobacter
## 20:     Flavobacteriales     Flavobacteriaceae   Flavobacterium
## 21:     [Pedosphaerales]             auto67_4W                 
## 22:    Enterobacteriales    Enterobacteriaceae                 
## 23:          Rhizobiales   Methylobacteriaceae Methylobacterium
## 24:      Burkholderiales      Oxalobacteraceae Polynucleobacter
## 25:      Xanthomonadales      Xanthomonadaceae                 
## 26:      Burkholderiales        Comamonadaceae                 
## 27:    Enterobacteriales    Enterobacteriaceae                 
## 28:      Burkholderiales      Oxalobacteraceae      Cupriavidus
## 29:    Oceanospirillales        Halomonadaceae        Kushneria
## 30:           Bacillales           Bacillaceae    Anoxybacillus
## 31:    Enterobacteriales    Enterobacteriaceae       Klebsiella
## 32:      Actinomycetales     Microbacteriaceae                 
## 33:      Burkholderiales        Comamonadaceae                 
## 34:      Pseudomonadales         Moraxellaceae    Acinetobacter
## 35:      Burkholderiales        Comamonadaceae                 
## 36:      Burkholderiales      Oxalobacteraceae                 
## 37:      Actinomycetales    Corynebacteriaceae  Corynebacterium
##                    order                family            genus
## [1] &quot;Highest degree OTU was OTU_28 (degree = 11 ):&quot;
##       OTU   domain        phylum          class            order
## 1: OTU_28 Bacteria Bacteroidetes Flavobacteriia Flavobacteriales
##             family            genus
## 1: [Weeksellaceae] Chryseobacterium
## [1] &quot;Other OTUs in the same community as OTU_28 :&quot;
##          OTU   domain         phylum               class             order
##  1:   OTU_60 Bacteria  Bacteroidetes      Flavobacteriia  Flavobacteriales
##  2:   OTU_23 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##  3:   OTU_51 Bacteria Actinobacteria      Actinobacteria   Actinomycetales
##  4: OTU_3913 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##  5:   OTU_28 Bacteria  Bacteroidetes      Flavobacteriia  Flavobacteriales
##  6:  OTU_345 Bacteria Proteobacteria Gammaproteobacteria Oceanospirillales
##  7: OTU_5298 Bacteria Proteobacteria  Betaproteobacteria     Rhodocyclales
##  8: OTU_2168 Bacteria Proteobacteria Gammaproteobacteria Enterobacteriales
##  9: OTU_3559 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 10: OTU_1300 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
## 11:  OTU_267 Bacteria     Firmicutes             Bacilli        Bacillales
## 12:  OTU_253 Bacteria     Firmicutes             Bacilli        Bacillales
## 13: OTU_2079 Bacteria Actinobacteria      Actinobacteria   Actinomycetales
## 14: OTU_5976 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
## 15:  OTU_225 Bacteria Proteobacteria Gammaproteobacteria   Pseudomonadales
## 16:  OTU_214 Bacteria Proteobacteria Gammaproteobacteria   Xanthomonadales
## 17:   OTU_94 Bacteria Proteobacteria                TA18         PHOS-HD29
## 18: OTU_4508 Bacteria Proteobacteria Alphaproteobacteria     Rickettsiales
## 19: OTU_5257 Bacteria Proteobacteria  Betaproteobacteria   Burkholderiales
##                 family             genus
##  1:  Flavobacteriaceae    Flavobacterium
##  2:     Comamonadaceae       Tepidimonas
##  3:  Microbacteriaceae        Candidatus
##  4:     Comamonadaceae                  
##  5:    [Weeksellaceae]  Chryseobacterium
##  6:     Halomonadaceae Haererehalobacter
##  7:     Rhodocyclaceae               C39
##  8: Enterobacteriaceae      Enterobacter
##  9:     Comamonadaceae         Comamonas
## 10:       mitochondria                  
## 11:   Paenibacillaceae     Paenibacillus
## 12:        Bacillaceae   Natronobacillus
## 13:    Nocardioidaceae                  
## 14:     Comamonadaceae         Comamonas
## 15:      Moraxellaceae     Acinetobacter
## 16:   Xanthomonadaceae  Stenotrophomonas
## 17:                                     
## 18:       mitochondria                  
## 19:     Comamonadaceae         Pelomonas
## [1] &quot;Highest degree OTU was OTU_6 (degree = 18 ):&quot;
##      OTU   domain         phylum               class           order
## 1: OTU_6 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##           family         genus
## 1: Moraxellaceae Acinetobacter
## [1] &quot;Other OTUs in the same community as OTU_6 :&quot;
##          OTU   domain         phylum               class
##  1: OTU_1035 Bacteria  Bacteroidetes    Sphingobacteriia
##  2: OTU_3950 Bacteria Proteobacteria  Betaproteobacteria
##  3: OTU_1011 Bacteria Proteobacteria  Betaproteobacteria
##  4:   OTU_45 Bacteria Proteobacteria Gammaproteobacteria
##  5:   OTU_49 Bacteria     Firmicutes             Bacilli
##  6:  OTU_446 Bacteria     Firmicutes          Clostridia
##  7: OTU_5302 Bacteria Proteobacteria Alphaproteobacteria
##  8:   OTU_16 Bacteria Proteobacteria  Betaproteobacteria
##  9: OTU_4387 Bacteria     Firmicutes             Bacilli
## 10: OTU_5498 Bacteria Proteobacteria  Betaproteobacteria
## 11: OTU_5629 Bacteria Proteobacteria Gammaproteobacteria
## 12:  OTU_336 Bacteria Proteobacteria Alphaproteobacteria
## 13:   OTU_92 Bacteria Proteobacteria Alphaproteobacteria
## 14:  OTU_233 Bacteria     Firmicutes             Bacilli
## 15: OTU_5553 Bacteria Proteobacteria Alphaproteobacteria
## 16: OTU_4938 Bacteria Proteobacteria Alphaproteobacteria
## 17: OTU_5854 Bacteria Proteobacteria  Betaproteobacteria
## 18: OTU_5398 Bacteria Proteobacteria Gammaproteobacteria
## 19: OTU_1076 Bacteria Actinobacteria      Actinobacteria
## 20:    OTU_9 Bacteria Proteobacteria Gammaproteobacteria
## 21:    OTU_6 Bacteria Proteobacteria Gammaproteobacteria
## 22:    OTU_7 Bacteria  Bacteroidetes      Flavobacteriia
##          OTU   domain         phylum               class
##                  order              family            genus
##  1: Sphingobacteriales Sphingobacteriaceae Sphingobacterium
##  2:    Burkholderiales      Comamonadaceae      Methylibium
##  3:    Burkholderiales      Comamonadaceae                 
##  4:    Pseudomonadales       Moraxellaceae    Enhydrobacter
##  5:    Lactobacillales    Streptococcaceae    Streptococcus
##  6:      Clostridiales  [Mogibacteriaceae]                 
##  7:      Rickettsiales        mitochondria                 
##  8:    Burkholderiales      Comamonadaceae    Aquabacterium
##  9:         Bacillales         Bacillaceae    Anoxybacillus
## 10:    Burkholderiales      Comamonadaceae       Roseateles
## 11:  Enterobacteriales  Enterobacteriaceae                 
## 12:        Rhizobiales Methylobacteriaceae                 
## 13:   Sphingomonadales   Sphingomonadaceae     Sphingomonas
## 14:         Bacillales    Paenibacillaceae    Paenibacillus
## 15:      Rickettsiales        mitochondria                 
## 16:      Rickettsiales        mitochondria                 
## 17:    Burkholderiales    Burkholderiaceae     Burkholderia
## 18:    Pseudomonadales    Pseudomonadaceae      Pseudomonas
## 19:    Actinomycetales  Pseudonocardiaceae   Pseudonocardia
## 20:    Pseudomonadales    Pseudomonadaceae      Pseudomonas
## 21:    Pseudomonadales       Moraxellaceae    Acinetobacter
## 22:   Flavobacteriales     [Weeksellaceae]  Cloacibacterium
##                  order              family            genus
## [1] &quot;Highest degree OTU was OTU_4227 (degree = 4 ):&quot;
##         OTU   domain         phylum               class         order
## 1: OTU_4227 Bacteria Proteobacteria Alphaproteobacteria Rickettsiales
##          family genus
## 1: mitochondria      
## [1] &quot;Other OTUs in the same community as OTU_4227 :&quot;
##         OTU   domain         phylum               class           order
## 1: OTU_3924 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
## 2:  OTU_479 Bacteria Proteobacteria Alphaproteobacteria Rhodobacterales
## 3: OTU_4227 Bacteria Proteobacteria Alphaproteobacteria   Rickettsiales
## 4: OTU_2529 Bacteria Proteobacteria  Betaproteobacteria Burkholderiales
## 5: OTU_5702 Bacteria Proteobacteria  Betaproteobacteria   Rhodocyclales
## 6:   OTU_74 Bacteria Actinobacteria      Actinobacteria Actinomycetales
##                  family             genus
## 1:       Comamonadaceae                  
## 2:     Rhodobacteraceae        Paracoccus
## 3:         mitochondria                  
## 4:       Comamonadaceae                  
## 5:       Rhodocyclaceae     Dechloromonas
## 6: Propionibacteriaceae Propionibacterium</code></pre>
<pre class="r"><code>plot(complete_all_negative_communities, gr_complete_all_negative, 
     layout = layout.fruchterman.reingold(gr_complete_all_negative),
     rescaled = TRUE,
     vertex.size = 2, 
     vertex.label = NA
)</code></pre>
<p><img src="bacteria_community_analysis_files/figure-html/can.1-1.png" width="672" /></p>
<p>Modularity score:</p>
<pre class="r"><code>(can.mod &lt;- modularity(gr_complete_all_negative, membership(complete_all_negative_communities)))</code></pre>
<pre><code>## [1] 0.4837875</code></pre>
</div>
</div>
</div>
<div id="modularity" class="section level1">
<h1>Modularity</h1>
<p>Collecting all modularity scores:</p>
<pre class="r"><code>treatments &lt;- c(&quot;tep&quot;, &quot;ten&quot;, &quot;tcp&quot;, &quot;tcn&quot;, &quot;tbp&quot;, &quot;tbn&quot;, &quot;tap&quot;, &quot;tan&quot;,
                        &quot;cep&quot;, &quot;cen&quot;, &quot;ccp&quot;, &quot;ccn&quot;, &quot;cbp&quot;, &quot;cbn&quot;, &quot;cap&quot;, &quot;can&quot;)
scores &lt;- c(tep.mod, ten.mod, tcp.mod, tcn.mod, tbp.mod, tbn.mod, tap.mod, tan.mod,
            cep.mod, cen.mod, ccp.mod, ccn.mod, cbp.mod, cbn.mod, cap.mod, can.mod)
mod.scores &lt;- data.table(treatments, scores)


library(ggplot2, warn.conflicts = FALSE)
ggplot(mod.scores, aes(x = &quot;&quot;, y = scores)) + geom_boxplot() + 
    geom_jitter(shape = 16, aes(color = treatments))</code></pre>
<p><img src="bacteria_community_analysis_files/figure-html/mod.1-1.png" width="672" /></p>
</div>
<div id="birds" class="section level1">
<h1>Birds</h1>
<pre class="r"><code>bird_data &lt;- bird_data[, -1]
otus_of_interest &lt;- c(&quot;Acinetobacter&quot;, &quot;Gluconobacter&quot;, &quot;Neokomagataea&quot;, &quot;erwinia&quot;, &quot;Pantoea&quot;, &quot;resenbergiella&quot;, &quot;Asaia&quot;, &quot;Lactobacillus&quot;, &quot;Pseudomonas&quot;)
otus_of_interest &lt;- taxa[which(apply(taxa, 1, function(x) any(otus_of_interest %in% x))),]$OTU
trimmed_bird &lt;- bird_data[which(apply(complete_data, 1, function(x) any(otus_of_interest %in% x))),]</code></pre>
<div id="trimmed-data-1" class="section level2">
<h2>Trimmed Data</h2>
<div id="positive-weights-8" class="section level3">
<h3>Positive Weights</h3>
<pre class="r"><code>trimmed_bird_positive &lt;- trimmed_bird[trimmed_bird[[&#39;rho&#39;]] &gt; 0]
gr_trimmed_bird_positive &lt;- graph.data.frame(trimmed_bird_positive, directed = FALSE)
gr_trimmed_bird_positive &lt;- simplify(gr_trimmed_bird_positive, 
                                    edge.attr.comb = &quot;mean&quot;)
trimmed_bird_positive_communities &lt;- cluster_fast_greedy(gr_trimmed_bird_positive, 
                                    weights = E(gr_trimmed_bird_positive)$rho)
plot(trimmed_bird_positive_communities, gr_trimmed_bird_positive, 
     layout = layout.fruchterman.reingold(gr_trimmed_bird_positive),
     rescaled = TRUE,
     vertex.size = 2, 
     vertex.label = NA
)</code></pre>
<p><img src="bacteria_community_analysis_files/figure-html/tbdp.1-1.png" width="672" /></p>
<pre class="r"><code>plot(trimmed_bird_positive_communities, gr_trimmed_bird_positive, 
     layout = layout.fruchterman.reingold(gr_trimmed_bird_positive),
     rescaled = TRUE,
     vertex.size = 2, 
     vertex.label.cex = 1,
     vertex.label = ifelse(V(gr_trimmed_bird_positive)$name == &quot;OTU_6&quot;, 
                           V(gr_trimmed_bird_positive)$name, &quot;&quot;)
)</code></pre>
<p><img src="bacteria_community_analysis_files/figure-html/tbdp.1-2.png" width="672" /></p>
</div>
<div id="negative-weights-8" class="section level3">
<h3>Negative Weights</h3>
<pre class="r"><code>trimmed_bird_negative &lt;- trimmed_bird[trimmed_bird[[&#39;rho&#39;]] &lt; 0]
trimmed_bird_negative[[3]] &lt;- abs(trimmed_bird_negative[[3]])
gr_trimmed_bird_negative &lt;- graph.data.frame(trimmed_bird_negative, directed = FALSE)
gr_trimmed_bird_negative &lt;- simplify(gr_trimmed_bird_negative, 
                                    edge.attr.comb = &quot;mean&quot;)
trimmed_bird_negative_communities &lt;- cluster_fast_greedy(gr_trimmed_bird_negative, 
                                    weights = E(gr_trimmed_bird_negative)$rho)
plot(trimmed_bird_negative_communities, gr_trimmed_bird_negative, 
     layout = layout.fruchterman.reingold(gr_trimmed_bird_negative),
     rescaled = TRUE,
     vertex.size = 2, 
     vertex.label.cex = 0.25
)</code></pre>
<p><img src="bacteria_community_analysis_files/figure-html/tbdn.1-1.png" width="672" /></p>
<pre class="r"><code>gr_trimmed_bird_negative</code></pre>
<pre><code>## IGRAPH 8101ca7 UN-- 14 10 -- 
## + attr: name (v/c), rho (e/n)
## + edges from 8101ca7 (vertex names):
##  [1] OTU_20  --OTU_5917 OTU_3986--OTU_9    OTU_5776--OTU_9   
##  [4] OTU_580 --OTU_23   OTU_5806--OTU_23   OTU_5806--OTU_19  
##  [7] OTU_5806--OTU_25   OTU_5806--OTU_42   OTU_5806--OTU_43  
## [10] OTU_8   --OTU_13</code></pre>
<pre class="r"><code>taxa[OTU %in% c(&quot;OTU_4898&quot;, &quot;OTU_9&quot;)]</code></pre>
<pre><code>##      OTU   domain         phylum               class           order
## 1: OTU_9 Bacteria Proteobacteria Gammaproteobacteria Pseudomonadales
##              family       genus
## 1: Pseudomonadaceae Pseudomonas</code></pre>
</div>
</div>
<div id="complete-data-1" class="section level2">
<h2>Complete Data</h2>
<div id="positive-weights-9" class="section level3">
<h3>Positive Weights</h3>
<pre class="r"><code>bird_positive &lt;- bird_data[bird_data[[&#39;rho&#39;]] &gt; 0]
gr_bird_positive &lt;- graph.data.frame(bird_positive, directed = FALSE)
gr_bird_positive &lt;- simplify(gr_bird_positive, 
                                    edge.attr.comb = &quot;mean&quot;)
bird_positive_communities &lt;- cluster_fast_greedy(gr_bird_positive, 
                                    weights = E(gr_bird_positive)$rho)
plot(bird_positive_communities, gr_bird_positive, 
     layout = layout.fruchterman.reingold(gr_bird_positive),
     rescaled = TRUE,
     vertex.size = 2, 
     vertex.label = NA
)</code></pre>
<p><img src="bacteria_community_analysis_files/figure-html/cbdp.1-1.png" width="672" /></p>
</div>
<div id="negative-weights-9" class="section level3">
<h3>Negative Weights</h3>
<pre class="r"><code>bird_negative &lt;- bird_data[bird_data[[&#39;rho&#39;]] &lt; 0]
bird_negative[[3]] &lt;- abs(bird_negative[[3]])
gr_bird_negative &lt;- graph.data.frame(bird_negative, directed = FALSE)
gr_bird_negative &lt;- simplify(gr_bird_negative, 
                                    edge.attr.comb = &quot;mean&quot;)
bird_negative_communities &lt;- cluster_fast_greedy(gr_bird_negative, 
                                    weights = E(gr_bird_negative)$rho)
plot(bird_negative_communities, gr_bird_negative, 
     layout = layout.fruchterman.reingold(gr_bird_negative),
     rescaled = TRUE,
     vertex.size = 2, 
     vertex.label = NA
)</code></pre>
<p><img src="bacteria_community_analysis_files/figure-html/cbdn.1-1.png" width="672" /></p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
